(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{424:function(e,t,a){e.exports=a(614)},521:function(e,t,a){},614:function(e,t,a){"use strict";a.r(t);var n=a(11),r=a(0),i=a.n(r),l=a(95),c=a.n(l),o=a(26),s=a(34),m=a(41),u=a.n(m),d=a(62),f=a(9),g=a(12),E=a(659),p=a(84),b=a(396),h=a(660),v=a(139),O=a(294),S=a(413),y=a(661),j=a(22);function w(){var e=Object(j.a)(["\n  query fetchStation($id: String!){\n    getStation(id: $id) {\n      costumers {\n        contract\n        aircrafts {\n          registration\n        }\n        name\n        id\n      }\n      shifts {\n        name\n        startTime\n      }\n      location\n      id\n      address {\n        country\n        postcode\n        city\n        street\n      }\n      phone\n      email\n      staffList{\n        id\n        name\n        lastActive{\n          activeAt\n        }\n      }\n      procedures{\n        title\n        description\n      }\n    }\n  }\n\n"]);return w=function(){return e},e}function C(){var e=Object(j.a)(["\n query ($detailed: Boolean = false ){\n  allStations {\n    id\n    location\n    shifts @skip(if: $detailed){\n      name\n      startTime\n    }\n    address @include(if: $detailed){\n      country\n      postcode\n      city\n      street\n    }\n    phone @include(if: $detailed)\n    email @include(if: $detailed)\n    activeStaffs @include(if: $detailed)\n    \n  }\n}"]);return C=function(){return e},e}var k=Object(g.gql)(C()),T=Object(g.gql)(w());function R(){var e=Object(j.a)(["\n  mutation addStation ($location:String! , $address: AddressInput! , $phone: String! ,$email: String!, $shifts: [ShiftInfoInput], $costumers: [String], $stationKey:String! ){\n    addStation(\n      location:$location\n      address:$address\n      phone:$phone\n      email:$email\n      shifts:$shifts\n      costumers:$costumers\n      stationKey: $stationKey\n    ){\n      id\n    }\n  }\n"]);return R=function(){return e},e}function D(){var e=Object(j.a)(["\n  mutation stationLogin($id: String!, $password:String!){\n    loginToStation(id: $id, password: $password) \n  }\n"]);return D=function(){return e},e}var A=Object(g.gql)(D()),I=Object(g.gql)(R()),$=function(){var e=Object(s.g)(),t=Object(r.useState)({}),a=Object(f.a)(t,2),n=a[0],l=a[1],c=Object(r.useState)(""),o=Object(f.a)(c,2),m=o[0],j=o[1],w=Object(r.useState)(!1),C=Object(f.a)(w,2),T=C[0],R=C[1],D=Object(g.useQuery)(k,{notifyOnNetworkStatusChange:!0}),I=D.loading,$=D.error,F=D.data,P=Object(g.useMutation)(A,{onError:function(e){console.log(e)}}),M=Object(f.a)(P,2),x=M[0],H=M[1];Object(r.useEffect)((function(){if(H.data){var t=H.data.loginToStation;j(t),sessionStorage.setItem("stationKey",JSON.stringify(t)),T&&localStorage.setItem("stationKey",JSON.stringify(t)),e.push("/shiftReport/station/".concat(n.value))}}),[H.data]);var N=function(){var e=Object(d.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),x({variables:{id:n.value,password:m}});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),L=JSON.parse(sessionStorage.getItem("stationKey"));if(!L){var q=localStorage.getItem("stationKey");L=JSON.parse(q),sessionStorage.setItem("stationKey",JSON.stringify(q))}L&&e.push("/shiftReport/station/".concat(L.id));var B=function(){R(!T)};return $?"Error! ".concat($):i.a.createElement(b.a,{textAlign:"center",style:{height:"100vh"},verticalAlign:"middle"},i.a.createElement(b.a.Column,{style:{maxWidth:450}},i.a.createElement(h.a,{as:"h2",color:"blue",textAlign:"center"},i.a.createElement(v.a,{src:"/LogoMin.png"})," Please select a station"),i.a.createElement(E.a,{size:"large",style:{textAlign:"left"},onSubmit:N},i.a.createElement(O.a,{clearing:!0,stacked:!0},I&&i.a.createElement(O.a,{loading:!0,basic:!0}),!I&&F.allStations&&F.allStations.map((function(e){return i.a.createElement(E.a.Field,{style:{float:"left",clear:"none",marginRight:"10px"},key:e.id},i.a.createElement(S.a,{label:e.location,value:e.id,checked:n.value===e.id,onChange:function(e,t){return function(e,t){var a=t.value,n=t.label;l({value:a,label:n})}(0,t)}}))})),i.a.createElement("div",{style:{clear:"both"}}),n.value&&function(e){return i.a.createElement(i.a.Fragment,null,i.a.createElement(E.a.Input,{name:"stationKey",value:m,onChange:function(e){var t=e.target;return j(t.value)},label:"Enter password for ".concat(e.label),fluid:!0,icon:"lock",iconPosition:"left",placeholder:"Password",type:"password"}),i.a.createElement(E.a.Checkbox,{name:"rememberKey",label:"Remember on this computer",checked:T,onClick:B}),i.a.createElement(p.a,{fluid:!0,size:"large",color:"blue"},"Retrieve Shift Report"))}(n))),i.a.createElement(y.a,{horizontal:!0},"Or"),i.a.createElement(O.a,{clearing:!0,stacked:!0},i.a.createElement(p.a,{content:"Log in to personal page",icon:"user",size:"large",color:"teal",fluid:!0,onClick:function(){return e.push("/staffLogin")}}))))};a(521);function F(){var e=Object(j.a)(["\n  query fetchReportbyShift($station: String!, $shift: String!, $date: Date!){\n    getShiftReportByShift(station: $station, shift: $shift, date: $date) {\n      startTime,\n      endTime,\n      id,\n      shift,\n      station{\n        location\n      }\n    }\n  }\n"]);return F=function(){return e},e}function P(){var e=Object(j.a)([" \n  query fetchReportList ( $stationId: String,  ){\n    getReportList (stationId: $stationId){\n      startTime,\n      endTime,\n      id,\n      shift\n      station{\n        location\n      }\n    }\n  }\n\n\n"]);return P=function(){return e},e}function M(){var e=Object(j.a)(["\nquery fetchReport($id:String, $station: String, $flag: String){\n    getShiftReport(id: $id, station: $station, flag: $flag) {\n      endTime\n      id\n      shift\n      staffAndTime {\n        id\n        staff {\n          name\n        }\n        endTime\n        startTime\n      }\n      startTime\n      station {\n        location\n        id\n      }\n      tasks {\n        aircraft {\n          registration\n          id\n          costumer {\n            name\n          }\n        }\n        taskCategory\n        description\n        id\n        status\n        updates {\n          action\n          handoverId {\n            id\n            shift\n          }\n          note\n        }\n        \n      }\n    } \n}\n\n"]);return M=function(){return e},e}var x=Object(g.gql)(M()),H=Object(g.gql)(P()),N=Object(g.gql)(F()),L=a(668),q=a(397),B=function(e){var t=e.activeItem,a=e.setActiveItem,n=Object(s.g)(),r=function(e,t){var n=t.name;return a(n)};return i.a.createElement(q.a,{inverted:!0,color:"blue",stackable:!0},i.a.createElement(q.a.Item,{header:!0},"  Shift Reporting System "),i.a.createElement(q.a.Item,{name:"lastShiftReport",active:"lastShiftReport"===t,onClick:r}),i.a.createElement(q.a.Item,{name:"browseAllReports",active:"browseAllReports"===t,onClick:r}),i.a.createElement(q.a.Item,{name:"startNewReport",active:"startNewReport"===t,onClick:r}),i.a.createElement(q.a.Item,{name:"allOpenTasks",active:"allOpenTasks"===t,onClick:r}),i.a.createElement(q.a.Menu,{position:"right"},i.a.createElement(p.a,{primary:!0,name:"Switch Station ",active:"logout"===t,onClick:function(){localStorage.removeItem("stationKey"),sessionStorage.removeItem("stationKey"),n.push("/")}},"Switch Station")))},Y=a(231),z=a(117),K=a(43),V=a(15),U=a.n(V),J=function(e){var t=e.task,a=e.handoverId,n=U.a.find(t.updates,["handoverId",{id:a}]);return i.a.createElement(O.a,null,"TASK_CREATED"!==n.action&&i.a.createElement(z.a,{size:"mini",basic:!0},"Tasks from previous shifts"),"TASK_CREATED"===n.action&&i.a.createElement(z.a,{circular:!0,size:"mini",color:"teal",basic:!0},"New"),"DEFERRED"===t.status&&i.a.createElement(i.a.Fragment,null,i.a.createElement(z.a,{size:"mini",color:"red",basic:!0}," Deferred "),i.a.createElement(z.a,{color:"red",size:"mini",basic:!0}," Action Required ")),"TASK_CREATED"!==n.action&&"CLOSED"===t.status&&i.a.createElement(z.a,{color:"green",size:"mini",basic:!0}," Completed "),"OPEN"===t.status&&n&&i.a.createElement(i.a.Fragment,null,"TASK_CREATED"!==n.action&&i.a.createElement(z.a,{size:"mini",basic:!0}," ",n.action," "),i.a.createElement(z.a,{color:"purple",size:"mini",basic:!0}," Open ")),t.updates.length>1&&i.a.createElement(z.a,{as:"a",size:"mini",onClick:function(){}}," ",i.a.createElement(K.a,{name:"history"})," Action History   "),i.a.createElement(O.a,{style:{paddingTop:0,paddingLeft:0},basic:!0,compact:!0},t.description,"   "))},W=function(e){var t=e.genericTasks,a=e.handoverId;return 0===t.legth?null:i.a.createElement(i.a.Fragment,null,i.a.createElement(O.a,{stacked:!0},i.a.createElement(h.a,{color:"blue",as:"h4",block:!0}," ",t[0].taskCategory," "),i.a.createElement(Y.a,null,U.a.map(t,(function(e){return i.a.createElement(J,{key:e.id,task:e,handoverId:a})})))))},_=function(e){var t=e.aircraftTasks,a=e.handoverId;return 0===t.legth?null:i.a.createElement(O.a,{stacked:!0},U.a.map(t,(function(e,t){return i.a.createElement(Y.a,{key:t},i.a.createElement(h.a,{color:"blue",as:"h4",block:!0}," ",i.a.createElement(K.a,{name:"plane"})," Work Performed for ",t),U.a.map(e,(function(e,t){return i.a.createElement(Y.a,{key:t},i.a.createElement(O.a,null,t),U.a.map(e,(function(e){return i.a.createElement(J,{key:e.id,task:e,handoverId:a})})))})))})))},G=a(662),Q=function(e){var t=e.timesheets;return i.a.createElement(O.a,null,i.a.createElement(G.a,{celled:!0},i.a.createElement(G.a.Header,null,i.a.createElement(G.a.Row,null,i.a.createElement(G.a.HeaderCell,null,"Staff"),i.a.createElement(G.a.HeaderCell,null,"Start Time"),i.a.createElement(G.a.HeaderCell,null,"End TIme"))),i.a.createElement(G.a.Body,null,t.map((function(e){return i.a.createElement(G.a.Row,{key:e.id},i.a.createElement(G.a.Cell,null,e.staff.name),i.a.createElement(G.a.Cell,null,e.startTime.substring(10)),i.a.createElement(G.a.Cell,null,e.endTime.substring(10)))})))))},Z=function(e){var t=e.reportData;if(!t)return i.a.createElement(O.a,null,"No reports found");var a=U.a.groupBy(t.tasks,(function(e){return e.taskCategory})),n=U.a.mapValues(a,(function(e,t){return"AIRCRAFT"===t?U.a.chain(a.AIRCRAFT).groupBy((function(e){return e.aircraft.costumer.name})).mapValues((function(e){return U.a.groupBy(e,(function(e){return e.aircraft.registration}))})).value():e}));return i.a.createElement(Y.a,null,i.a.createElement(O.a,{basic:!0,clearing:!0},i.a.createElement(h.a,{floated:"left"}," Shift Report from ",t.shift," shift ",i.a.createElement("span",null,i.a.createElement("h5",null,"(",t.startTime.substring(10)," - ",t.endTime.substring(10),")"))),i.a.createElement(h.a,{floated:"right",as:"h5"},"  ",t.startTime.substring(10,0),i.a.createElement("span",null,i.a.createElement("br",null),t.station.location)," ")),i.a.createElement(Q,{timesheets:t.staffAndTime}),U.a.map(n,(function(e,a){return"AIRCRAFT"===a?i.a.createElement(_,{key:a,aircraftTasks:e,handoverId:t.id}):i.a.createElement(W,{key:a,genericTasks:e,handoverId:t.id})})))},X=Object(r.createContext)({lastShiftReport:[],station:[]}),ee=function(e,t){switch(t.type){case"ADD_LASTSHIFTREPORT":return Object(n.a)(Object(n.a)({},e),{},{lastShiftReport:t.payload});case"INIT_STATION":return Object(n.a)(Object(n.a)({},e),{},{station:t.payload});default:return e}},te=a(56),ae=a(40),ne=a(19),re=a(86),ie=a(134),le=a(619),ce=a(298),oe=function(e){var t=e.label,a=Object(re.a)(e,["label"]),n=Object(ne.f)(),r=n.setFieldValue,l=n.setFieldTouched,c=Object(ne.e)(a),o=Object(f.a)(c,2),s=o[0],m=o[1];return i.a.createElement(E.a.Field,{width:"4"},t&&i.a.createElement("label",null,t),i.a.createElement(ie.DateTimeInput,Object.assign({error:!(!m.touched||!m.error),popupPosition:"right center"},s,a,{dateTimeFormat:"DD-MM-YYYY HH:mm",closable:!0,onBlur:function(){l(s.name,!0)},onChange:function(e,t){var a=t.value;r(s.name,a)},preserveViewMode:!1})),m.touched&&m.error?i.a.createElement(z.a,{pointing:!0,prompt:!0},m.error):"")},se=function(e){var t=e.width,a=Object(re.a)(e,["width"]),n=Object(ne.e)(a),r=Object(f.a)(n,2),l=r[0],c=r[1];return i.a.createElement(i.a.Fragment,null,i.a.createElement(E.a.Field,{error:!(!c.touched||!c.error),width:t},i.a.createElement("label",null,a.inputlabel?a.inputlabel:""),i.a.createElement(le.a,Object.assign({},l,a)),"hidden"!==a.type&&c.touched&&c.error&&i.a.createElement(z.a,{pointing:!0,prompt:!0},c.error)))},me=function(e){var t=e.label,a=e.children,n=e.checked,r=Object(re.a)(e,["label","children","checked"]);return i.a.createElement(O.a,{style:{display:n?"block":"inline-block"}},i.a.createElement(ce.a,Object.assign({checked:n},r,{toggle:!0})),i.a.createElement("label",{style:{display:"inline-block",marginLeft:"5px",verticalAlign:"super"}}," ",t.toUpperCase()," "),a)},ue=function(e){e.label;var t=Object(re.a)(e,["label"]),a=Object(ne.e)(t),n=Object(f.a)(a,2),r=n[0],l=n[1];return i.a.createElement(E.a.TextArea,Object.assign({error:l.touched&&l.error},r,t))},de=function(e){if(!e)return null;if(isNaN(e)){switch([/^(-?(?:[1-9][0-9]*)?[0-9]{4})-(1[0-2]|0[1-9])-(3[01]|0[1-9]|[12][0-9])T(2[0-3]|[01][0-9]):([0-5][0-9]):([0-5][0-9])(\.[0-9]+)?(Z)?$/].findIndex((function(t){return!!e.match(t)}))){case 0:var t=e.split("T"),a=t[0],n=t[1],r=a.split("-"),i=n.split(".")[0].split(":");return r[2]+"-"+r[1]+"-"+r[0]+" "+i[0]+":"+i[1];default:return null}}var l=new Date(e);return"".concat(l.getDate().toString().padStart(2,0),"-").concat((l.getMonth()+1).toString().padStart(2,0),"-").concat(l.getFullYear()," ").concat(l.getHours().toString().padStart(2,0),":").concat(l.getMinutes().toString().padStart(2,0))},fe=function(e,t,a,n){if(!e)return null;var r;if(Object(V.isNumber)(e))r=new Date(e);else{var i=e.split(" "),l=i[0].split("-"),c="".concat(l[2],"-").concat(l[1],"-").concat(l[0]," ").concat(i[1]);r=Date.parse(c)}switch(a){case"d":if("add"===n)return de(r+24*t*60*60*1e3);if("sub"===n)return de(r-24*t*60*60*1e3);break;case"h":if("add"===n)return de(r+60*t*60*1e3);if("sub"===n)return de(r-60*t*60*1e3);break;case"m":if("add"===n)return de(r+60*t*1e3);if("sub"===n)return de(r-60*t*1e3);break;default:return de(r)}},ge=function(e){var t;if(Object(V.isNumber)(e))t=new Date(e);else{var a=e.split(" "),n=a[0].split("-"),r="".concat(n[2],"-").concat(n[1],"-").concat(n[0]," ").concat(a[1]||"00",":").concat("00"|a[2]);t=Date.parse(r)}return t},Ee=function(e){var t=new Date(e.valueOf()),a=(e.getDay()+6)%7;t.setDate(t.getDate()-a+3);var n=t.valueOf();return t.setMonth(0,1),4!==t.getDay()&&t.setMonth(0,1+(4-t.getDay()+7)%7),1+Math.ceil((n-t)/6048e5)},pe=function(e,t){var a=new Date(Date.UTC(t,0,1+7*(e-1))),n=a.getDay(),r=a;return n<=4?r.setDate(a.getDate()-a.getDay()+1):r.setDate(a.getDate()+8-a.getDay()),r},be=function(e){e||(e=4);var t=(new Date).getMonth();return Object(ae.a)(new Array(e)).map((function(e,a){return{key:a,text:(n=t-a,new Proxy(["January","February","March","April","May","June","July","August","September","October","November","December"],{get:function(e,t){return isNaN(t)||(t=parseInt(t,10))<0&&(t+=e.length),e[t]}})[n]),value:t-1<0?11+t-a:t-a};var n}))},he=function(e){e||(e=4);for(var t=new Date,a=t.getMonth(),n=t.getFullYear(),r=Ee(new Date(n-1,11,28)),i=Ee(new Date(n,a-e,1)),l=[],c=Ee(t);c!==i-1;){var o={key:c,text:c,value:c};l.push(o),0===(c-=1)&&(c=r)}return l},ve=function(e){var t;if(e)return e.name||(t=Object(n.a)(Object(n.a)({},t),{},{name:"Staff name is required"})),t=Object(n.a)(Object(n.a)({},t),Oe(e.startTime,e.endTime))},Oe=function(e,t,a){var r;return e||(r=Object(n.a)(Object(n.a)({},r),{},{startTime:"Start time is required"})),t||(r=Object(n.a)(Object(n.a)({},r),{},{endTime:"End time is required"})),e.match(/^(0[1-9]|[12][0-9]|3[01])-(0[1-9]|1[0-2])-\d\d\d\d (0[0-9]|1[0-9]|2[0-3]):([0-9]|[0-5][0-9])$/)||(r=Object(n.a)(Object(n.a)({},r),{},{startTime:"Start time should be on format DD-MM-YYYY HH:MM"})),t.match(/^(0[1-9]|[12][0-9]|3[01])-(0[1-9]|1[0-2])-\d\d\d\d (0[0-9]|1[0-9]|2[0-3]):([0-9]|[0-5][0-9])$/)||(r=Object(n.a)(Object(n.a)({},r),{},{endTime:"End time should be on format DD-MM-YYYY HH:MM"})),!a&&ge(e)+864e5<=Date.now()&&(r=Object(n.a)(Object(n.a)({},r),{},{startTime:"Start time should be within last 24 hours"})),a&&new Date(a).getDate()!==new Date(ge(e)).getDate()&&(r=Object(n.a)(Object(n.a)({},r),{},{startTime:"Start time should be on ".concat(de(new Date(a)).split(" ")[0])})),ge(e)>=ge(t)&&(r=Object(n.a)(Object(n.a)({},r),{},{startTime:"Start time cannot be later than endtime"})),ge(e)>Date.now()&&(r=Object(n.a)(Object(n.a)({},r),{},{startTime:"Start time cannot be on future"})),ge(t)>Date.now()&&(r=Object(n.a)(Object(n.a)({},r),{},{endTime:"End time cannot be on future"})),r},Se=function(e){var t=null;return"DEFERRED"===e.status&&(e.action&&"NOTES_ADDED"!==e.action||(console.log(e),t=Object(n.a)(Object(n.a)({},t),{},{action:"Action was requested on this task. Please perform a action. "}))),e.status||e.action||(t=Object(n.a)(Object(n.a)({},t),{},{action:"Task must have one of the following status"})),e.description&&""!==e.description.trim()||(t=Object(n.a)(Object(n.a)({},t),{},{description:"Please add task description"})),t},ye=function(e){return e?e.match(/^[\w-.]+@([\w-]+\.)+[\w-]{2,4}$/)?void 0:"Incorrect email format":"Email is required"},je=function(e){return e&&""!==e.trim?e.length<4?"Name must be at least 4 character long":void 0:"Full name is required"},we=function(e){var t=e.name,a=e.pointing;return i.a.createElement(ne.a,{name:t},(function(e){var n=e.form,r=Object(ne.d)(n.errors,t);return Object(ne.d)(n.touched,t)&&r&&"string"===typeof r?i.a.createElement(z.a,{pointing:a,style:{height:"fit-content"},color:"red",basic:!0},r):null}))},Ce=a(665),ke=a(616),Te=a(253);function Re(){var e=Object(j.a)(["\n mutation requestClarification($id: String!, $clearify: String){\n  requestClarification(\n     id: $id,\n     clearify:$clearify,    \n   ){\n    remarks{\n      by\n      date\n      edit\n      text\n      title\n    }\n   }\n }\n"]);return Re=function(){return e},e}function De(){var e=Object(j.a)(["\n mutation deleteTimeSheet($id: String!){\n   deleteTimeSheet(\n     id: $id,    \n   ){\n     status\n     message\n   }\n }\n"]);return De=function(){return e},e}function Ae(){var e=Object(j.a)(["\n mutation approveTimeSheet($id: String!, $status: String!){\n   approveTimeSheet(\n     id: $id,\n     status: $status\n   ){\n     id \n     status \n     remarks{\n      by\n      date\n      edit\n      text\n      title\n    }\n   }\n }\n"]);return Ae=function(){return e},e}function Ie(){var e=Object(j.a)(["\n mutation updateTimeSheet($id: String, $startTime: String , $endTime: String, $station: String, $shift : String, $break: Int, $staff: String, $remarks: [RemarkInput], $handover: String){\n  addToTimeSheet(\n      id: $id\n      startTime: $startTime , \n      endTime: $endTime,\n      station: $station, \n      shift: $shift,  \n      staff: $staff\n      break: $break,\n      remarks:$remarks,\n      handover:$handover,\n  )\n    {\n      id\n      startTime\n      status\n      date\n      endTime\n      break\n      remarks{\n        by\n        date\n        edit\n        text\n        title\n      }\n      staff{\n        id\n        name\n        reqHours\n      }\n      shiftReport {\n        shift\n        id\n        station {\n          id\n          location\n        }\n      }\n\n      shift\n      station{\n        id\n        location\n      }\n\n  } \n  \n\n }\n"]);return Ie=function(){return e},e}function $e(){var e=Object(j.a)(["\n  mutation signOff($startTime: String!, $break:Int, $endTime:String!, $username: String, $password:String, $idCardCode: String, $additionalAction: String, $id:String, $email: String, $name: String ){\n    signOffTimeSheet(\n      startTime: $startTime, \n      endTime:$endTime, \n      break: $break,\n      username: $username, \n      password: $password , \n      additionalAction: $additionalAction,\n      email: $email,\n      name: $name,\n      idCardCode: $idCardCode\n      id: $id\n      ) {\n        name,\n        value,\n        break,\n        startTime,\n        endTime,\n        id\n      }\n  }"]);return $e=function(){return e},e}var Fe=Object(g.gql)($e()),Pe=Object(g.gql)(Ie()),Me=Object(g.gql)(Ae()),xe=Object(g.gql)(De()),He=Object(g.gql)(Re()),Ne=function(e){var t=e.setOpen,a=e.open,l=e.fieldName,c=e.removeClick,o=e.removeStaff,s=e.setRemoveStaff,m=Object(ne.f)(),v=m.getFieldMeta,S=m.setFieldValue,j=Object(g.useMutation)(Fe,{onError:function(e){console.log(e)}}),w=Object(f.a)(j,2),C=w[0],k=w[1],T=k.loading,R=k.error,D=k.data,A=v("".concat(l,".startTime")).value,I=v("".concat(l,".endTime")).value,$=v("".concat(l,".break")).value,F=Object(r.useState)(""),P=Object(f.a)(F,2),M=P[0],x=P[1],H=Object(r.useState)(""),N=Object(f.a)(H,2),q=N[0],B=N[1],Y=Object(r.useState)(""),z=Object(f.a)(Y,2),V=z[0],U=z[1],J=Object(r.useState)(A),W=Object(f.a)(J,2),_=W[0],G=W[1],Q=Object(r.useState)(I),Z=Object(f.a)(Q,2),X=Z[0],ee=Z[1],te=Object(r.useState)($),ae=Object(f.a)(te,2),re=ae[0],ie=ae[1];Object(r.useEffect)((function(){G(A),ee(I)}),[I,A]),Object(r.useEffect)((function(){R&&x({type:"error",message:"Sorry, ".concat(R.message)}),D&&null!=D.signOffTimeSheet&&(o?(c(),s(!1),t(!1)):(S("".concat(l,".startTime"),D.signOffTimeSheet.startTime),S("".concat(l,".endTime"),D.signOffTimeSheet.endTime),S("".concat(l,".signOffKey"),D.signOffTimeSheet.value),t(!1)))}),[R,D]);var le=function(){var e=Object(d.a)(u.a.mark((function e(t){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={startTime:t.startTime,endTime:t.endTime,break:t.breakt,username:q,password:V,additionalAction:o?"remove":"update",id:v("".concat(l)).value.id},console.log(a),e.next=4,C({variables:a});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return T?i.a.createElement(ke.a,{active:!0,inverted:!0},i.a.createElement(L.a,{active:!0,inverted:!0},"Verifying")):i.a.createElement(Te.a,{closeIcon:!0,closeOnEscape:!1,closeOnDimmerClick:!1,open:a,onClose:function(){x(!1),t(!1)},onOpen:function(){return t(!0)}},i.a.createElement(Te.a.Header,null,v("".concat(l,".name")).value," "),i.a.createElement(Te.a.Content,null,M&&(M?i.a.createElement(Ce.a,{success:"success"===M.type,error:"error"===M.type,onDismiss:function(){return x("")}}," ",M.message):null),i.a.createElement(ne.c,{enableReinitialize:!0,initialValues:{startTime:_,endTime:X,breakt:re,username:"",password:"",email:"",fullname:"",resetEmail:""},validate:function(e){var t={};return t=Object(n.a)(Object(n.a)({},t),Oe(e.startTime,e.endTime))},onSubmit:function(e){le(e)}},(function(e){e.values;var t=e.handleSubmit;e.errors,e.touched;return i.a.createElement(E.a,{size:"large",onSubmit:t},i.a.createElement(E.a.Group,null,i.a.createElement(oe,{label:"Start Time",dateTimeFormat:"DD-MM-YYYY HH:mm",name:"startTime",maxDate:fe(Date.now(),30,"m","sub"),minDate:fe(Date.now(),20,"h","sub"),onChange:function(e,t){var a=t.value;G(a)}}),i.a.createElement(oe,{label:"End Time",dateTimeFormat:"DD-MM-YYYY HH:mm",name:"endTime",maxDate:de(Date.now()),minDate:fe(_,20,"m","add"),onChange:function(e,t){var a=t.value;ee(a)}}),i.a.createElement(se,{inputlabel:"Break",label:"Minutes ",labelPosition:"right corner",name:"breakt",type:"number",min:"0",onChange:function(e,t){var a=t.value;ie(a)}})),i.a.createElement(h.a,{as:"h3",color:"red",textAlign:"center"},o?"Enter credentials to confirm remove.":"Enter credential to save changes"),i.a.createElement(i.a.Fragment,null,i.a.createElement(O.a,null,i.a.createElement(b.a,{columns:2,stackable:!0},i.a.createElement(y.a,{vertical:!0},"Or"),i.a.createElement(b.a.Row,{verticalAlign:"middle"},i.a.createElement(b.a.Column,null,i.a.createElement(b.a.Row,{style:{textAlign:"center"}},i.a.createElement(h.a,{as:"h5",icon:!0},i.a.createElement(K.a,{name:"sign in alternate"}),"Use Credentials")),i.a.createElement(b.a.Row,null,i.a.createElement(E.a.Group,null,i.a.createElement(E.a.Input,{label:"Username",onChange:function(e,t){var a=t.value;return B(a)}}),i.a.createElement(E.a.Input,{label:"Password",type:"password",onChange:function(e,t){var a=t.value;return U(a)}})),i.a.createElement(E.a.Field,{style:{textAlign:"center"}},i.a.createElement(p.a,{type:"submit",primary:!0}," Sign ")))),i.a.createElement(b.a.Column,{textAlign:"center"},i.a.createElement(b.a.Row,null,i.a.createElement(h.a,{icon:!0},i.a.createElement(K.a,{name:"barcode",size:"massive"}),"Use IdCard")),i.a.createElement(b.a.Row,null,i.a.createElement(p.a,{primary:!0},"Scan"))))))))}))))},Le=function(e){var t=e.staff,a=e.fieldName,n=e.values,l=e.index,c=e.remove,o=Object(r.useState)(!1),s=Object(f.a)(o,2),m=s[0],u=s[1],d=Object(r.useState)(!1),g=Object(f.a)(d,2),b=g[0],h=g[1];return t?i.a.createElement(O.a,null,t.signOffKey&&i.a.createElement(z.a,{attached:"top left",size:"mini",basic:!0,color:"grey"},"Signed Off "),i.a.createElement(E.a.Group,null,i.a.createElement(se,{width:4,readOnly:t.signOffKey,name:"".concat(a,".name")}),i.a.createElement(oe,{readOnly:t.signOffKey&&!t.changing,maxDate:fe(Date.now(),30,"m","sub"),minDate:fe(Date.now(),20,"h","sub"),name:"".concat(a,".startTime")}),i.a.createElement(oe,{readOnly:t.signOffKey&&!t.changing,maxDate:de(Date.now()),minDate:fe(n.startTime,20,"m","add"),name:"".concat(a,".endTime")}),i.a.createElement(ne.a,{type:"hidden",value:"",name:"".concat(a,".signOffKey")}),i.a.createElement(ne.a,{type:"hidden",value:"",name:"".concat(a,".break")}),i.a.createElement(p.a,{style:{height:"fit-content"},type:"button",circular:!0,icon:"cancel",basic:!0,onClick:function(){h(!0),u(!0)}}),i.a.createElement(i.a.Fragment,null,i.a.createElement(p.a,{style:{height:"fit-content"},type:"button",inverted:!0,color:"red",size:"small",onClick:function(){u(!0)}}," Change"))),i.a.createElement(Ne,{setOpen:u,open:m,startTime:n.staffs[l].startTime,endTime:n.staffs[l].endTime,breakt:n.staffs[l].break,fieldName:a,removeStaff:b,setRemoveStaff:h,removeClick:function(){return c(l)}})):null},qe=function(e){var t=e.values,a=e.addStaffOpen;return i.a.createElement(i.a.Fragment,null,i.a.createElement(ne.b,{name:"staffs"},(function(e){var n=e.remove;e.push,e.replace;return i.a.createElement(r.Fragment,null,i.a.createElement(h.a,{as:"h3"},"Staffs"),i.a.createElement(O.a.Group,null,t.staffs.length>0&&t.staffs.map((function(e,a){return i.a.createElement(Le,{key:a,index:a,staff:e,fieldName:"staffs.".concat(a),values:t,remove:n})}))),i.a.createElement(p.a,{type:"button",icon:!0,primary:!0,onClick:function(){return a(!0)}},i.a.createElement(K.a,{name:"plus circle"})," Add "),"  ",i.a.createElement(we,{name:"staffs",pointing:"left"}))})))},Be=a(663),Ye=a(352),ze=function(e){var t=e.label,a=e.onRemove,n=e.disabled,l=(e.children,e.name),c=(Object(re.a)(e,["label","onRemove","disabled","children","name"]),Object(ne.f)()),o=c.setFieldValue,s=c.getFieldProps,m=c.setFieldTouched,u=c.getFieldMeta,d=Object(r.useState)(!1),g=Object(f.a)(d,2),b=g[0],h=g[1],v=s("".concat(l,".action")).value,O=s("".concat(l,".status")).value,S=s("".concat(l,".newNote")).value,j=function(e,t){e.preventDefault(),o("".concat(l,".action"),t),b&&!S&&w()},w=function(){if(b){var e=S.trim();h(!1),o("".concat(l,".newNote"),e)}else h(!0)},C=function(){return v&&"NOTES_ADDED"!==v?i.a.createElement("div",{style:{padding:"0.3125em 1.5em"}},i.a.createElement(z.a,{size:"mini",basic:!0},"Task from previous shifts "),S&&S.trim()&&i.a.createElement(z.a,{size:"mini",basic:!0,color:"blue",as:"a",onClick:function(){return w()}},"Notes Added "),i.a.createElement(z.a,{size:"mini",basic:!0,color:"green"},v," "),i.a.createElement(z.a,{as:"a",size:"mini",basic:!0,color:"yellow",onClick:function(e){return o("".concat(l,".action"),""),void(S&&h(!0))}}," ",i.a.createElement(K.a,{name:"undo"})," Undo Action ")):i.a.createElement("div",{style:{padding:"0.3125em 1.5em"}},i.a.createElement(z.a,{size:"mini",basic:!0},"Task from previous shifts "),S&&S.trim()&&i.a.createElement(z.a,{size:"mini",basic:!0,color:"blue"},"Notes Added "),i.a.createElement(z.a,{size:"mini",basic:!0,color:"purple"},"Open "),n&&"DEFERRED"===O&&i.a.createElement(z.a,{size:"mini",basic:!0,color:"red"},"Action Required "))};return i.a.createElement(i.a.Fragment,null,i.a.createElement(y.a,null),n&&i.a.createElement(C,null),i.a.createElement(E.a.Group,{style:{marginBottom:"0px"}},i.a.createElement("label",{style:{display:"inline-block",padding:"0.9375em 0px 0px 0.3125em",width:"1.5625em"}},t+1),i.a.createElement(ue,{name:"".concat(l,".description"),readOnly:n,rows:"1",width:"16"}),i.a.createElement(p.a,{type:"button",circular:!0,icon:"cancel",style:{visibility:n?"hidden":"",height:"fit-content"},basic:!0,onClick:function(e){return function(e){e.preventDefault(),a()}(e)}})),!n&&i.a.createElement("div",{style:{padding:"0.5em 1.5em"}},i.a.createElement(we,{name:"".concat(l,".action"),pointing:"below"}),i.a.createElement(E.a.Group,null,i.a.createElement(E.a.Checkbox,{checked:"CLOSED"===v,label:"closed",onChange:function(e,t){return function(e,t){m("".concat(l,".description"),!0),u("".concat(l,".description")).error?m("".concat(l,".description")):o("".concat(l,".action"),t?"CLOSED":"")}(0,t.checked)}}),i.a.createElement(E.a.Checkbox,{checked:"DEFERRED"===v||"OPEN"===v,label:"Is Open Task",onChange:function(e,t){return function(e,t){m("".concat(l,".description"),!0),u("".concat(l,".description")).error?m("".concat(l,".description")):o("".concat(l,".action"),t?"OPEN":"")}(0,t.checked)}}),i.a.createElement(E.a.Checkbox,{label:"Action Required",checked:"DEFERRED"===v,onChange:function(e,t){return function(e,t){m("".concat(l,".description"),!0),u("".concat(l,".description")).error?m("".concat(l,".description")):o("".concat(l,".action"),t?"DEFERRED":"OPEN")}(0,t.checked)}}))),n&&"CLOSED"!==v&&"DEFERRED"!==v&&i.a.createElement("div",{style:{margin:"0px 3.125em 0.625em 1.5em"}},i.a.createElement(Ye.a,{panels:[{key:"panel-1",title:"Updates",content:"These are updates"}]}),i.a.createElement(we,{name:"".concat(l,".action"),pointing:"below"}),i.a.createElement("div",null,i.a.createElement(p.a,{size:"mini",type:"button",onClick:function(e){return w(e)}}," ",b?"Hide Notes":S?"Show Notes":"Add Notes"),i.a.createElement(p.a.Group,{size:"mini"},i.a.createElement(p.a,{type:"button",size:"mini",positive:!0,value:"CLOSED",onClick:function(e,t){var a=t.value;return j(e,a)}},"Close Task"),i.a.createElement(p.a.Or,{size:"mini"}),i.a.createElement(p.a,{type:"button",size:"mini",negative:!0,value:"DEFERRED",onClick:function(e,t){var a=t.value;return j(e,a)}}," Defer Task to next Shift")))),i.a.createElement(ue,{rows:"1",readOnly:!(!v||"NOTES_ADDED"===v),hidden:!b,style:{paddingBotton:"0.3125em",margin:"0px 3.125em 0.625em 1.5em"},name:"".concat(l,".newNote"),width:"14",onChange:function(e,t){var a=t.value;""!==a.trim()?(o("".concat(l,".newNote"),a),v||o("".concat(l,".action"),"NOTES_ADDED")):(o("".concat(l,".newNote"),""),"NOTES_ADDED"===v&&o("".concat(l,".action"),""))}}))},Ke=function(e){var t=e.tasksIdentifier,a=e.tasks,n=e.taskCategory,r=e.onRemove,l=e.aircraftId;return i.a.createElement(ne.b,{name:"tasks.".concat(t)},(function(e){var c=e.push,o=e.remove;return i.a.createElement(i.a.Fragment,null,a&&a.map((function(e,a){return i.a.createElement(ze,{key:a,label:a,name:"tasks.".concat(t,".").concat(a),disabled:e.id&&("DEFERRED"===e.status||"OPEN"===e.status),onRemove:function(){r&&r(),o(a)}})})),i.a.createElement(p.a,{type:"button",icon:!0,style:{marginLeft:"10px"},primary:!0,onClick:function(e){return c(function(){var e={description:"",status:"",action:"",taskCategory:t};return n&&"AIRCRAFT"===n&&(e.aircraft=l,e.taskCategory=n),e}())}},i.a.createElement(K.a,{name:"plus circle"})," Add"))}))},Ve=function(e){var t=e.costumers,a=e.setCheckedAircrafts,l=e.checkedAircrafts,c=e.values,o=Object(ne.f)().setFieldValue,s=Object(r.useState)({open:!1,aircraft:"",event:""}),m=Object(f.a)(s,2),u=m[0],d=m[1];return i.a.createElement(i.a.Fragment,null,t&&t.map((function(e){return i.a.createElement(r.Fragment,{key:e.name},i.a.createElement(h.a,{as:"h3"},"Work Performed for ",e.name),e.aircrafts.map((function(e){return i.a.createElement(r.Fragment,{key:e.id},i.a.createElement(me,{label:e.registration,checked:l[e.registration]&&l[e.registration].checked,disabled:l[e.registration]&&l[e.registration].disbleCheck,onChange:function(t,r){var i=r.checked;t.preventDefault(),!i||c.tasks[e.registration]&&0!==c.tasks[e.registration].length||(a(Object(n.a)(Object(n.a)({},l),{},Object(te.a)({},e.registration,{checked:i}))),o("tasks.".concat(e.registration),[{description:"",status:"",action:"",taskCategory:"AIRCRAFT",aircraft:e.id}])),i||c.tasks[e.registration].length>0&&d({open:!0,aircraft:e.registration})}},i.a.createElement(Be.a,{open:u.open,header:"Uncheck Aircraft ".concat(u.aircraft),content:"Are you sure you want to uncheck this aircraft? Doing so will remove all the entered tasks for this Aircraft",onCancel:function(){d({open:!1})},onConfirm:function(){console.log("called me"),o("tasks.".concat(u.aircraft),null),a(Object(n.a)(Object(n.a)({},l),{},Object(te.a)({},u.aircraft,{checked:!1}))),d({open:!1})}}),l[e.registration]&&l[e.registration].checked&&i.a.createElement(Ke,{tasksIdentifier:e.registration,tasks:c.tasks[e.registration],taskCategory:"AIRCRAFT",aircraftId:e.id,onRemove:function(){1===c.tasks[e.registration].length&&a(Object(n.a)(Object(n.a)({},l),{},Object(te.a)({},e.registration,{checked:!1})))}})))})))})))},Ue=a(225),Je=a(38),We=function(e){var t=e.setOpen,a=e.open,l=(e.e,Object(ne.f)()),c=l.getFieldMeta,o=l.setFieldValue,s=Object(g.useMutation)(Fe,{onError:function(e){console.log(e)}}),m=Object(f.a)(s,2),v=m[0],S=m[1],j=S.loading,w=S.error,C=S.data,k=c("startTime").value,T=c("endTime").value,R=Object(r.useState)(""),D=Object(f.a)(R,2),A=D[0],I=D[1],$=Object(r.useState)(""),F=Object(f.a)($,2),P=F[0],M=F[1],x=Object(r.useState)(""),H=Object(f.a)(x,2),N=H[0],q=H[1],B=Object(r.useState)(k),Y=Object(f.a)(B,2),z=Y[0],V=Y[1],J=Object(r.useState)(T),W=Object(f.a)(J,2),_=W[0],G=W[1],Q=Object(r.useState)("30"),Z=Object(f.a)(Q,2),X=Z[0],ee=Z[1],te=Object(r.useState)(!1),re=Object(f.a)(te,2),ie=re[0],le=re[1],ce=Object(r.useState)(!1),me=Object(f.a)(ce,2),ue=me[0],ge=me[1];Object(r.useEffect)((function(){V(k),G(T)}),[T,k]),Object(r.useEffect)((function(){if(w&&(ie&&I({type:"error",message:"Failed to register user. ".concat(w.message)}),I(ue?{type:"error",message:"Failed to reset password. ".concat(w.message)}:{type:"error",message:"Failed to add user. ".concat(w.message)})),C&&null!=C.signOffTimeSheet){var e=c("staffs").value;if(U.a.find(e,{id:C.signOffTimeSheet.id}))I({type:"error",message:"".concat(C.signOffTimeSheet.name," is already exist on report")});else{var t=[].concat(Object(ae.a)(e),[{name:C.signOffTimeSheet.name,startTime:C.signOffTimeSheet.startTime,endTime:C.signOffTimeSheet.endTime,signOffKey:C.signOffTimeSheet.value,id:C.signOffTimeSheet.id,break:C.signOffTimeSheet.break}]);o("staffs",t),ie&&(I({type:"success",message:"".concat(C.signOffTimeSheet.name," is added to report.<br/> Further registration instruction sent to email. Please complete registration within 48 hours")}),le(!1)),ue?(I({type:"success",message:"".concat(C.signOffTimeSheet.name," is added to report <br/> Password reset link sent to email.")}),ge(!1)):I({type:"success",message:"".concat(C.signOffTimeSheet.name," is added to report")})}}}),[w,C]);var Ee=function(){var e=Object(d.a)(u.a.mark((function e(t){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=ie?{startTime:t.startTime,endTime:t.endTime,break:parseInt(X),email:t.email,name:t.fullname,additionalAction:"register"}:ue?{startTime:t.startTime,endTime:t.endTime,break:parseInt(X),email:t.resetEmail,additionalAction:"reset"}:{startTime:t.startTime,endTime:t.endTime,break:parseInt(X),username:P,password:N},console.log(a),e.next=4,v({variables:a});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return j?i.a.createElement(ke.a,{active:!0,inverted:!0},i.a.createElement(L.a,{active:!0,inverted:!0},"Veryfing User")):i.a.createElement(Te.a,{closeIcon:!0,closeOnEscape:!1,closeOnDimmerClick:!1,open:a,onClose:function(){ge(!1),le(!1),I(!1),t(!1)},onOpen:function(){return t(!0)}},i.a.createElement(Te.a.Header,null,"Add User to Shift "),i.a.createElement(Te.a.Content,null,A&&(A?i.a.createElement(Ce.a,{success:"success"===A.type,error:"error"===A.type,onDismiss:function(){return I("")}}," ",A.message):null),i.a.createElement(ne.c,{enableReinitialize:!0,initialValues:{startTime:z,endTime:_,breakt:X,username:"",password:"",email:"",fullname:"",resetEmail:""},validate:function(e){var t={};if(t=Object(n.a)(Object(n.a)({},t),Oe(e.startTime,e.endTime)),ue){var a=ye(e.resetEmail);a&&(t.resetEmail=a)}if(ie){var r=ye(e.email);r&&(t.email=r);var i=je(e.fullname);i&&(t.fullname=i)}return console.log(t),t},onSubmit:function(e){console.log(e,"submitted"),Ee(e)}},(function(e){e.values;var t=e.handleSubmit;e.errors,e.touched;return i.a.createElement(E.a,{size:"large",onSubmit:t},i.a.createElement(E.a.Group,null,i.a.createElement(oe,{label:"Start Time",dateTimeFormat:"DD-MM-YYYY HH:mm",name:"startTime",maxDate:fe(Date.now(),30,"m","sub"),minDate:fe(Date.now(),20,"h","sub"),onChange:function(e,t){var a=t.value;V(a)}}),i.a.createElement(oe,{label:"End Time",dateTimeFormat:"DD-MM-YYYY HH:mm",name:"endTime",maxDate:de(Date.now()),minDate:fe(z,20,"m","add"),onChange:function(e,t){var a=t.value;G(a)}}),i.a.createElement(se,{inputlabel:"Break",label:"Minutes ",labelPosition:"right corner",name:"breakt",type:"number",min:"0",onChange:function(e,t){var a=t.value;ee(a)}})),i.a.createElement(h.a,{as:"h5",color:"blue",textAlign:"center"}),!ie&&!ue&&i.a.createElement(i.a.Fragment,null,i.a.createElement(O.a,null,i.a.createElement(b.a,{columns:2,stackable:!0},i.a.createElement(y.a,{vertical:!0},"Or"),i.a.createElement(b.a.Row,{verticalAlign:"middle"},i.a.createElement(b.a.Column,null,i.a.createElement(b.a.Row,{style:{textAlign:"center"}},i.a.createElement(h.a,{as:"h5",icon:!0},i.a.createElement(K.a,{name:"sign in alternate"}),"Use Credentials")),i.a.createElement(b.a.Row,null,i.a.createElement(E.a.Group,null,i.a.createElement(E.a.Input,{label:"Username",onChange:function(e,t){var a=t.value;return M(a)}}),i.a.createElement(E.a.Input,{label:"Password",type:"password",onChange:function(e,t){var a=t.value;return q(a)}})),i.a.createElement(E.a.Field,{style:{textAlign:"center"}},i.a.createElement(p.a,{type:"submit",primary:!0}," Sign ")),i.a.createElement(E.a.Field,{style:{textAlign:"center"}},i.a.createElement(p.a,{size:"tiny",onClick:function(){return ge(!0)}},"Forgot Password")))),i.a.createElement(b.a.Column,{textAlign:"center"},i.a.createElement(b.a.Row,null,i.a.createElement(h.a,{icon:!0},i.a.createElement(K.a,{name:"barcode",size:"massive"}),"Use IdCard")),i.a.createElement(b.a.Row,null,i.a.createElement(p.a,{primary:!0},"Scan")))))),i.a.createElement(Je.a,{style:{textAlign:"center"}},i.a.createElement("label",null," If you do not have a account yet, contact your supervisor or click below."),i.a.createElement(p.a,{type:"button",onClick:function(){return le(!0)}}," New User "))),ie&&i.a.createElement(O.a,{basic:!0},i.a.createElement(Ce.a,{positive:!0},i.a.createElement(Ce.a.Header,null,"Register info"),"Please enter following information to add yourself to shift . Registraion instruction will be forwarded to you on the provided email. It is important that you register as soon as possible."),i.a.createElement(Ce.a,{warning:!0,visible:!0},i.a.createElement(Ce.a.Header,null,"Attention!!"),"Your info will be added to report automatically after this step, make sure you enter your name and work time correctly"),i.a.createElement(E.a.Group,null,i.a.createElement(se,{width:"12",name:"fullname",label:"Full Name"}),i.a.createElement(se,{width:"12",name:"email",label:"Email Address"})),i.a.createElement(Ue.a,null,i.a.createElement(p.a,{positive:!0},"Register"),i.a.createElement(p.a,{type:"button",negative:!0,onClick:function(){return le(!1)}},"Cancel"))),ue&&i.a.createElement(O.a,{basic:!0},i.a.createElement(Ce.a,{warning:!0,visible:!0},i.a.createElement(Ce.a.Header,null,"Reset Password"),"Please enter your email address used while creating account."),i.a.createElement(Ce.a,{warning:!0,visible:!0},i.a.createElement(Ce.a.Header,null,"Attention!!"),"Your info will be added to report automatically after this step, make sure you ",i.a.createElement("strong",null,"Enter your work time correctly")),i.a.createElement(se,{width:"12",name:"resetEmail",label:"Email Address"}),i.a.createElement(Ue.a,null,i.a.createElement(p.a,{primary:!0},"Reset"),i.a.createElement(p.a,{negative:!0,onClick:function(){return ge(!1)}},"Cancel"))))}))))};function _e(){var e=Object(j.a)(["\n  mutation submitReport($station: String!, $shift:String! , $startTime: String! ,$endTime: String!, $tasks: [ShiftReportTask]! , $staffs: [ShiftReportStaffs!]! ) { \n  submitShiftReport(\n    station:$station\n    shift:$shift\n    startTime: $startTime\n    endTime: $endTime\n    tasks:$tasks\n    staffs: $staffs\n  ){\n    endTime\n    id\n    shift\n    staffAndTime {\n      id\n      staff {\n        name\n      }\n      endTime\n      startTime\n    }\n    startTime\n    station {\n      location\n      id\n    }\n    tasks {\n      aircraft {\n        registration\n        id\n        costumer {\n          name\n        }\n      }\n      taskCategory\n      description\n      id\n      status\n      \n    }\n  } \n}\n"]);return _e=function(){return e},e}var Ge=Object(g.gql)(_e()),Qe=function(){var e=Object(r.useContext)(X),t=e.state.station,a=e.state.lastShiftReport,l=Object(r.useState)(!1),c=Object(f.a)(l,2),o=c[0],s=c[1],m=Object(r.useState)(t.costumers),u=Object(f.a)(m,2),d=u[0],b=u[1],v=Object(r.useState)({}),O=Object(f.a)(v,2),S=O[0],y=O[1],j=Object(r.useState)({startTime:"",endTime:"",staffs:[],tasks:{}}),w=Object(f.a)(j,2),C=w[0],k=w[1],T=Object(g.useMutation)(Ge,{onError:function(e){console.log(e)}}),R=Object(f.a)(T,2),D=R[0],A=R[1].data;Object(r.useEffect)((function(){var e={},r={},i=[];a&&a.tasks&&a.tasks.map((function(a){if("DEFERRED"===a.status||"OPEN"===a.status){var l={id:a.id,description:a.description,status:a.status,updates:a.updates,action:"",newNote:"",taskCategory:a.taskCategory};a.aircraft&&(e[a.aircraft.registration]={checked:!0,disbleCheck:!0}),a.aircraft&&r[a.aircraft.registration]?r[a.aircraft.registration].push(Object(n.a)({},l)):a.aircraft?r[a.aircraft.registration]=[Object(n.a)({},l)]:r[a.taskCategory]?r[a.taskCategory].push(l):r[a.taskCategory]=[l],a.aircraft&&(U.a.find(t.costumers,U.a.matchesProperty("name",a.aircraft.costumer.name))||(U.a.find(i,U.a.matchesProperty("name",a.aircraft.costumer.name))?i.aircrafts.push({registration:a.aircraft.registration,id:a.aircraft.id}):i.push({name:a.aircraft.costumer.name,aircrafts:[{registration:a.aircraft.registration,id:a.aircraft.id}]})))}})),b([].concat(Object(ae.a)(d),i)),k(Object(n.a)(Object(n.a)({},C),{},{tasks:r})),y(e)}),[]),Object(r.useEffect)((function(){A&&console.log(A.submitShiftReport)}));return i.a.createElement(i.a.Fragment,null,i.a.createElement(ne.c,{enableReinitialize:!0,initialValues:C,validate:function(e){var t={};t=Object(n.a)(Object(n.a)({},t),Oe(e.startTime,e.endTime));var a=function(e){var t;return e&&e.length?(e&&e.length&&(t=U.a.mapValues(e,(function(e){var t=ve(e);return U.a.isEmpty(t)?(e.signOffKey||(t=Object(n.a)(Object(n.a)({},t),{},{signOffKey:"Each staff must sign off"})),t):t=Object(n.a)(Object(n.a)({},t),{},{signOffKey:"Please fix staff inputs"})}))),U.a.mapKeys(t,(function(e,a){U.a.isEmpty(e)&&delete t[a]})),t):t="Report must have staff information, please add staff"}(e.staffs),r=function(e){if(!e)return null;var t=U.a.mapValues(e,(function(e){var t=U.a.mapValues(e,(function(e){return Se(e)}));return U.a.pickBy(t,U.a.identity)}));return U.a.mapKeys(t,(function(e,a){U.a.isEmpty(e)&&delete t[a]})),t}(e.tasks);return U.a.isEmpty(r)||(t.tasks=r),U.a.isEmpty(a)||(t.staffs=a),t},onSubmit:function(e){console.log("submit Clicked",e);var a=function(e){var a={station:t.id,staffs:e.staffs,startTime:e.startTime,endTime:e.endTime,tasks:{}},r=U.a.reduce(e.tasks,(function(e,t,a){var r=U.a.map(t,(function(e,t){var r;if(C.tasks[a]&&C.tasks[a][t]){r=C.tasks[a]&&C.tasks[a][t];var i=Object.keys(r).filter((function(t){return r[t]!==e[t]}));if(!i)return null;var l=i.reduce((function(t,a){return t[a]=Object(n.a)(Object(n.a)({},t),{},Object(te.a)({},a,e[a]))}),{});e=Object(n.a)({id:e.id},l)}return e}));return r=r.filter((function(e){return null!==e})),[].concat(Object(ae.a)(e),Object(ae.a)(r))}),[]),i=e.staffs.map((function(e){return{signOffKey:e.signOffKey,name:e.name}}));return a=Object(n.a)(Object(n.a)({},a),{},{tasks:r,staffs:i,shift:"Day"})}(e);D({variables:a})}},(function(e){var t=e.values,a=e.handleSubmit,n=e.errors,r=e.touched;return i.a.createElement(i.a.Fragment,null,i.a.createElement(E.a,{onSubmit:a},i.a.createElement(E.a.Group,null,i.a.createElement(oe,{label:"Shift Start Time",name:"startTime",maxDate:fe(Date.now(),30,"m","sub"),minDate:fe(Date.now(),20,"h","sub")}),i.a.createElement(oe,{label:"Shift End Time",name:"endTime",maxDate:de(Date.now()),minDate:fe(t.startTime,20,"m","add")})),i.a.createElement(qe,{values:t,touched:r,errors:n,addStaffOpen:s}),i.a.createElement(Ve,{costumers:d,checkedAircrafts:S,setCheckedAircrafts:y,values:t}),i.a.createElement(h.a,{as:"h3"},"Work Performed for Other Costumer"),i.a.createElement(p.a,{type:"button",icon:!0,primary:!0},i.a.createElement(K.a,{name:"plus circle"})," Add "),i.a.createElement(h.a,{as:"h3"},"Other Tasks"),i.a.createElement(Ke,{tasksIdentifier:"OTHER",tasks:t.tasks.OTHER}," "),i.a.createElement(h.a,{as:"h3"},"Logistics Task"),i.a.createElement(Ke,{tasksIdentifier:"LOGISTICS",tasks:t.tasks.LOGISTICS}," "),i.a.createElement(p.a,{primary:!0,type:"submit"}," Submit Report ")),i.a.createElement(We,{setOpen:s,open:o,shiftStartTime:t.startTime,shiftEndTime:t.endTime}))})))},Ze=a(667),Xe=function(e){var t=e.openReport,a=e.setOpenReport,r=Object(g.useLazyQuery)(x),l=Object(f.a)(r,2),c=l[0],o=l[1],s=o.error,m=o.loading,u=o.data;return i.a.createElement(Te.a,{onClose:function(){return a({id:"",open:!1})},onMount:function(){t.id?c({variables:{id:t.id}}):a(Object(n.a)(Object(n.a)({},t),{},{id:"",open:!1}))},open:t.open},s&&i.a.createElement(i.a.Fragment,null,i.a.createElement(Te.a.Content,null," ",i.a.createElement(h.a,{as:"h5"},"Oouch...Something Went Wrong, Please try again")," ")),m&&i.a.createElement(L.a,{active:!0},"Retriving Report"),u&&u.getShiftReport&&i.a.createElement(i.a.Fragment,null,i.a.createElement(Te.a.Header,null,"Shift Report: ",u.getShiftReport.startTime.split(" ")[0]," ",u.getShiftReport.station.location," ",u.getShiftReport.shift," shift"),i.a.createElement(Te.a.Content,null,i.a.createElement(Z,{reportData:u.getShiftReport}," "))))},et=function(){var e,t=Object(r.useContext)(X).state.station,a=Object(g.useQuery)(H,{variables:{stationId:t.id}}),n=a.error,l=a.loading,c=a.data,o=Object(r.useState)({id:"",open:!1}),s=Object(f.a)(o,2),m=s[0],u=s[1];return c&&(e=c.getReportList,e=U.a.groupBy(e,(function(e){return e.startTime.split(" ")[0]})),e=U.a.mapValues(e,(function(e){return U.a.groupBy(e,(function(e){return e.station.location}))}))),l?i.a.createElement(L.a,{active:!0},"Initiatilizing reporting"):n?(console.log(n),i.a.createElement(h.a,{as:"h5"},"Something Went Wrong, Please try again")):i.a.createElement(i.a.Fragment,null,i.a.createElement(G.a,{compact:!0,celled:!0,striped:!0,structured:!0},i.a.createElement(G.a.Header,null,i.a.createElement(G.a.Row,null,i.a.createElement(G.a.HeaderCell,null," Date "),i.a.createElement(G.a.HeaderCell,{textAlign:"center"}," Station "),i.a.createElement(G.a.HeaderCell,null," Shift "))),i.a.createElement(G.a.Body,null,e&&U.a.map(e,(function(t,a){return i.a.createElement(r.Fragment,{key:a},Object.entries(t).map((function(t,n){var r=Object(f.a)(t,2),l=r[0],c=r[1];return i.a.createElement(G.a.Row,{key:l},0===n&&i.a.createElement(G.a.Cell,{collapsing:!0,rowSpan:Object.keys(e[a]).length},a),i.a.createElement(G.a.Cell,{textAlign:"center"},l),i.a.createElement(G.a.Cell,null,i.a.createElement(Ze.a,{horizontal:!0},U.a.map(c,(function(e){return i.a.createElement(Ze.a.Item,{as:"a",key:e.id,onClick:function(){u({id:e.id,open:!0})}},e.shift)})))))})))})))),i.a.createElement(Xe,{setOpenReport:u,openReport:m}))},tt=function(){var e=Object(s.g)(),t=Object(r.useContext)(X),a=Object(r.useReducer)(ee,t),n=Object(f.a)(a,2),l=n[0],c=n[1];JSON.parse(sessionStorage.getItem("stationKey"))||e.push("/");var o,m=Object(s.i)(),u=m.id,d=m.station,E=Object(r.useState)("lastShiftReport"),p=Object(f.a)(E,2),b=p[0],S=p[1];d&&u&&(o={station:u,flag:"MOST_RECENTLY_COMPLETED"});var y=[Object(g.useQuery)(x,{variables:o}),Object(g.useQuery)(T,{variables:{id:u}})],j=Object(f.a)(y,2),w=j[0],C=w.loading,k=w.error,R=w.data,D=j[1].data;return Object(r.useEffect)((function(){D&&c({type:"INIT_STATION",payload:D.getStation})}),[D]),Object(r.useEffect)((function(){R&&c({type:"ADD_LASTSHIFTREPORT",payload:R.getShiftReport})}),[R]),C?i.a.createElement(L.a,{active:!0},"Fetching Data"):k?"Error! ".concat(k):i.a.createElement(i.a.Fragment,null,i.a.createElement(X.Provider,{value:{state:l,dispatch:c}},i.a.createElement(O.a,{basic:!0},i.a.createElement(h.a,{textAlign:"right",color:"blue",floated:"right"},"Shift Reporting System ",i.a.createElement("br",null),i.a.createElement("span",null,i.a.createElement("h5",null," Station: ",D&&D.getStation.location," "))),i.a.createElement(v.a,{src:"\\LogoBig.png",size:"medium"})),i.a.createElement(B,{activeItem:b,setActiveItem:S}),"lastShiftReport"===b&&i.a.createElement(Z,{reportData:R.getShiftReport}),"browseAllReports"===b&&i.a.createElement(et,null),"startNewReport"===b&&i.a.createElement(Qe,null)))};function at(){var e=Object(j.a)(["\n  mutation registerStaff( $registerCode:String!, $username: String!, $password: String!){\n    registerStaff(\n      registerCode: $registerCode\n      username: $username,\n      password:$password,\n    ){\n      status,\n      message\n\n    }\n  }"]);return at=function(){return e},e}function nt(){var e=Object(j.a)(["\n  mutation addStaff( $name: String!, $email: String!, $contractType: String! , $ contractHours: Int!, $position: String, $idCardCode: String){\n    addStaff(\n      name: $name,\n      email:$email,\n      contractType: $contractType,\n      contractHours: $contractHours,\n      position: $position\n      idCardCode: $idCardCode\n    ){\n      id,\n      name,\n      email,\n      phone\n    }\n  }\n"]);return nt=function(){return e},e}function rt(){var e=Object(j.a)(["\nmutation staffEdit($id:String! $email:String, $phone: String , $contractType: String , $reqHours: Float , $position :String){\n  staffEdit(\n    id: $id,\n    email:$email,\n    phone:$phone,\n    contractType: $contractType,\n    reqHours: $reqHours,\n    position: $position\n  ){\n    id\n    email\n    phone\n    contractType\n    reqHours\n    position\n  }\n}"]);return rt=function(){return e},e}function it(){var e=Object(j.a)(["\nmutation changePassword ( $id: String!, $password: String!, $newPassword: String! ){\n  changePassword ( \n    id: $id,\n    password: $password,\n    newPassword: $newPassword\n    ){\n      status\n      message\n    }\n}"]);return it=function(){return e},e}function lt(){var e=Object(j.a)(["\nmutation resetPasswordReq ($id: String!){\n  resetPasswordReq(\n    id: $id,\n  ){\n    status\n    message\n  }\n}"]);return lt=function(){return e},e}function ct(){var e=Object(j.a)(["\nmutation resetRegisterCode ($id: String!){\n  resetRegisterCode(\n    id: $id,\n  ){\n    status\n    message\n  }\n}"]);return ct=function(){return e},e}function ot(){var e=Object(j.a)(["\nmutation resetPassword ($resetCode: String!, $password: String!){\n  resetPassword(\n    password: $password,\n    resetCode: $resetCode\n  ){\n    status\n    message\n  }\n}"]);return ot=function(){return e},e}function st(){var e=Object(j.a)(["\n  mutation staffLogin($username: String!, $password:String!){\n    staffLogin(username: $username, password: $password) \n  }\n"]);return st=function(){return e},e}var mt=Object(g.gql)(st()),ut=(Object(g.gql)(ot()),Object(g.gql)(ct())),dt=Object(g.gql)(lt()),ft=Object(g.gql)(it()),gt=Object(g.gql)(rt()),Et=Object(g.gql)(nt()),pt=Object(g.gql)(at()),bt=function(){var e=Object(s.g)(),t=Object(r.useState)(""),a=Object(f.a)(t,2),n=a[0],l=a[1],c=Object(r.useState)(""),o=Object(f.a)(c,2),m=o[0],S=o[1],j=Object(g.useMutation)(mt,{onError:function(e){console.log(e)}}),w=Object(f.a)(j,2),C=w[0],k=w[1],T=(k.loading,k.error),R=k.data;Object(r.useEffect)((function(){if(R){var t=R.staffLogin;sessionStorage.setItem("staffKey",JSON.stringify(t)),e.push("/staff/".concat(t.id))}}),[R]);var D=function(){var e=Object(d.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),C({variables:{username:n,password:m}});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),A=JSON.parse(sessionStorage.getItem("staffKey"));return A&&e.push("/staff/".concat(A.id)),T?"Error! ".concat(T):i.a.createElement(b.a,{textAlign:"center",style:{height:"100vh"},verticalAlign:"middle"},i.a.createElement(b.a.Column,{style:{maxWidth:450}},i.a.createElement(h.a,{as:"h2",color:"blue",textAlign:"center"},i.a.createElement(v.a,{src:"/LogoMin.png"}),"  Log-in to your account"),i.a.createElement(E.a,{size:"large",style:{textAlign:"left"},onSubmit:D},i.a.createElement(O.a,{stacked:!0},i.a.createElement(E.a.Input,{fluid:!0,icon:"user",iconPosition:"left",placeholder:"username",onChange:function(e,t){var a=t.value;return l(a)}}),i.a.createElement(E.a.Input,{fluid:!0,icon:"lock",iconPosition:"left",placeholder:"Password",type:"password",onChange:function(e,t){var a=t.value;return S(a)}}),i.a.createElement(p.a,{type:"submit",color:"blue",fluid:!0,size:"large"},"Login"))),i.a.createElement(y.a,{horizontal:!0},"Or"),i.a.createElement(O.a,{stacked:!0},i.a.createElement(p.a,{type:"button",content:"Log in to station",size:"large",color:"teal",fluid:!0,onClick:function(){return e.push("/stationLogin")}}))))},ht=a(664),vt=a(171),Ot=a(172),St=a(114),yt=a(98),jt=a(235),wt=a(165),Ct=a(92),kt=a(140),Tt=a(669);function Rt(){var e=Object(j.a)(["\nquery getAllTimeSheets(\n  $staffId: String, $staff: [String] ,$period: String, $from: String , $to: String, $number: Int, $groupBy: String , $year: Int, $stations: [String], $filterStatus: String\n){\n  getAllTimeSheets(\n    staff:$staff,\n    period:$period,\n    from: $from,\n    to:$to ,\n    number:$number ,\n    groupBy:$groupBy,\n    year:$year ,\n    stations:$stations\n    filterStatus: $filterStatus\n    )\n  getStaff(\n      id: $staffId\n      ){    \n    name}\n   \n}"]);return Rt=function(){return e},e}function Dt(){var e=Object(j.a)(["query getTimesheetByUser($staff: String!, $filterDuration: String! ,$number: Int!, $year: Int!){\n  getTimeSheetByUser(\n    staff: $staff,\n     filterDuration: $filterDuration, \n     number: $number, \n     year: $year\n    ) {\n      id\n      startTime\n      status\n      date\n      endTime\n      break\n      remarks{\n        by\n        date\n        edit\n        text\n        title\n      }\n      staff{\n        name\n        reqHours\n        contractType\n      }\n      shiftReport {\n        shift\n        id\n        station {\n          id\n          location\n        }\n      }\n\n      shift\n      station{\n        id\n        location\n      }\n\n  },\n\n  getStaff(\n    id: $staff\n    ){    \n  name}\n\n}"]);return Dt=function(){return e},e}var At=Object(g.gql)(Dt()),It=Object(g.gql)(Rt()),$t=function(e){var t=Object.assign({},e),a=Object(ne.e)(t),n=Object(f.a)(a,2),r=n[0],l=n[1];return i.a.createElement(E.a.Field,null,i.a.createElement("label",null,t.inputlabel),i.a.createElement(le.a,Object.assign({},r,t,{error:l.touched&&l.error})))},Ft=function(e){var t=e.name,a=Object(ne.f)().getFieldProps,n=a("".concat(t,".title")).value,r=a("".concat(t,".date")).value,l=a("".concat(t,".by")).value,c=a("".concat(t,".text")).value,o=a("".concat(t,".edit")).value;return n&&"Add Clearification"!==n?i.a.createElement(O.a,null,i.a.createElement(h.a,{as:"h5"},n,i.a.createElement(h.a.Subheader,null,"by ",l," on ",r)),n&&i.a.createElement("p",null,c),o&&i.a.createElement(Ze.a,null,U.a.map(o,(function(e,t){return i.a.createElement(Ze.a.Item,{key:t},t[0].toUpperCase()+t.substring(1).replace(/([a-z])([A-Z])/g,"$1 $2"),":",i.a.createElement("span",{style:{color:"red",fontStyle:"italic",textDecoration:"line-through"}}," ",e.split("to")[0]," "),"to",i.a.createElement("span",{style:{color:"green"}}," ",e.split("to")[1]," "))})))):i.a.createElement(O.a,{basic:!0},n&&i.a.createElement(h.a,{as:"h5"},"Add Clearification"===n&&"Clearification Added",i.a.createElement(h.a.Subheader,null,"by ",l," on ",r)),i.a.createElement(ue,{name:"".concat(t,".text")}))},Pt=function(e){var t=e.label,a=Object(re.a)(e,["label"]),n=Object(ne.f)().setFieldValue,r=Object(ne.e)(a),l=Object(f.a)(r,2),c=l[0],o=l[1];return i.a.createElement(E.a.Field,{error:!(!o.touched||!o.error)},!a.labeled&&i.a.createElement("label",null,t),i.a.createElement(le.a,{label:!!a.labeled&&t,input:i.a.createElement(kt.a,Object.assign({},c,a,{style:a.labeled?{margin:0,borderTopLeftRadius:0,borderBottomLeftRadius:0}:{},onChange:a.onChange?a.onChange:function(e,t){var r=t.value;n(a.name,r)}}))}),o.touched&&o.error&&i.a.createElement(z.a,{pointing:!0,prompt:!0},o.error))},Mt=function(e){var t=Object(s.i)(),a=JSON.parse(sessionStorage.getItem("staffKey")),l=Object(g.useQuery)(k,{skip:!1===e.add}),c=l.loading,o=l.data,m=Object(g.useLazyQuery)(N),b=Object(f.a)(m,2),v=b[0],S=b[1],y=S.loading,j=S.data,w=Object(g.useMutation)(Pe),C=Object(f.a)(w,2),T=C[0],R=C[1].loading,D=Object(r.useState)([]),A=Object(f.a)(D,2),I=A[0],$=A[1],F=Object(r.useState)(!1),P=Object(f.a)(F,2),M=P[0],x=P[1];Object(r.useEffect)((function(){if(o){var e=o.allStations.map((function(e,t){return{key:t,value:e.id,text:e.location}}));$(e)}}),[o]);var H=function(e){if(o){var t=o.allStations.filter((function(t){return t.id===e}));if(t&&t[0].shifts)return t[0].shifts.map((function(e,t){return{key:t,value:e.name,text:e.name}}))}},q=function(e,t,a){var n=new Date(ge(e)),r=new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate())).toISOString();v({variables:{date:r,shift:t,station:a}})},B=function(){var a=Object(d.a)(u.a.mark((function a(r){var i;return u.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:i=Object(n.a)(Object(n.a)({},r),{},{break:parseInt(r.break)}),j&&j.getShiftReportByShift&&j.getShiftReportByShift.id&&(i.handover=j.getShiftReportByShift.id),e.add||(i.id=e.id),r.remarks.length>=e.remarks.length&&i.remarks.splice(0,e.remarks.length),T({variables:i,update:function(a,r){e.add&&a.modify({fields:{getTimeSheetByUser:function(e,t){var a=t.readField,n=r.data.addToTimeSheet;return e.some((function(e){return a("id",e)===n.id}))?e:[].concat(Object(ae.a)(e),[n])},getAllTimeSheets:function(e,a){a.readField;var i=t.period;if(!i)return e;var l=r.data.addToTimeSheet,c=U.a.cloneDeep(e),o=((ge(l.endTime)-ge(l.startTime))/36e5-(l.break||0)/60).toFixed(1);if(c[i]||(c[i]={}),!c[i][l.staff.name])return c[i][l.staff.name]={},c[i][l.staff.name].station=Object(te.a)({},l.station.location,1),c[i][l.staff.name].itemsPending=1,c[i][l.staff.name].totHours=o,c;var s=c[i][l.staff.name].station;return c[i][l.staff.name]=Object(n.a)(Object(n.a)({},c[i][l.staff.name]),{},{itemsPending:c[i][l.staff.name].itemsPending+1,totHours:(parseFloat(c[i][l.staff.name].totHours)+parseFloat(o)).toFixed(1),station:Object(n.a)(Object(n.a)({},s),{},Object(te.a)({},l.station.location,s[l.station.location]+1))}),c}},broadcast:!1})}});case 5:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),Y=function(){e.setOpen(!1),x(!1)},z=e.add?"Adding Work Time Record to Date ".concat(de(Date.parse(e.date)).split(" ")[0]):"Editing Work Time Record to Date ".concat(de(Date.parse(e.date)).split(" ")[0]);return i.a.createElement(Te.a,{closeIcon:!0,closeOnEscape:!1,closeOnDimmerClick:!1,open:e.open,onClose:function(){return Y()},onOpen:function(){return e.setOpen(!0)}},i.a.createElement(Te.a.Header,null,z," "),i.a.createElement(Te.a.Content,null,R&&i.a.createElement(ke.a,{active:!0},i.a.createElement(L.a,null)),i.a.createElement(ne.c,{initialValues:function(){var t={startTime:e.startTime,endTime:e.endTime,break:e.break||30,remarks:e.remarks||[]};return e.add&&(t.staff=e.staffId,t.startTime=de(new Date(e.date).setHours(0)),t.endTime=new Date(e.date).setHours(8)>Date.now()?de(ge(Date.now())):de(new Date(e.date).setHours(8)),t.station="",t.shift="",t.remarks=[{title:"Manually Entered to TimeSheet",date:de(Date.now()),by:a.name}]),t}(),validate:function(t){var r={};return r=Object(n.a)(Object(n.a)({},r),Oe(t.startTime,t.endTime,e.date)),U.a.isEmpty(r)&&function(t){if(!e.add){var n=0===e.remarks.length?0:e.remarks.length,r=Object(ae.a)(t.remarks);t.startTime===e.startTime&&t.endTime===e.endTime||((!r[n]||r[n]&&"Edited"!==r[n].title)&&r.splice(n,0,{title:"Edited",date:de(Date.now()),by:a.name,edit:{}}),t.startTime!==e.startTime&&(r[n].edit.startTime="".concat(e.startTime," to  ").concat(t.startTime)),t.endTime!==e.endTime&&(r[n].edit.endTime="".concat(e.endTime," to  ").concat(t.endTime)),t.remarks=r),t.startTime===e.startTime&&r[n]&&t.remarks[n].edit&&delete r[n].edit.startTime,t.endTime===e.endTime&&r[n]&&t.remarks[n].edit&&delete r[n].edit.endTime,r[n]&&r[n].edit&&U.a.isEmpty(r[n].edit)&&r.splice(n,1),t.remarks=r}}(t),r},onSubmit:function(e){if(e.remarks.length&&!e.remarks[e.remarks.length-1].title&&!e.remarks[e.remarks.length-1].text){var t=Object(ae.a)(e.remarks);t.splice(e.remarks.length-1,1),e.remarks=t}e.remarks.length&&!e.remarks[e.remarks.length-1].title&&e.remarks[e.remarks.length-1].text&&(e.remarks[e.remarks.length-1].title="Remark Added"),B(e)}},(function(t){var n=t.values,r=t.handleSubmit,l=t.setFieldValue;return i.a.createElement(E.a,{size:"large",style:{marginBottom:"5rem"},onSubmit:r},i.a.createElement(E.a.Group,null,i.a.createElement(oe,{label:"Start Time",dateTimeFormat:"DD-MM-YYYY HH:mm",name:"startTime",maxDate:fe(Date.now(),30,"m","sub"),minDate:de(Date.parse(e.date))}),i.a.createElement(oe,{label:"End Time",dateTimeFormat:"DD-MM-YYYY HH:mm",name:"endTime",maxDate:Date.now()<ge(n.endTime)?de(Date.now()):fe(n.startTime,20,"h","add"),minDate:fe(n.startTime,20,"m","add")}),i.a.createElement($t,{inputlabel:"Break",label:"Minutes ",labelPosition:"right corner",name:"break",type:"number",min:"0"})),e.add&&i.a.createElement(E.a.Group,null,i.a.createElement(Pt,{label:" Select Station",loading:c,name:"station",placholder:"Select Station",search:!0,selection:!0,options:I,onChange:function(e,t){var a=t.value;l("station",a);var r=function(e,t){if(o){var a=o.allStations.filter((function(e){return e.id===t}));if(a&&a[0].shifts){var n=new Date(ge(e));return a[0].shifts.reduce((function(e,t){var a=t.startTime.split(":"),r=new Date(n);r.setHours(a[0]),r.setMinutes(a[1]);var i=(n-r)/36e5;return e.diff<0&&i>e.diff||e.diff>=0&&i<e.diff&&i<0?{name:t.name,diff:i}:e}),{name:"",diff:-24}).name}}}(n.startTime,a);l("shift",r),q(n.startTime,r,a)}}),i.a.createElement(Pt,{label:" Select Shift",disabled:!n.station,name:"shift",placholder:"Select Shift",search:!0,selection:!0,options:n.station?H(n.station):[],onChange:function(e,t){var a=t.value;l("shift",a),q(n.startTime,a,n.station)}})),y&&i.a.createElement(O.a,{secondary:!0,loading:!0},"Verifying ",n.shift," Shift"),n.shift&&j&&j.getShiftReportByShift&&i.a.createElement(O.a,{clearing:!0,secondary:!0},i.a.createElement(h.a,{as:"h3"},i.a.createElement(K.a,{name:"check circle",color:"green"})," Verified"),i.a.createElement(h.a,{floated:"left",as:"h5"},j.getShiftReportByShift.station.location," ",n.shift," Shift ",j.getShiftReportByShift.startTime.split(" ")[0],i.a.createElement(h.a.Subheader,null,i.a.createElement("strong",null," Shift Start : ")," ",j.getShiftReportByShift.startTime,i.a.createElement("strong",null," Shift End : ")," ",j.getShiftReportByShift.endTime," ")),i.a.createElement(p.a,{floated:"right",onClick:function(){return e.openReport({id:j.getShiftReportByShift.id,open:!0})}}," View Shift Report")),n.shift&&j&&!j.getShiftReportByShift&&i.a.createElement(Ce.a,{warning:!0,visible:!0,header:"Selected shift is not reported",content:"Adding to record to unreported shift will not be reflected on any shift reports thus cannot be verified. This may result on work time not being approved"}),i.a.createElement("label",null,i.a.createElement("strong",null,"Remarks")),i.a.createElement(ne.b,{name:"remarks"},(function(e){var t=e.push,r=e.remove;return i.a.createElement(i.a.Fragment,null,n.remarks&&n.remarks.length>0&&n.remarks.map((function(e,t){return i.a.createElement(Ft,{key:t,name:"remarks.".concat(t)})})),i.a.createElement(E.a.Button,{type:"button",onClick:function(e){e.preventDefault(),M?(r(n.remarks.length-1),x(!1)):(n.remarks.length>0&&"Clearification Requested"===n.remarks[n.remarks.length-1].title?t({title:"Add Clearification",date:de(Date.now()),by:a.name,text:""}):t({title:"",date:de(Date.now()),by:a.name,text:""}),x(!0))}},!M&&n.remarks.length>0&&"Clearification Requested"===n.remarks[n.remarks.length-1].title?"Add Clearification":M?"Remove Remark":"Add Remark"))})),i.a.createElement(p.a,{type:"submit",floated:"right",positive:!0},"Save"),i.a.createElement(p.a,{type:"button",floated:"right",negative:!0,onClick:function(){return Y()}},"Cancel"))}))))};function xt(){var e=Object(j.a)([" fragment ReadRemarks on TimeSheet {\n            remarks\n          }"]);return xt=function(){return e},e}function Ht(){var e=Object(j.a)(["fragment AddRemarks on TimeSheet {\n            remarks\n          }"]);return Ht=function(){return e},e}var Nt=function(e){var t=e.timeSheet,a=e.rowSpan,l=e.openReport,c=e.index,o=e.date,m=e.staffId,u=JSON.parse(sessionStorage.getItem("staffKey")),d=Object(s.i)(),b=u.permission&&u.permission.timesheet,v=t.startTime,S=t.endTime,y=t.station&&t.station.location,j=t.shiftReport&&t.shiftReport.shift||t.shift,w=t.break,C=t.total,k=t.overTime,T=t.remarks||[],R=Object(r.useState)(!1),D=Object(f.a)(R,2),A=D[0],I=D[1],$=Object(r.useState)(!1),F=Object(f.a)($,2),P=F[0],M=F[1],x=Object(r.useState)(!1),H=Object(f.a)(x,2),N=H[0],L=H[1],q=Object(r.useState)(!1),B=Object(f.a)(q,2),Y=B[0],z=B[1],K=Object(r.useState)(""),V=Object(f.a)(K,2),J=V[0],W=V[1],_=Object(g.useMutation)(Me),Q=Object(f.a)(_,2),Z=Q[0],X=Q[1].loading,ee=Object(g.useMutation)(xe),ae=Object(f.a)(ee,2),ne=ae[0],re=ae[1].loading,ie=Object(g.useMutation)(He),le=Object(f.a)(ie,2),ce=le[0],oe=le[1].loading,se=!t.id.toString().match(/^[0-9a-fA-F]{24}$/);return i.a.createElement(G.a.Row,{key:t.id,negative:!function(){var e=new Date(o).getDay();return 0!==e&&6!==e}()},0===c&&i.a.createElement(G.a.Cell,{collapsing:!0,rowSpan:a},o.split("T")[0]),i.a.createElement(G.a.Cell,null," ",y," "),i.a.createElement(G.a.Cell,{onClick:function(e){e.preventDefault(),l({id:t.shiftReport&&t.shiftReport.id,open:!0})}},t.shiftReport&&t.shiftReport.id?i.a.createElement("a",{href:""}," ",j," "):j?"".concat(j," "):"","  "),i.a.createElement(G.a.Cell,null,v&&v.split(" ")[1]),i.a.createElement(G.a.Cell,null," ",S&&S.split(" ")[1]," "),i.a.createElement(G.a.Cell,null," ",w," "),i.a.createElement(G.a.Cell,null," ",C||""," "),0===c&&i.a.createElement(G.a.Cell,{rowSpan:a}," ",k||""," "),i.a.createElement(G.a.Cell,null," ","PENDING_APPROVAL"===t.status?"No":"APPROVED"===t.status?"Yes":t.status," "),i.a.createElement(G.a.Cell,null,T&&T.length>0&&i.a.createElement(i.a.Fragment,null,"".concat(T[T.length-1].title," ").concat(T[T.length-1].date.split(" ")[0]),"  ",i.a.createElement("br",null),"  ",T[T.length-1].text,"`  ",i.a.createElement("br",null),i.a.createElement("a",{href:"#",onClick:function(e){e.preventDefault(),I(!0)}},"See all"))),i.a.createElement(G.a.Cell,null,i.a.createElement(O.a,{loading:X||re||oe,disabled:X||re||oe,size:"tiny",basic:!0,style:{width:"max-content",display:"inline-block"}},se&&b&&(b.edit.length>0||u.id===m)&&i.a.createElement(p.a,{icon:"add",size:"mini",circular:!0,onClick:function(){M(!0),I(!0)}}),!se&&i.a.createElement(i.a.Fragment,null,"APPROVED"!==t.status&&0!==b.edit.filter((function(e){return t.station&&e._id===t.station.id})).length&&i.a.createElement(Tt.a,{trigger:i.a.createElement(p.a,{icon:"edit",size:"mini",circular:!0,onClick:function(){M(!1),I(!0)}}),content:"Edit Timesheet",position:"bottom center"}),0!==b.sign.filter((function(e){return t.station&&e._id===t.station.id})).length&&u.id!==m&&i.a.createElement(i.a.Fragment,null,i.a.createElement(Tt.a,{trigger:i.a.createElement(p.a,{color:"APPROVED"===t.status?"green":"grey",icon:"check",size:"mini",circular:!0,onClick:function(){Z({variables:{id:t.id,status:"APPROVED"===t.status?"":"APPROVED"},update:function(e,a){e.modify({fields:{getAllTimeSheets:function(e,n){n.readField;var r=d.period;if(!r)return e;var i=a.data.approveTimeSheet.status,l=U.a.cloneDeep(e);return console.log("before",l[r][t.staff.name].itemsPending),l[r][t.staff.name].itemsPending="APPROVED"===i?l[r][t.staff.name].itemsPending-1:l[r][t.staff.name].itemsPending+1,l}}})}})}}),content:"APPROVED"===t.status?"Undo Approve":"Approve",position:"bottom center"}),"APPROVED"!==t.status&&i.a.createElement(Tt.a,{size:"huge",wide:"very",style:{width:"100%"},trigger:i.a.createElement(p.a,{color:"blue",icon:"talk",size:"mini",circular:!0}),onOpen:function(){return z(!0)},onClose:function(){return z(!1)},open:Y,content:i.a.createElement(E.a,{onSubmit:function(){!function(){var e={id:t.id,clearify:J};ce({variables:e,update:function(e,a){e.writeFragment({id:"TimeSheet:".concat(t.id),fragment:Object(g.gql)(Ht()),data:{remarks:a.data.requestClarification.remarks}});var n=e.readFragment({id:"TimeSheet:".concat(t.id),fragment:Object(g.gql)(xt())});console.log(n)}})}(),z(!1)}},i.a.createElement(h.a,{as:"h5"},"Request Clearification "),i.a.createElement(E.a.TextArea,{value:J,onChange:function(e,t){var a=t.value;return W(a)}}),i.a.createElement(E.a.Button,{floated:"right",type:"submit",primary:!0}," Send")),on:"click",position:"bottom right"})),"APPROVED"!==t.status&&(0!==b.edit.filter((function(e){return t.station&&e._id===t.station.id})).length||u.id===m)&&i.a.createElement(Tt.a,{as:Ce.a,warning:!0,trigger:i.a.createElement(p.a,{color:"red",icon:"trash",size:"mini",circular:!0}),content:i.a.createElement(i.a.Fragment,null,i.a.createElement(Ce.a.Header,null,"Are you sure, you want to remove this record?"),i.a.createElement("p",null," Action is non reversible and will remove all the instances of this record from the system."),i.a.createElement(p.a,{fluid:!0,color:"red",icon:"trash",content:"Confirm",onClick:function(){t.id,ne({variables:{id:t.id},update:function(e,a){a.data.deleteTimeSheet&&"SUCCESS"===a.data.deleteTimeSheet.status&&e.modify({fields:{getTimeSheetByUser:function(e){return e.DELETE},getAllTimeSheets:function(e,a){a.readField;var r=d.period;if(!r)return e;var i=U.a.cloneDeep(e),l=i[r][t.staff.name].totHours-C;if(0===l)return delete i[r],i;var c=i[r][t.staff.name].station;return i[r][t.staff.name]=Object(n.a)(Object(n.a)({},i[r][t.staff.name]),{},{itemsPending:i[r][t.staff.name].itemsPending-1,totHours:l,station:Object(n.a)(Object(n.a)({},c),{},Object(te.a)({},t.station.location,c[t.station.location]-1))}),i}},broadcast:!1})}}),L(!1)}})),on:"click",onOpen:function(){return L(!0)},onClose:function(){return L(!1)},open:N,position:"bottom center"})))),i.a.createElement(Mt,{staffId:m,id:t.id,openReport:l,date:o,open:A,setOpen:I,startTime:v,endTime:S,break:w,add:P,remarks:T}))},Lt=function(e){var t,a=e.startDate,l=e.endDate,c=e.data,o=e.staffId,s=(e.setAllApproved,e.title),m=Object(r.useState)({id:"",open:!1}),u=Object(f.a)(m,2),d=u[0],g=u[1],E=Object(ae.a)(new Array(Math.ceil((l-a)/864e5)+1)).map((function(e,t){var n=t;return new Date(Date.UTC(a.getFullYear(),a.getMonth(),a.getDate()+n)).toISOString()})),p=U.a.zipObject(E,E.map((function(e,t){return[{id:t}]}))),b=0,v=0;if(c){var O=(t=U.a.groupBy(c.getTimeSheetByUser,"date"))&&U.a.mapValues(t,(function(e,t){var a=0,r=0;return(e=e.map((function(e,t){var i=60*e.break*1e3,l=((ge(e.endTime)-ge(e.startTime)-i)/36e5).toFixed(1);return e=Object(n.a)(Object(n.a)({},e),{},{total:parseFloat(l)}),a+=parseFloat(l),r=(a-e.staff.reqHours).toFixed(1),e})))[0]=Object(n.a)(Object(n.a)({},e[0]),{},{overTime:r}),v+=parseFloat(r),b+=a,e}));t=Object(n.a)(Object(n.a)({},p),O)}var S={position:"sticky",top:"0",zIndex:1};return i.a.createElement(i.a.Fragment,null,s&&i.a.createElement(h.a,{as:"h5",floated:"right"},s),i.a.createElement(G.a,{celled:!0,striped:!0,structured:!0,textAlign:"center"},i.a.createElement(G.a.Header,null,i.a.createElement(G.a.Row,null,i.a.createElement(G.a.HeaderCell,{style:S}," Date "),i.a.createElement(G.a.HeaderCell,{style:S}," Station "),i.a.createElement(G.a.HeaderCell,{style:S}," Shift "),i.a.createElement(G.a.HeaderCell,{style:S}," Start Time "),i.a.createElement(G.a.HeaderCell,{style:S}," End Time "),i.a.createElement(G.a.HeaderCell,{style:S}," Break (Mins) "),i.a.createElement(G.a.HeaderCell,{style:S}," Total (Hrs) "),i.a.createElement(G.a.HeaderCell,{style:S}," OverTime "),i.a.createElement(G.a.HeaderCell,{style:S}," Approved "),i.a.createElement(G.a.HeaderCell,{style:S}," Remarks "),i.a.createElement(G.a.HeaderCell,{style:S}," Actions"))),i.a.createElement(G.a.Body,null,t&&U.a.map(t,(function(e,t){return i.a.createElement(r.Fragment,{key:t},e.map((function(a,n){return i.a.createElement(Nt,{staffId:o,date:t,index:n,key:a.id,openReport:g,timeSheet:a,rowSpan:e.length})})))}))),i.a.createElement(G.a.Footer,null,i.a.createElement(G.a.Row,null,i.a.createElement(G.a.HeaderCell,{colSpan:"6"},"Total"),i.a.createElement(G.a.HeaderCell,null," ",b.toFixed(1)," "),i.a.createElement(G.a.HeaderCell,null," ",v.toFixed(1)," "),i.a.createElement(G.a.HeaderCell,{colSpan:"3"})))),i.a.createElement(Xe,{setOpenReport:g,openReport:d}))},qt=function(e){var t=e.staffId,a=e.setStaffName,n=e.period,l=e.selected,c=e.selectedYear,o=e.timesheetOnly,s=JSON.parse(sessionStorage.getItem("staffKey")),m=Object(r.useState)(n||"week"),u=Object(f.a)(m,2),d=u[0],b=u[1],v=new Date,S=Object(r.useState)(l||Ee(v)),y=Object(f.a)(S,2),j=y[0],w=y[1],C=Object(r.useState)(c||v.getFullYear()),k=Object(f.a)(C,2),T=k[0],R=k[1],D={staff:t||s.id,filterDuration:d,number:j,year:T},A=Object(g.useQuery)(At,{variables:D}),I=A.error,$=A.loading,F=A.data;Object(r.useEffect)((function(){F&&F.getStaff&&a(F.getStaff.name)}),[F]);var P=new Proxy(["January","February","March","April","May","June","July","August","September","October","November","December"],{get:function(e,t){return isNaN(t)||(t=parseInt(t,10))<0&&(t+=e.length),e[t]}}),M=function(){var e;return e="month"===d?new Date(T,j,1):pe(j,T),e=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()))}(),x=function(){var e;if("month"===d)e=new Date(T,j+1,0);else{var t=pe(j,T);e=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate()+6))}return e>=v&&(e=new Date(Date.UTC(v.getFullYear(),v.getMonth(),v.getDate()))),e}();if($)return i.a.createElement(L.a,{active:!0},"Fetching timesheets");if(I)return console.log(I),i.a.createElement(h.a,{as:"h5"},"Something Went Wrong, Please try again");var H=function(){var e=!1;return F&&F.getTimeSheetByUser&&F.getTimeSheetByUser.length>0&&(e=!F.getTimeSheetByUser.some((function(e){return"APPROVED"!==e.status}))),e};return i.a.createElement(i.a.Fragment,null,i.a.createElement(O.a,{basic:!0,style:{marginBottom:"20em"}},i.a.createElement(E.a,null,!o&&i.a.createElement(i.a.Fragment,null,i.a.createElement("label",null," Select by: "),i.a.createElement(E.a.Group,null,i.a.createElement(E.a.Field,null,i.a.createElement(kt.a,{selection:!0,options:[{key:1,text:"Month",value:"month"},{key:2,text:"Week",value:"week"}],onChange:function(e,t){var a=t.value;b(a),w("month"===a?v.getMonth():Ee(v))},value:d})),i.a.createElement(E.a.Field,null,i.a.createElement(kt.a,{compact:"month"!==d,selection:!0,options:"month"===d?function(){var e=v.getMonth();return[{key:1,text:P[e],value:e},{key:2,text:P[e-1],value:e-1<0?P.length+e-1:e-1},{key:3,text:P[e-2],value:e-2<0?P.length+e-2:e-2},{key:4,text:P[e-3],value:e-3<0?P.length+e-3:e-3}]}():function(){for(var e=v.getMonth(),t=v.getFullYear(),a=Ee(new Date(t-1,11,28)),n=Ee(new Date(t,e-3,1)),r=[],i=Ee(v);i!==n-1;){var l={key:i,text:i,value:i};r.push(l),0===(i-=1)&&(i=a)}return r}(),onChange:function(e,t){var a=t.value;w(a),"week"===d&&a>Ee(v)&&R(v.getFullYear-1),"month"===d&&a>v.getMonth()&&R(v.getFullYear-1)},value:j})))),i.a.createElement(Lt,{staffId:t,startDate:M,endDate:x,data:F,title:"Timesheet ".concat("month"===d?P[j]:"Week ".concat(j,",")," ").concat(T," ")}),t===s.id&&i.a.createElement(O.a,{basic:!0,clearing:!0},i.a.createElement(Tt.a,{trigger:i.a.createElement("span",{floated:"right"},i.a.createElement(p.a,{floated:"right",disabled:!H(),type:"button",color:"blue"}," Submit to Payroll")),disabled:H(),content:" All records should be approved for submission"})))))};function Bt(){var e=Object(j.a)(["\n  query verifyUsername( $username: String!){\n    verifyUsername(   \n      username: $username,\n    ){\n      status,\n      message\n    }\n  }"]);return Bt=function(){return e},e}function Yt(){var e=Object(j.a)(["\n  query{ allStaff {\n    id\n    name\n    email\n    phone\n    lastActive{\n      station{\n        location\n      }\n      activeAt\n    }\n  }}\n"]);return Yt=function(){return e},e}function zt(){var e=Object(j.a)(["\n  query{ allStaff {\n    id\n    name\n  }}\n"]);return zt=function(){return e},e}function Kt(){var e=Object(j.a)(["\nquery fetchStaff($registerCode:String,){\n    getStaff(\n      registerCode: $registerCode\n      ){ \n    name\n    }\n  }\n"]);return Kt=function(){return e},e}function Vt(){var e=Object(j.a)(["\nquery fetchStaff($id:String, $registerCode:String, $withPermission: Boolean!){\n    getStaff(\n      id: $id\n      registerCode: $registerCode\n      ){ \n    id     \n    name\n    idCardCode\n    currentStation{\n      location\n    }\n    email\n    position\n    contractType\n    lastActive{\n      station{\n        location\n      }\n      activeAt\n    }\n    username\n    resetCode\n    phone\n    reqHours\n    registerCode\n    permission  @include(if: $withPermission ) {\n      id\n      station\n      timesheet\n      staff\n      admin\n    }\n    }\n  }\n"]);return Vt=function(){return e},e}var Ut=Object(g.gql)(Vt()),Jt=Object(g.gql)(Kt()),Wt=Object(g.gql)(zt()),_t=Object(g.gql)(Yt()),Gt=Object(g.gql)(Bt()),Qt=function(e){var t=e.setFilter,a=JSON.parse(sessionStorage.getItem("staffKey")),n=Object(s.i)(),l=new Date,c=Object(r.useState)([]),o=Object(f.a)(c,2),m=o[0],u=o[1],d=Object(r.useState)("date"),p=Object(f.a)(d,2),b=p[0],h=p[1],v=Object(r.useState)([]),S=Object(f.a)(v,2),y=S[0],j=S[1],w=Object(r.useState)("week"),C=Object(f.a)(w,2),k=C[0],T=C[1],R=Object(r.useState)(de(new Date(l.getFullYear(),l.getMonth()-3,1)).split(" ")[0]),D=Object(f.a)(R,2),A=D[0],I=D[1],$=Object(r.useState)(de(l).split(" ")[0]),F=Object(f.a)($,2),P=F[0],M=F[1],x=Object(r.useState)(Ee(l)),H=Object(f.a)(x,2),N=H[0],L=H[1],q=Object(r.useState)(l.getFullYear()),B=Object(f.a)(q,2),Y=B[0],K=B[1],V=Object(s.h)().pathname.split("/")[2],U=Object(r.useState)(""),J=Object(f.a)(U,2),W=J[0],_=J[1],G=Object(r.useState)([]),Q=Object(f.a)(G,2),Z=Q[0],X=Q[1],ee=Object(g.useLazyQuery)(Wt),te=Object(f.a)(ee,2),ae=te[0],ne=te[1],re=ne.loading,le=ne.data;Object(r.useEffect)((function(){if(le){var e=le.allStaff.map((function(e,t){return{key:t,value:e.id,text:e.name}}));X(e)}}),[le]),Object(r.useEffect)((function(){t({staff:m,period:b,stations:y,groupBy:k,from:A,to:P,number:N,year:Y,filterStatus:W})}),[m,b,y,k,A,P,N,Y,W,t]),Object(r.useEffect)((function(){n.staffId?u([n.staffId]):u([]),"mypage"===V.toLowerCase()&&u([a.id])}),[V,a.id,n]);var ce=a.permission&&a.permission.timesheet.view.map((function(e,t){return{key:t,value:e._id,text:e.location}}));return i.a.createElement(i.a.Fragment,null,i.a.createElement(O.a,{size:"tiny",clearing:!0},i.a.createElement(z.a,{size:"mini",attached:"top left"},"Filters"),i.a.createElement(E.a,{size:"mini"},i.a.createElement(Ue.a,{widths:"equal"},!n.staffId&&"mypage"!==V.toLowerCase()&&i.a.createElement(E.a.Dropdown,{label:"Staff",value:m,loading:re,options:Z,selection:!0,multiple:!0,clearable:!0,placeholder:"All",onFocus:function(){return ae()},onChange:function(e,t){var a=t.value;return u(a)}}),i.a.createElement(E.a.Dropdown,{label:"Period",value:b,options:[{key:1,value:"date",text:"Date"},{key:2,value:"week",text:"Week"},{key:3,value:"month",text:"Month"}],placeholder:"All",selection:!0,clearable:!0,compact:!0,onChange:function(e,t){var a=t.value;"week"===a&&L(Ee(l)),"month"===a&&L(l.getMonth()),h(a)}}),"date"===b&&i.a.createElement(i.a.Fragment,null,i.a.createElement(ie.DateInput,{value:A,label:"From",dateFormat:"DD-MM-YYYY",onChange:function(e,t){var a=t.value;I(a)}}),i.a.createElement(ie.DateInput,{value:P,label:"To",dateFormat:"DD-MM-YYYY",onChange:function(e,t){var a=t.value;M(a)}})),("week"===b||"month"===b)&&i.a.createElement(i.a.Fragment,null,i.a.createElement(E.a.Dropdown,{value:N,label:"Select ".concat(b),options:"week"===b?he():be(),selection:!0,compact:!0,onChange:function(e,t){var a=t.value;L(a),"week"===b&&a>Ee(l)&&K(l.getFullYear-1),"month"===b&&a>l.getMonth()&&K(l.getFullYear-1)}})),i.a.createElement(E.a.Dropdown,{label:"Group By",value:k,options:[{key:1,value:"week",text:"Week"},{key:2,value:"month",text:"Month"}],onChange:function(e,t){var a=t.value;return T(a)},selection:!0,compact:!0}),i.a.createElement(E.a.Dropdown,{label:"Station",options:ce,value:y,selection:!0,multiple:!0,clearable:!0,placeholder:"All",onChange:function(e,t){var a=t.value;return j(a)}}),i.a.createElement(E.a.Dropdown,{label:"Status",value:W,options:[{key:1,value:"approved",text:"Approved"},{key:2,value:"pending",text:"Pending"}],onChange:function(e,t){var a=t.value;return _(a)},placeholder:"All",clearable:!0,selection:!0,compact:!0})))))},Zt=function(e){var t=e.setStaffName,a=new Date,l=Object(s.i)(),c=Object(s.h)(),m=c.pathname.split("/")[2],u=Object(r.useState)({staff:[],period:"date",from:de(new Date(a.getFullYear(),a.getMonth()-3,1)).split(" ")[0],to:de(a).split(" ")[0],number:Ee(a),groupBy:"week",year:a.getFullYear(),stations:[],filterStatus:""}),d=Object(f.a)(u,2),E=d[0],p=d[1],b=Object(n.a)({},E);1===E.staff.length&&(b.staffId=E.staff[0]);var h,v=Object(g.useQuery)(It,{variables:b,skip:l.period}),O=v.loading,S=v.data;if(Object(r.useEffect)((function(){S&&S.getStaff&&t(S.getStaff.name)}),[S,t]),l.period){var y,j,w,C=l.period.split(" ");return"Week"===C[0]?(y="week",j=C[1],w=C[2]):(y="month",h=C[0],j=["january","february","march","april","may","june","july","august","september","october","november","december"].findIndex((function(e){return e===h.toLowerCase()})),w=C[1]),i.a.createElement(qt,{period:y,selected:parseInt(j),selectedYear:parseInt(w),staffId:l.staffId,setStaffName:t,timesheetOnly:!0})}return i.a.createElement(i.a.Fragment,null,i.a.createElement(Qt,{setFilter:p}),i.a.createElement(L.a,{active:O}," Loading TimeSheet Overview"),i.a.createElement(G.a,null,i.a.createElement(St.a,null,i.a.createElement(yt.a,null,!l.staffId&&"mypage"!==m.toLowerCase()&&i.a.createElement(jt.a,null,"Staff Name"),i.a.createElement(jt.a,null,"Period"),i.a.createElement(jt.a,null," Stations"),i.a.createElement(jt.a,null," Total Hours"),i.a.createElement(jt.a,null," Status"))),i.a.createElement(wt.a,null,S&&S.getAllTimeSheets&&U.a.map(S.getAllTimeSheets,(function(e,t){return U.a.map(e,(function(e,a){return i.a.createElement(yt.a,{key:a,positive:!e.itemsPending,negative:!!e.itemsPending},!l.staffId&&"mypage"!==m.toLowerCase()&&i.a.createElement(Ct.a,null,i.a.createElement(o.b,{to:"/Manage/ManageTimesheets/".concat(e.id),onClick:function(){}}," ",a)),i.a.createElement(Ct.a,null,t),i.a.createElement(Ct.a,null,U.a.reduce(e.station,(function(e,t,a){return 0!==t?(e?e+"/":"")+a:e}),"")),i.a.createElement(Ct.a,null,e.totHours),i.a.createElement(Ct.a,null,i.a.createElement(o.b,{to:"".concat(c.pathname,"/").concat(l.staffId?"":"".concat(e.id,"/")).concat(t),onClick:function(){}},e.itemsPending?"".concat(e.itemsPending,"  Items Pending"):"All Approved"," ")))}))})))))},Xt=function(e){var t=e.setName,a=Object(s.i)(),n=Object(r.useState)(""),l=Object(f.a)(n,2),c=l[0],m=l[1];return i.a.createElement(i.a.Fragment,null,!(a.page&&"timesheetsoverview"===a.page.toLowerCase())&&i.a.createElement(i.a.Fragment,null,i.a.createElement(ht.a,null,a.staffId&&i.a.createElement(i.a.Fragment,null,i.a.createElement(ht.a.Section,{link:!0,as:o.b,to:"/Manage/ManageTimesheets"}," Manage Timesheets "),i.a.createElement(ht.a.Divider,null),i.a.createElement(ht.a.Section,{active:!a.period,as:a.period?o.b:"",to:"/Manage/ManageTimesheets/".concat(a.staffId)}," ",c," ")),a.period&&i.a.createElement(i.a.Fragment,null,i.a.createElement(ht.a.Divider,{icon:"right chevron"}),i.a.createElement(ht.a.Section,{active:!0},a.period.replace("_"," "))))),i.a.createElement(Zt,{setStaffName:t||m}))};function ea(){var e=Object(j.a)(["\nmutation changePermission( $id: String! $staff: JsonObject, $station: JsonObject, $timesheet: JsonObject ,$admin: Boolean){\n  changePermission(\n    id: $id\n    staff: $staff\n    station: $station\n    timesheet: $timesheet\n    admin: $admin\n    ){\n      id\n      staff\n      station\n      timesheet\n      admin\n    }\n}"]);return ea=function(){return e},e}var ta=Object(g.gql)(ea()),aa=function(e){var t=e.permissions,a=JSON.parse(sessionStorage.getItem("staffKey")),l=Object(r.useState)(t&&t.admin||!1),c=Object(f.a)(l,2),o=c[0],s=c[1],m=a.permission.admin,u=Object(g.useMutation)(ta),d=Object(f.a)(u,2),b=d[0],v=d[1],O=v.loading,S=(v.error,v.data,function(e,t){return e&&e.map((function(e){return e?e._id:null}))}),y=function(e){if(m)return!0;if("object"===typeof e){if(!U.a.isEmpty(e))return!0}else if(e)return!0;return!1},j=U.a.mapValues(t,(function(e,t){if("object"===typeof e){var a=Object(n.a)({},e);return"station"===t&&(a.edit=S(a.edit)),"timesheet"===t&&(a.edit=S(a.edit),a.view=S(a.view),a.sign=S(a.sign)),a}return e})),w=Object(g.useQuery)(k,{skip:!m}),C=w.loading,T=w.data,R=Object(r.useState)([]),D=Object(f.a)(R,2),A=D[0],I=D[1],$=function(e){if(m)return A;var t=[];switch(e){case"station.edit":return a.permission.station.edit.length&&(t=a.permission.station.edit.map((function(e,t){return{key:t,value:e._id,text:e.location}}))),t;case"timesheet.edit":return a.permission.timesheet.edit.length&&(t=a.permission.timesheet.edit.map((function(e,t){return{key:t,value:e._id,text:e.location}}))),t;case"timesheet.view":return a.permission.timesheet.view.length&&(t=a.permission.timesheet.view.map((function(e,t){return{key:t,value:e._id,text:e.location}}))),t;case"timesheet.sign":return a.permission.timesheet.sign.length&&(t=a.permission.timesheet.sign.map((function(e,t){return{key:t,value:e._id,text:e.location}}))),t;default:return t}};Object(r.useEffect)((function(){if(T){var e=T.allStations.map((function(e,t){return{key:t,value:e.id,text:e.location}}));I(e)}}),[T]);var F=A.map((function(e){return e.value}));return i.a.createElement(ne.c,{initialValues:Object(n.a)({},j),onSubmit:function(e){var a=Object(n.a)({},e);U.a.reduce(e,(function(e,n,r){j[r]&&U.a.isEqual(j[r],a[r])&&delete a[r],j[r]&&!U.a.isEqual(j[r],a[r])&&U.a.reduce(a[r],(function(e,n,i){console.log(r,i,a[r][i],t[r][i],U.a.isEqual(t[r][i],a[r][i])),U.a.isEqual(t[r][i],a[r][i])&&delete a[r][i]}),{})}),{}),b({variables:Object(n.a)(Object(n.a)({},a),{},{id:t.id})})}},(function(e){var n=e.setFieldValue,l=e.values,c=e.handleSubmit,u=e.dirty,d=e.resetForm;return i.a.createElement(i.a.Fragment,null,i.a.createElement(h.a,{as:"h3"},"Permission"),i.a.createElement(ce.a,{label:"Administrator (All Permissions for all stations)",disabled:!m,toggle:!0,name:"admin",checked:l.admin,onChange:function(e,t){var a=t.checked;n("admin",a),s(a),a&&(n("station.edit",F),n("station.add",!0),n("timesheet.edit",F),n("timesheet.view",F),n("timesheet.sign",F),n("staff.edit",!0),n("staff.add",!0),n("staff.view",!0))}}),i.a.createElement(E.a,{as:"table",loading:C||O,className:"ui celled padded table",onSubmit:c},i.a.createElement(G.a.Header,null,i.a.createElement(G.a.Row,null,i.a.createElement(G.a.HeaderCell,null,"Scope"),i.a.createElement(G.a.HeaderCell,null,"Edit"),i.a.createElement(G.a.HeaderCell,null,"Add"),i.a.createElement(G.a.HeaderCell,null,"View"),i.a.createElement(G.a.HeaderCell,null,"Sign"))),i.a.createElement(wt.a,null,U.a.map(t,(function(e,t){return i.a.createElement(r.Fragment,{key:t},"__typename"!==t&&"id"!==t&&"admin"!==t&&i.a.createElement(ne.b,null,(function(){return i.a.createElement(G.a.Row,{key:t},i.a.createElement(G.a.Cell,null,t.toUpperCase()),i.a.createElement(G.a.Cell,null,("station"===t||"timesheet"===t)&&i.a.createElement(Pt,{multiple:!0,selection:!0,options:$("".concat(t,".edit")),placeholder:"Add Stations",disabled:C||!y(a.permission[t].edit)||o,loading:C,name:"".concat(t,".edit")}),"staff"===t?i.a.createElement(ce.a,{disabled:!y(a.permission[t].edit)||o,toggle:!0,name:"".concat(t,".edit"),checked:l["".concat(t)].edit,onChange:function(e,a){var r=a.checked;n("".concat(t,".edit"),r),r&&n("".concat(t,".view"),r)}}):""),i.a.createElement(G.a.Cell,null,"timesheet"!==t?i.a.createElement(ce.a,{toggle:!0,disabled:!y(a.permission[t].add)||o,name:"".concat(t,".add"),checked:l["".concat(t)].add,onChange:function(e,a){var r=a.checked;n("".concat(t,".add"),r)}}):""),i.a.createElement(G.a.Cell,null,"staff"===t&&i.a.createElement(ce.a,{disabled:!y(a.permission[t].view)||o,toggle:!0,name:"".concat(t,".view"),checked:l["".concat(t)].view,onChange:function(e,a){var r=a.checked;l.staff.edit?n("".concat(t,".view"),!0):n("".concat(t,".view"),r)}}),"timesheet"===t&&i.a.createElement(Pt,{multiple:!0,selection:!0,options:o?A:$("".concat(t,".view")),placeholder:"Add Stations",disabled:C||!y(a.permission[t].view)||o,loading:C,name:"".concat(t,".view")})),i.a.createElement(G.a.Cell,{disabled:"timesheet"!==t},"timesheet"===t&&i.a.createElement(Pt,{multiple:!0,selection:!0,options:o?A:$("".concat(t,".sign")),placeholder:"Add Stations",disabled:C||!y(a.permission[t].sign)||o,loading:C,name:"".concat(t,".sign")})))})))})))),u&&i.a.createElement(i.a.Fragment,null,i.a.createElement(p.a,{onClick:function(){return c()}}," Save Changes"),i.a.createElement(p.a,{onClick:function(){return d()}}," Discard Changes")))}))},na=a(167),ra=a(168),ia=function(e){var t=Object(g.useMutation)(gt),a=Object(f.a)(t,2),r=a[0],l=a[1].loading,c={email:e.email,phone:e.phone||"",contractType:e.contractType,contractHours:e.reqHours,position:e.position||""};return i.a.createElement(Te.a,{closeIcon:!0,closeOnEscape:!1,closeOnDimmerClick:!1,open:e.open,onClose:function(){return e.setOpen(!1)},onOpen:function(){return e.setOpen(!0)}},i.a.createElement(na.a,null,"Editing Staff ",e.name," "),i.a.createElement(ra.a,null,l&&i.a.createElement(ke.a,{active:!0},i.a.createElement(L.a,null)),i.a.createElement(ne.c,{initialValues:c,onSubmit:function(t){var a=U.a.omitBy(t,(function(e,t){return c[t]===e}));r({variables:Object(n.a)(Object(n.a)({},a),{},{id:e.id})})}},(function(e){e.values;var t=e.handleSubmit,a=(e.setFieldValue,e.dirty);return i.a.createElement(E.a,{style:{marginBottom:"5rem"},onSubmit:t},i.a.createElement(b.a,null,i.a.createElement(b.a.Row,null,i.a.createElement(se,{name:"email",label:"Email",type:"email"})),i.a.createElement(b.a.Row,null,i.a.createElement(se,{name:"phone",label:"Phone",type:"tel"})),i.a.createElement(b.a.Row,null,i.a.createElement(Pt,{name:"contractType",labeled:!0,label:"Contract",selection:!0,options:[{key:1,value:"Contractor",text:"Contractor"},{key:2,value:"Employee",text:"Employee"}]})),i.a.createElement(b.a.Row,null,i.a.createElement(se,{name:"contractHours",label:"Required Hours per day"})),i.a.createElement(b.a.Row,null,i.a.createElement(se,{name:"position",label:"Position"}))),a&&i.a.createElement(p.a,{type:"submit",floated:"right",positive:!0},"Save"))}))))},la=function(e){var t=Object(g.useMutation)(ft),a=Object(f.a)(t,2),n=a[0],r=a[1],l=r.loading,c=r.error;r.data;return c&&console.log(c),i.a.createElement(Te.a,{closeIcon:!0,closeOnEscape:!1,closeOnDimmerClick:!1,open:e.open,onClose:function(){return e.setOpen(!1)},onOpen:function(){return e.setOpen(!0)}},i.a.createElement(na.a,null,"Password Change"),i.a.createElement(ra.a,null,l&&i.a.createElement(ke.a,{active:!0},"Updating Password",i.a.createElement(L.a,null)),i.a.createElement(ne.c,{initialValues:{password:"",newPassword:"",confirmPassword:""},validate:function(e){var t={};return e.password||(t.password="Old Password is required"),e.newPassword===e.password&&(t.newPassword="New password cannot be same as old password"),e.newPassword||(t.newPassword="New password cannot be empty"),e.newPassword!==e.confirmPassword&&(t.confirmPassword="New password and confirm password must match"),console.log(t),t},onSubmit:function(t){n({variables:{id:e.id,password:t.password,newPassword:t.newPassword}})}},(function(e){e.values;var t=e.handleSubmit,a=(e.setFieldValue,e.dirty),n=e.errors;return i.a.createElement(E.a,{style:{marginBottom:"5rem"},onSubmit:t},i.a.createElement(b.a,null,i.a.createElement(b.a.Row,null,i.a.createElement(se,{name:"password",label:"Old Password",type:"password"})),i.a.createElement(b.a.Row,null,i.a.createElement(se,{name:"newPassword",label:"New Password",type:"password"})),i.a.createElement(b.a.Row,null,i.a.createElement(se,{name:"confirmPassword",label:"Confirm Password",type:"password"}))),a&&U.a.isEmpty(n)&&i.a.createElement(p.a,{type:"submit",style:{marginTop:"1rem"},positive:!0},"Change Password"))}))))},ca=function(e){var t=Object(s.i)(),a=Object(r.useState)({open:!1,handleCancel:function(){},handleConfirm:function(){}}),n=Object(f.a)(a,2),l=n[0],c=n[1],o=Object(r.useState)(!1),m=Object(f.a)(o,2),u=m[0],d=m[1],E=JSON.parse(sessionStorage.getItem("staffKey")),v=E.id;v=e.id?e.id:t.staffId?t.staffId:E.id;var O=Object(g.useQuery)(Ut,{variables:{id:v,withPermission:e.staffCanEdit||!1}}),S=O.loading,y=O.error,j=O.data,w=Object(g.useMutation)(dt),C=Object(f.a)(w,2),k=C[0],T=C[1],R=T.loading,D=T.error,A=Object(g.useMutation)(ut),I=Object(f.a)(A,2),$=I[0],F=I[1],P=F.loading,M=F.error,x=function(){c({open:!1,handleCancel:function(){},handleConfirm:function(){}})};if(Object(r.useEffect)((function(){j&&e.setStaffName&&e.setStaffName(j.getStaff.name)}),[j,e]),(D||M)&&console.log(D,M),S)return i.a.createElement(L.a,{active:!0},"Fetching User Profile");if(y)return console.log(y),i.a.createElement(h.a,{as:"h5"},"Something Went Wrong, Please try again");var H=!j||!j.getStaff.registerCode;return i.a.createElement(i.a.Fragment,null,i.a.createElement(b.a,{columns:"3",style:{marginTop:"1rem"}},i.a.createElement(b.a.Row,{centered:!0,textAlign:"center"},i.a.createElement(b.a.Column,null,i.a.createElement(h.a,{as:"h4"},"Basic Info"),i.a.createElement(G.a,{compact:!0},i.a.createElement(wt.a,null,i.a.createElement(G.a.Row,null,i.a.createElement(G.a.Cell,{width:"8"}," ",i.a.createElement("strong",null," Id Card Saved ")," "),i.a.createElement(G.a.Cell,{width:"7"},j.getStaff.idCardCode?i.a.createElement(K.a,{name:"checkmark",color:"green"}):i.a.createElement(K.a,{name:"cancel",color:"red"}))),i.a.createElement(G.a.Row,null,i.a.createElement(G.a.Cell,{width:"8"}," ",i.a.createElement("strong",null," Registration Complete")," "),i.a.createElement(G.a.Cell,{width:"7"},H?i.a.createElement(K.a,{name:"checkmark",color:"green"}):i.a.createElement(K.a,{name:"cancel",color:"red"}))),i.a.createElement(G.a.Row,null,i.a.createElement(G.a.Cell,null," ",i.a.createElement("strong",null," Email ")," "),i.a.createElement(G.a.Cell,null," ",j.getStaff.email)),i.a.createElement(G.a.Row,null,i.a.createElement(G.a.Cell,null," ",i.a.createElement("strong",null," Phone ")," "),i.a.createElement(G.a.Cell,null," ",j.getStaff.phone)),H&&i.a.createElement(G.a.Row,null,i.a.createElement(G.a.Cell,null," ",i.a.createElement("strong",null," Username ")," "),i.a.createElement(G.a.Cell,null," ",j.getStaff.username))),i.a.createElement(G.a.Footer,null,(e.staffCanEdit||E.id===j.getStaff.id)&&i.a.createElement(G.a.Row,null,i.a.createElement(G.a.HeaderCell,null,i.a.createElement(p.a,{primary:!0,size:"small"},"Scan Id Card")),i.a.createElement(G.a.HeaderCell,null,i.a.createElement(p.a,{loading:R||P,disabled:R||P,primary:!0,size:"small",onClick:function(e,t){switch(t.children){case"Change Password":d(!0);break;case"Reset Password":c({open:!0,handleConfirm:function(){k({variables:{id:j.getStaff.id}}),x()},handleCancel:function(){x()},content:"Confirm Reset Password",header:"Confirm"});break;case"Resend Register Link":c({open:!0,handleConfirm:function(){$({variables:{id:j.getStaff.id}}),x()},handleCancel:function(){x()},content:"Confirm Reset Registration Link",header:"Confirm"})}}},H?E.id===j.getStaff.id?"Change Password":e.staffCanEdit?"Reset Password":"":"Resend Register Link")))))),i.a.createElement(b.a.Column,null,i.a.createElement(h.a,{as:"h4"},"Contract"),i.a.createElement(G.a,{compact:!0},i.a.createElement(wt.a,null,i.a.createElement(G.a.Row,null,i.a.createElement(G.a.Cell,null," ",i.a.createElement("strong",null," Type ")," "),i.a.createElement(G.a.Cell,null,j&&j.getStaff.contractType)),i.a.createElement(G.a.Row,null,i.a.createElement(G.a.Cell,null," ",i.a.createElement("strong",null," Required Hrs/Day ")," "),i.a.createElement(G.a.Cell,null," ",j&&j.getStaff.reqHours)),i.a.createElement(G.a.Row,null,i.a.createElement(G.a.Cell,null," ",i.a.createElement("strong",null," Position ")," "),i.a.createElement(G.a.Cell,null," ",j&&j.getStaff.position))))),i.a.createElement(b.a.Column,null,i.a.createElement(h.a,{as:"h4"},"Last Active"),i.a.createElement(G.a,{compact:!0},i.a.createElement(wt.a,null,i.a.createElement(G.a.Row,null,i.a.createElement(G.a.Cell,null," ",i.a.createElement("strong",null," Station ")," "),i.a.createElement(G.a.Cell,null,j&&j.getStaff.lastActive&&j.getStaff.lastActive.station&&j.getStaff.lastActive.station.location)),i.a.createElement(G.a.Row,null,i.a.createElement(G.a.Cell,null," ",i.a.createElement("strong",null," Active at ")," "),i.a.createElement(G.a.Cell,null," ",j&&j.getStaff.lastActive&&de(j.getStaff.lastActive.activeAt))))))),e.staffCanEdit&&i.a.createElement(b.a.Row,null," ",i.a.createElement(b.a.Column,null,i.a.createElement(aa,{permissions:j.getStaff.permission})," "),"  "),i.a.createElement(ia,{open:e.editModelOpen,setOpen:e.setEditModelOpen,email:j.getStaff.email,phone:j.getStaff.phone,contractType:j.getStaff.contractType,reqHours:j.getStaff.reqHours,position:j.getStaff.position,id:j.getStaff.id}),i.a.createElement(la,{open:u,setOpen:d,id:j.getStaff.id}),i.a.createElement(Be.a,{open:l.open,content:l.content,header:l.header,onCancel:l.handleCancel,onConfirm:l.handleConfirm})))},oa=function(e){var t=e.setName,a=Object(s.i)(),n=Object(s.g)(),l=Object(g.useQuery)(Jt,{variables:{registerCode:a.registerCode},skip:!a.registerCode}),c=l.loading,o=l.error,m=l.data,u=Object(g.useMutation)(pt),d=Object(f.a)(u,2),b=d[0],v=d[1],S=v.loading,y=v.error,j=v.data,w=Object(g.useLazyQuery)(Gt),C=Object(f.a)(w,2),k=C[0],T=C[1],R=T.loading,D=T.data,A=Object(r.useState)({verified:!1}),I=Object(f.a)(A,2),$=I[0],F=I[1];if(Object(r.useEffect)((function(){D&&F({verified:!0,status:D.verifyUsername.status})}),[D]),!a.registerCode)return i.a.createElement(h.a,null,"Registration code mising or invalid");if((o||y)&&console.log(o),j&&"SUCCESS"===j.registerStaff.status)return n.push("/staff"),null;m&&m.getStaff&&(console.log(m),t(m.getStaff.name));return i.a.createElement(O.a,{basic:!0,loading:c||S},i.a.createElement(Ce.a,{success:m&&m.getStaff,error:!!o},i.a.createElement(Ce.a.Header,null,m&&m.getStaff&&"Please complete registration by setting  your username and password",o&&o.message,m&&!m.getStaff&&"Registration code Invalid")),m&&m.getStaff&&i.a.createElement(ne.c,{initialValues:{password:"",username:"",confirmPassword:""},validate:function(e){var t={};return e.username&&""!==e.username.trim()||(t.username="Username is required"),e.username&&e.username.length<4&&(t.username="Username should be at least 4 character long"),e.password&&""!==e.password.trim()||(t.password="Password is required"),e.password!==e.confirmPassword&&(t.confirmPassword="New password and confirm password must match"),t},onSubmit:function(e){b({variables:{registerCode:a.registerCode,password:e.password,username:e.username}})}},(function(e){e.values;var t=e.handleChange,a=e.handleSubmit,n=e.dirty,r=e.errors,l=e.handleBlur,c=e.touched;return i.a.createElement(E.a,{style:{marginBottom:"5rem"},onSubmit:a},i.a.createElement(E.a.Field,{width:"8"},i.a.createElement(le.a,{loading:R,icon:i.a.createElement(K.a,{name:void 0===r.username&&$.verified?"SUCCESS"===$.status?"check circle":"cancel":"",color:$.verified&&"SUCCESS"===$.status?"green":"red"}),onBlur:l,name:"username",label:"Username",width:"8",onChange:function(e){t(e);var a=e.currentTarget.value;k({variables:{username:a}})}}),(r.username&&c.username||void 0===r.username&&$.verified&&"SUCCESS"!==$.status)&&i.a.createElement(z.a,{pointing:!0,prompt:!0},r.username||"Selected username already taken, please select new username")),i.a.createElement(se,{name:"password",label:"Password",type:"password",width:"8"}),i.a.createElement(se,{name:"confirmPassword",label:"Confirm Password",type:"password",width:"8"}),i.a.createElement(p.a,{disabled:!(n&&U.a.isEmpty(r)&&$.verified&&"SUCCESS"===$.status),type:"submit",style:{marginTop:"1rem"},positive:!0},"Register"))})))},sa=function(e){var t=e.staffName,a=e.activeItem,n=e.setActiveItem,r=JSON.parse(sessionStorage.getItem("staffKey")),l=Object(s.g)();if("register"===Object(s.h)().pathname.split("/")[1])return i.a.createElement(q.a,{inverted:!0,color:"blue",stackable:!0},i.a.createElement(q.a.Item,{position:"right"},"Welcome ",t));var c=function(e,t){var a=t.name;n(a),["Profile","Timesheets","TimesheetsOverview"].includes(a)?l.push("/staff/".concat(r.id,"/").concat(a)):l.push("/".concat(a))},o=[];0===o.length&&(o.push("Timesheets"),o.push("TimesheetsOverview"),o.push("Profile"));return i.a.createElement(q.a,{inverted:!0,color:"blue",stackable:!0},o.map((function(e){return i.a.createElement(q.a.Item,{key:e,name:e,active:a===e,onClick:c})})),i.a.createElement(q.a.Menu,{position:"right"},i.a.createElement(kt.a,{item:!0,text:"Welcome ".concat(r.name)},i.a.createElement(kt.a.Menu,null,i.a.createElement(kt.a.Item,{text:"Logout",onClick:function(){return sessionStorage.removeItem("staffKey"),void l.push("/staffLogin")}})))))},ma=function(e){var t=e.activeItem,a=e.setActiveItem,n=e.staffName,l=e.staffId,c=e.staffCanEdit,o=e.setEditModelOpen,m=Object(s.g)();return Object(r.useEffect)((function(){return a(""),function(){return a("")}}),[a]),i.a.createElement(q.a,{pointing:!0,secondary:!0},i.a.createElement(q.a.Item,{header:!0},n),i.a.createElement(q.a.Item,{position:"right",name:"Profile",active:"Profile"===t,onClick:function(){a("Profile"),m.push("/Manage/AllStaffs/".concat(l,"/Profile"))}}),i.a.createElement(q.a.Item,{name:"Timesheets",active:"Timesheets"===t,onClick:function(){a("Timesheets"),m.push("/Manage/AllStaffs/".concat(l,"/Timesheets"))}}),i.a.createElement(q.a.Item,{name:"TimesheetsOverview",active:"TimesheetsOverview"===t,onClick:function(){a("TimesheetsOverview"),m.push("/Manage/AllStaffs/".concat(l,"/TimesheetsOverview"))}}),c&&i.a.createElement(q.a.Item,{position:"right",name:"EditProfile",icon:"edit",onClick:function(e){e.preventDefault(),m.push("Profile"),a("Profile"),o(!0)}}))},ua=function(e){var t=e.name,a=e.id,n=Object(s.i)(),l=n&&n.staffId,c=n&&n.page,m=Object(s.h)(),u=Object(s.g)(),d=Object(r.useState)(t),g=Object(f.a)(d,2),E=g[0],p=g[1],b=Object(r.useState)(!1),h=Object(f.a)(b,2),v=h[0],O=h[1],S=Object(r.useState)(c),y=Object(f.a)(S,2),j=y[0],w=y[1],C=Object(r.useState)(c||"Profile"),k=Object(f.a)(C,2),T=k[0],R=k[1],D=JSON.parse(sessionStorage.getItem("staffKey")),A=Object(r.useState)(D&&D.name),I=Object(f.a)(A,2),$=I[0],F=I[1],P=m.pathname.split("/");if(Object(r.useEffect)((function(){w(c),R(c)}),[c]),"register"===P[1].toLowerCase())return c="register",i.a.createElement(i.a.Fragment,null,i.a.createElement(sa,{staffName:$,activeItem:j,setActiveItem:w}),i.a.createElement(oa,{setName:F}));if(!D&&"register"!==c)return u.push("/staffLogin"),null;var M=D.id!==l&&void 0!==l&&(D.permission&&D.permission.staff.edit||D.permission.admin||!1),x=D.permission&&(D.permission.station.edit.length>0||D.permission.station.add||D.permission.staff.view||D.permission.timesheet.view.length>0);l=a||(n.staffId?n.staffId:D.id);var H=P[1];D.id!==l&&"staff"===H.toLocaleLowerCase()&&u.push("/Manage/AllStaffs/".concat(l,"/").concat(j)),x&&"manage"!==H.toLowerCase()&&u.push("/Manage/MyPage/Profile");return i.a.createElement(i.a.Fragment,null,!x&&i.a.createElement(sa,{staffName:$,activeItem:j,setActiveItem:w}),i.a.createElement(i.a.Fragment,null,i.a.createElement(ht.a,null,D.id===l&&i.a.createElement(i.a.Fragment,null,i.a.createElement(vt.a,null," My Page "),i.a.createElement(Ot.a,null)),D.id!==l&&i.a.createElement(i.a.Fragment,null,i.a.createElement(vt.a,{link:!0,as:o.b,to:"/".concat(H,"/").concat(P[2])}," ",P[2]," "),i.a.createElement(Ot.a,null),i.a.createElement(vt.a,{link:!0,as:o.b,to:"/".concat(H,"/").concat(P[2],"/").concat(P[3],"/Profile")}," ",E||l," "),i.a.createElement(Ot.a,null)),c&&"timesheetsoverview"===c.toLowerCase()&&n.period?i.a.createElement(i.a.Fragment,null,i.a.createElement(vt.a,{link:!0,as:o.b,to:P.reduce((function(e,t,a){return a===P.length-1||""===t?e:e+"/"+t})),active:!0}," ",T," "),i.a.createElement(Ot.a,{icon:"right chevron"}),i.a.createElement(vt.a,{active:!0},n.period.replace("_"," "))):i.a.createElement(vt.a,{active:!0}," ",T," "))),l!==D.id&&i.a.createElement(ma,{activeItem:T,setActiveItem:R,staffName:E,staffId:l,staffCanEdit:M,setEditModelOpen:O}),(T&&"timesheets"===T.toLocaleLowerCase()||j&&"timesheets"===j.toLowerCase())&&i.a.createElement(i.a.Fragment,null,i.a.createElement(qt,{staffId:l,setStaffName:p})),(T&&"profile"===T.toLocaleLowerCase()||j&&"profile"===j.toLowerCase())&&i.a.createElement(i.a.Fragment,null,i.a.createElement(ca,{id:l,staffCanEdit:M,setEditModelOpen:O,editModelOpen:v,setStaffName:p})),(T&&"timesheetsoverview"===T.toLocaleLowerCase()||j&&"timesheetsoverview"===j.toLowerCase())&&i.a.createElement(i.a.Fragment,null,i.a.createElement(Xt,{setName:p})))},da=function(e){var t=Object(g.useMutation)(Et),a=Object(f.a)(t,2),n=a[0],r=a[1],l=r.loading;r.error;return i.a.createElement(ne.c,{initialValues:{name:"",email:"",phone:"",contractType:"",contractHours:"",position:""},onSubmit:function(e){!function(e){n({variables:e,update:function(e,t){e.modify({fields:{allStaff:function(e,a){var n=a.readField,r=t.data.addStaff;return e.some((function(e){return n("id",e)===r.id}))?e:[].concat(Object(ae.a)(e),[r])}}})}})}(e)},validate:function(e){var t={};return t.name=je(e.name),t.email=ye(e.email),U.a.isEmpty(t.name)&&delete t.name,U.a.isEmpty(t.email)&&delete t.email,e.contractType||(t.contractType="Please select contract type"),e.contractHours&&parseFloat(e.contractHours)||(t.contractHours="Invalid contract hours"),t}},(function(t){t.values;var a=t.handleSubmit,n=t.setFieldValue,r=t.dirty;return i.a.createElement(Te.a,{closeIcon:!0,closeOnEscape:!1,closeOnDimmerClick:!1,open:e.open,onClose:function(){return e.setOpen(!1)},onOpen:function(){return e.setOpen(!0)}},i.a.createElement(na.a,null,"New Staff ",e.name," "),i.a.createElement(ra.a,null,l&&i.a.createElement(ke.a,{active:!0},i.a.createElement(L.a,null)),i.a.createElement(E.a,{style:{marginBottom:"5rem"}},i.a.createElement(b.a,null,i.a.createElement(b.a.Row,null,i.a.createElement(se,{name:"name",label:"Name",type:"text",width:"8"})),i.a.createElement(b.a.Row,null,i.a.createElement(se,{name:"email",label:"Email",type:"email",width:"8"})),i.a.createElement(b.a.Row,null,i.a.createElement(se,{name:"phone",label:"Phone",type:"tel",width:"8"})),i.a.createElement(b.a.Row,null,i.a.createElement(Pt,{name:"contractType",labeled:!0,label:"Contract",selection:!0,width:"8",options:[{key:1,value:"Contractor",text:"Contractor"},{key:2,value:"Employee",text:"Employee"}],onChange:function(e,t){var a=t.value;n("contractType",a)}})),i.a.createElement(b.a.Row,null,i.a.createElement(se,{name:"contractHours",label:"Required Hours per day",type:"number",width:"8"})),i.a.createElement(b.a.Row,null,i.a.createElement(se,{name:"position",label:"Position",width:"8"})),i.a.createElement(b.a.Row,null,i.a.createElement(E.a.Button,{icon:!0,type:"button",labelPosition:"right",primary:!0},i.a.createElement(K.a,{size:"big",name:"barcode"}),"Link Id card"))))),i.a.createElement(Te.a.Actions,null,i.a.createElement(p.a,{negative:!0,onClick:function(){return e.setOpen(!1)}},"Cancel"),r&&i.a.createElement(p.a,{positive:!0,onClick:function(){return a()}},"Save")))}))},fa=function(){var e=Object(g.useQuery)(_t),t=e.loading,a=e.error,n=e.data,l=Object(r.useState)([]),c=Object(f.a)(l,2),s=c[0],m=c[1],u=Object(r.useState)(!1),d=Object(f.a)(u,2),E=d[0],b=d[1];return Object(r.useEffect)((function(){n&&n.allStaff&&m(n.allStaff)}),[n]),t?i.a.createElement(L.a,{active:!0},"Fetching Staffs"):a?i.a.createElement(O.a,null,"Something Went Wrong "):i.a.createElement(i.a.Fragment,null,i.a.createElement(p.a,{primary:!0,icon:!0,onClick:function(){return b(!0)}},"Add New Staff ",i.a.createElement(K.a,{name:"add"}," ")),s&&i.a.createElement(le.a,{icon:"search",placeholder:"Search...",onChange:function(e,t){var a=t.value;if(a&&""!==a.trim()){var r=s.filter((function(e){return e.name.includes(a)}));m(r)}else m(n.allStaff)}}),i.a.createElement(G.a,null,i.a.createElement(G.a.Header,null,i.a.createElement(yt.a,null,i.a.createElement(jt.a,null," Name "),i.a.createElement(jt.a,null," Email "),i.a.createElement(jt.a,null," Phone "),i.a.createElement(jt.a,null," Last Active "),i.a.createElement(jt.a,null," Recent Station "))),i.a.createElement(G.a.Body,null,s&&s.map((function(e){return i.a.createElement(G.a.Row,{key:e.id},i.a.createElement(Ct.a,null,i.a.createElement(o.b,{to:"/Manage/AllStaffs/".concat(e.id,"/Profile")},e.name)),i.a.createElement(Ct.a,null,e.email),i.a.createElement(Ct.a,null,e.phone),i.a.createElement(Ct.a,null,e.lastActive&&de(e.lastActive.activeAt)),i.a.createElement(Ct.a,null,e.lastActive&&e.lastActive.station&&e.lastActive.station.location))})))),i.a.createElement(da,{open:E,setOpen:b}))},ga=a(618);function Ea(){var e=Object(j.a)(["\nquery fetchAllCostumers ($detailed: Boolean = false) {\n    allCostumers {\n      name\n      id\n      stations  @include(if: $detailed) {\n        id\n        location\n      }\n      \n      aircrafts @include(if: $detailed) {\n        id\n        registration\n      }\n    }\n  }\n"]);return Ea=function(){return e},e}var pa=Object(g.gql)(Ea()),ba=function(e){var t=Object(g.useMutation)(I),a=Object(f.a)(t,2),l=a[0],c=a[1],o=c.loading,s=(c.error,Object(r.useState)([])),m=Object(f.a)(s,2),v=m[0],O=m[1],S=Object(r.useState)([]),y=Object(f.a)(S,2),j=y[0],w=y[1],C=Object(g.useQuery)(pa,{onCompleted:function(e){if(e.allCostumers){var t=e.allCostumers.map((function(e,t){return{key:t,value:e.id,text:e.name}}));w(t)}}}).loading;Object(r.useEffect)((function(){(function(){var e=Object(d.a)(u.a.mark((function e(){var t,a,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://restcountries.eu/rest/v2/?fields=name;alpha2Code;");case 2:return t=e.sent,e.next=5,t.json();case 5:a=e.sent,n=a.map((function(e,t){return["aq","bq","cw","gg","im","je","xk","bl","mf","sx","ss"].includes(e.alpha2Code.toLowerCase())?{key:t,value:e.name,text:e.name}:{key:t,value:e.name,text:e.name,flag:e.alpha2Code.toLowerCase()}})),O(n);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]);return i.a.createElement(ne.c,{initialValues:{location:"",address:{street:"",postcode:"",city:"",country:""},email:"",phone:"",costumers:[],shifts:[],stationKey:"",stationKeyConfirm:""},onSubmit:function(e){console.log(e),function(e){delete e.stationKeyConfirm,l({variables:e,update:function(t,a){t.modify({fields:{allStation:function(t,r){var i=r.readField,l=a.data.addStaff;if(t.some((function(e){return i("id",e)===l.id})))return t;var c=Object(n.a)(Object(n.a)({},e),{},{id:l.id});return[].concat(Object(ae.a)(t),[c])}}})}})}(e)},validate:function(e){var t={};return(!e.location||e.location&&e.location.length<3)&&(t.location="Location is required and must be at least 3 charcter long"),(!e.address.street||e.address.street&&e.address.street.length<3)&&(t.address=Object(n.a)(Object(n.a)({},t.address),{},{street:"Street is required and must be at least 3 charcter long"})),e.address.city||(t.address=Object(n.a)(Object(n.a)({},t.address),{},{city:"City is required and must be at least 3 charcter long"})),e.address.country||(t.address=Object(n.a)(Object(n.a)({},t.address),{},{country:"Country is required"})),e.email&&!ye(e.email)||(t.email="Email is required and must be valid"),e.phone||(t.phone="Phone is required"),(!e.stationKey||e.stationKey&&e.stationKey.length<8)&&(t.stationKey="Station key is required and should be at least 8 charter long"),e.stationKeyConfirm!==e.stationKey&&(t.stationKeyConfirm="Station key confirm mismatch"),t}},(function(t){var a=t.values,n=t.handleSubmit,r=t.setFieldValue,l=t.dirty;return i.a.createElement(Te.a,{closeIcon:!0,closeOnEscape:!1,closeOnDimmerClick:!1,open:e.open,onClose:function(){return e.setOpen(!1)},onOpen:function(){return e.setOpen(!0)}},i.a.createElement(na.a,null,"New Station ",e.name," "),i.a.createElement(ra.a,null,o&&i.a.createElement(ke.a,{active:!0},i.a.createElement(L.a,null)),i.a.createElement(E.a,{style:{marginBottom:"5rem"},autoComplete:"off"},i.a.createElement(b.a,{padded:!0},i.a.createElement(b.a.Row,{style:{padding:0}},i.a.createElement(se,{name:"location",label:"Location",type:"text",width:"8",placeholder:"Location identifier ex: Airport code"})),i.a.createElement(b.a.Row,{style:{paddingTop:3}},i.a.createElement(Pt,{name:"address.country",labeled:!0,label:"Country",placeholder:"Select Country",search:!0,selection:!0,width:"8",options:v,onChange:function(e,t){var a=t.value;r("address.country",a)}})),i.a.createElement(b.a.Row,null,i.a.createElement(h.a,{as:"h3"},"Address")),i.a.createElement(b.a.Row,{style:{padding:0}},i.a.createElement(se,{name:"address.street",label:"Street",type:"text",width:"8"})),i.a.createElement(b.a.Row,{style:{padding:0}},i.a.createElement(se,{name:"address.postcode",label:"postcode",type:"text",width:"8"})),i.a.createElement(b.a.Row,{style:{paddingTop:0}},i.a.createElement(se,{name:"address.city",label:"city",type:"text",width:"8"})),i.a.createElement(b.a.Row,null,i.a.createElement(h.a,{as:"h3"},"Contact Information")),i.a.createElement(b.a.Row,{style:{padding:0}},i.a.createElement(se,{name:"email",label:"Email",type:"email",width:"8"})),i.a.createElement(b.a.Row,{style:{paddingTop:0}},i.a.createElement(se,{name:"phone",label:"Phone",type:"tel",width:"8"})),i.a.createElement(b.a.Row,null,i.a.createElement(h.a,{as:"h3"},"Working Shift")),i.a.createElement(ne.b,{name:"shifts"},(function(e){var t=e.push,n=e.remove;return i.a.createElement(i.a.Fragment,null,a.shifts.length>0&&a.shifts.map((function(e,t){return i.a.createElement(b.a.Row,{key:t,style:{padding:0}},i.a.createElement(E.a.Group,{widths:"13"},i.a.createElement(se,{name:"shifts[".concat(t,"].name"),label:"Name"}),i.a.createElement(se,{name:"shifts[".concat(t,"].startTime"),label:"StartTime"}),i.a.createElement(p.a,{type:"button",icon:!0,size:"mini",primary:!0,onClick:function(e){return n(t)}},i.a.createElement(K.a,{name:"plus circle"})," Add")," "))})),i.a.createElement(p.a,{type:"button",icon:!0,size:"mini",primary:!0,onClick:function(e){return t({name:"",startTime:""})}},i.a.createElement(K.a,{name:"plus circle"})," Add"))})),i.a.createElement(b.a.Row,null,i.a.createElement(h.a,{as:"h3"},"Costumers")),i.a.createElement(Pt,{name:"costumers",placeholder:"Select Costumers",multiple:!0,search:!0,selection:!0,width:"8",loading:C,options:j,onChange:function(e,t){var a=t.value;r("costumers",a)}}),i.a.createElement(b.a.Row,null,i.a.createElement(h.a,{as:"h3"},"Station Key")),i.a.createElement(b.a.Row,{style:{padding:0}}," ",i.a.createElement(se,{name:"stationKey",type:"password",width:"8",placeholder:"stationKey"})," "),i.a.createElement(b.a.Row,{style:{padding:0}}," ",i.a.createElement(se,{name:"stationKeyConfirm",type:"password",width:"8",placeholder:"Confirm stationKey"})," ")))),i.a.createElement(Te.a.Actions,null,i.a.createElement(p.a,{negative:!0,onClick:function(){return e.setOpen(!1)}},"Cancel"),l&&i.a.createElement(p.a,{positive:!0,onClick:function(){return n()}},"Save")))}))},ha=function(){var e=Object(g.useQuery)(k,{variables:{detailed:!0}}),t=e.loading,a=e.error,n=e.data,l=Object(r.useState)([]),c=Object(f.a)(l,2),s=c[0],m=c[1],u=Object(r.useState)(!1),d=Object(f.a)(u,2),E=d[0],b=d[1];return Object(r.useEffect)((function(){n&&n.allStations&&m(n.allStations)}),[n]),t?i.a.createElement(L.a,{active:!0},"Fetching Staffs"):a?(console.log(a),i.a.createElement(O.a,null,"Something Went Wrong ")):i.a.createElement(i.a.Fragment,null,i.a.createElement(p.a,{primary:!0,icon:!0,onClick:function(){return b(!0)}},"Add New Station ",i.a.createElement(K.a,{name:"add"}," ")),s&&i.a.createElement(le.a,{icon:"search",placeholder:"Country or location ...",onChange:function(e,t){var a=t.value;if(a&&""!==a.trim()){var r=s.filter((function(e){return e.location.toLowerCase().includes(a.toLowerCase())||e.address.country.toLowerCase().includes(a.toLowerCase())}));m(r)}else m(n.allStations)}}),i.a.createElement(G.a,{textAlign:"center"},i.a.createElement(G.a.Header,null,i.a.createElement(yt.a,null,i.a.createElement(jt.a,null," Location "),i.a.createElement(jt.a,null," Staff Count (Last 24 Hrs) "),i.a.createElement(jt.a,null," Address "),i.a.createElement(jt.a,null," Phone No. "),i.a.createElement(jt.a,null," Email "))),i.a.createElement(G.a.Body,null,s&&s.map((function(e){return i.a.createElement(G.a.Row,{key:e.id},i.a.createElement(Ct.a,null,i.a.createElement(o.b,{to:"/Manage/AllStations/".concat(e.id)},e.location)),i.a.createElement(Ct.a,null,e.activeStaffs),i.a.createElement(Ct.a,null,i.a.createElement(i.a.Fragment,null," ",e.address.street," ",i.a.createElement("br",null),"   ",e.address.postcode," ",e.address.city," ",i.a.createElement("br",null),"  ",e.address.country,"    ",i.a.createElement(ga.a,{name:e.address&&e.address.country&&e.address.country.toLowerCase()})," ")),i.a.createElement(Ct.a,null,e.phone&&e.phone.reduce((function(e,t){return i.a.createElement(i.a.Fragment,null,t,"  ",i.a.createElement("br",null)," ",e)}),"")," "),i.a.createElement(Ct.a,null,e.email))})))),E&&i.a.createElement(ba,{open:E,setOpen:b}))},va=a(239),Oa=function(e){var t=e.stationLocation,a=e.activeItem,n=e.setActiveItem,r=Object(s.g)(),l=function(e,t){var i=t.name;n(i),a!==i&&r.push(i)};return i.a.createElement(q.a,{pointing:!0,secondary:!0},i.a.createElement(q.a.Item,{header:!0},t),i.a.createElement(q.a.Item,{position:"right",name:"BasicInfo",active:"BasicInfo"===a,onClick:l}),i.a.createElement(q.a.Item,{name:"Procedures",active:"Procedures"===a,onClick:l}),i.a.createElement(q.a.Item,{name:"Costumers",active:"Costumers"===a,onClick:l}),i.a.createElement(q.a.Item,{name:"Settings",active:"Settings"===a,onClick:l}))},Sa=function(e){var t=Object(r.useState)(""),a=Object(f.a)(t,2),n=a[0],l=a[1],c=Object(r.useState)("BasicInfo"),m=Object(f.a)(c,2),u=m[0],d=m[1],E=Object(s.i)().stationId;e.stationId&&(E=e.stationId);var v=JSON.parse(sessionStorage.getItem("staffKey")),S=Object(g.useQuery)(T,{variables:{id:E},skip:!E,onCompleted:function(e){return l(e.getStation)}}).loading;return console.log(n),E&&n&&!S?i.a.createElement(i.a.Fragment,null,i.a.createElement(Oa,{station:n,activeItem:u,setActiveItem:d}),"BasicInfo"===u&&i.a.createElement(b.a,{padded:!0},i.a.createElement(b.a.Row,{columns:"4"},i.a.createElement(b.a.Column,null,i.a.createElement(h.a,{as:"h4"},"Address:",i.a.createElement(h.a.Subheader,null,n.address.street,i.a.createElement("br",null),n.address.postcode,n.address.city,i.a.createElement("br",null),n.address.country," ",i.a.createElement(ga.a,{name:n.address.country.toLowerCase()})))),i.a.createElement(b.a.Column,null,i.a.createElement(h.a,{as:"h4"},"Contact:",i.a.createElement(h.a.Subheader,null,i.a.createElement("strong",null,"Email: ")," ",n.email,i.a.createElement("br",null),i.a.createElement("strong",null,"Phone: "),n.phone.reduce((function(e,t){return e+" / "+t}))))),i.a.createElement(b.a.Column,null,i.a.createElement(h.a,{as:"h4"},"Shifts:",n.shifts.map((function(e,t){return i.a.createElement(h.a.Subheader,{key:t}," ",e.name," ",i.a.createElement("strong",null," Starts at: ")," ",e.startTime,i.a.createElement("br",null))}))))),i.a.createElement(b.a.Row,null,i.a.createElement(b.a.Column,null,i.a.createElement(h.a,{as:"h4"},"Current Staffs:"),i.a.createElement(G.a,{collapsing:!0},i.a.createElement(G.a.Header,null,i.a.createElement(G.a.Row,null,i.a.createElement(G.a.HeaderCell,null," Name "),i.a.createElement(G.a.HeaderCell,null," Last Active At:  "))),i.a.createElement(G.a.Body,null,n.staffList.length>0&&n.staffList.map((function(e,t){return i.a.createElement(G.a.Row,{key:t},i.a.createElement(G.a.Cell,null,v.permission.staff.view?i.a.createElement(o.b,{to:"/Manage/AllStaffs/".concat(e.id,"/Profile")},e.name):e.name),i.a.createElement(G.a.Cell,null,de(e.lastActive.activeAt)))}))))))),"Procedures"===u&&i.a.createElement(h.a,{as:"h5"}," This Station Procedure feature is not Implemented yet, will be implemanted soon ...",i.a.createElement(h.a.Subheader,null,"After this implemetation, one will be able to add/ view / search all the station related procedure such as 'Garbage Disposal , Hanger Booking , Supplies Delivery ...' on this section")),"Costumers"===u&&i.a.createElement(i.a.Fragment,null,n.costumers&&n.costumers.map((function(e){return i.a.createElement(va.a,{key:e.id,link:!0,raised:!0,as:o.b,to:"/Manage/AllStaffs"},i.a.createElement(va.a.Content,{textAlign:"center",header:e.name}),i.a.createElement(va.a.Content,{textAlign:"center"},e.contract?e.contract+" Contract":""),i.a.createElement(va.a.Content,{textAlign:"center",extra:!0},i.a.createElement(h.a,{as:"h5"}," ",i.a.createElement(K.a,{name:"plane"})," Total Aircrafts: ",e.aircrafts.length)))})),i.a.createElement(p.a,{primary:!0,icon:!0,floated:"left"},i.a.createElement(K.a,{name:"add circle"})," Add More ")),"Settings"===u&&i.a.createElement(h.a,{as:"h5"}," This Station Settings feature is not Implemented yet, will be implemanted soon ...",i.a.createElement(h.a.Subheader,null,"After this implemetation, one will be able to change station settings such as 'SignIn/Off Work Methods', 'Add Remove Shifts', 'Number of active reporting', 'Change Station Key'"))):i.a.createElement(O.a,{basic:!0},i.a.createElement(L.a,{active:!0},"Loading Station"))},ya=function(e){var t=e.activeItem,a=e.setActiveItem,n=JSON.parse(sessionStorage.getItem("staffKey")),r=Object(s.g)(),l=function(e,t){var n=t.name;a(n),["Profile","Timesheets","TimesheetsOverview"].includes(n)?r.push("/Manage/MyPage/".concat(n)):r.push("/Manage/".concat(n))},c=[];(n.permission.station.edit.length>0||n.permission.station.add)&&c.push("AllStations"),n.permission.staff.view&&c.push("AllStaffs"),n.permission.timesheet.view.length>0&&(c.push("ManageTimesheets"),c.push("Costumers"));return i.a.createElement(q.a,{inverted:!0,color:"blue",stackable:!0},c.map((function(e){return i.a.createElement(q.a.Item,{key:e,name:e,active:t===e,onClick:l})})),i.a.createElement(q.a.Menu,{position:"right"},i.a.createElement(kt.a,{item:!0,text:"Welcome ".concat(n.name)},i.a.createElement(kt.a.Menu,null,c.length>0&&i.a.createElement(i.a.Fragment,null,i.a.createElement(kt.a.Item,{disabled:!0,text:"My Pages",onClick:l}),i.a.createElement(kt.a.Item,{name:"Profile",text:"Profile",onClick:l}),i.a.createElement(kt.a.Item,{name:"Timesheets",text:"Timesheets",onClick:l}),i.a.createElement(kt.a.Item,{name:"TimesheetsOverview",text:"TimesheetsOverview",onClick:l}),i.a.createElement(kt.a.Divider,null)),i.a.createElement(kt.a.Item,{text:"Logout",onClick:function(){return sessionStorage.removeItem("staffKey"),void r.push("/staffLogin")}})))))},ja=function(){var e=Object(s.i)(),t=Object(s.h)(),a=t.pathname.split("/")[2],n=Object(r.useState)(a),l=Object(f.a)(n,2),c=l[0],o=l[1];return Object(r.useEffect)((function(){o(a)}),[a,t,e]),i.a.createElement(i.a.Fragment,null,i.a.createElement(ya,{activeItem:c,setActiveItem:o}),c&&"managetimesheets"===c.toLowerCase()&&i.a.createElement(Xt,null),"mypage"===c.toLowerCase()&&i.a.createElement(i.a.Fragment,null,i.a.createElement(ua,null)),"allstaffs"===c.toLowerCase()&&!e.staffId&&i.a.createElement(i.a.Fragment,null,i.a.createElement(fa,null)),"allstaffs"===c.toLowerCase()&&e.staffId&&i.a.createElement(i.a.Fragment,null,i.a.createElement(ua,{id:e.staffId})),c&&"allstations"===c.toLowerCase()&&!e.stationId&&i.a.createElement(i.a.Fragment,null,i.a.createElement(ha,null)),c&&"allstations"===c.toLowerCase()&&e.stationId&&i.a.createElement(i.a.Fragment,null,i.a.createElement(Sa,null)))},wa=function(){return i.a.createElement(o.a,null,i.a.createElement(s.d,null,i.a.createElement(s.b,{path:["/shiftReport/:station/:id","/shiftReport/:id"]},i.a.createElement(tt,null)),i.a.createElement(s.b,{path:"/stationLogin"},i.a.createElement($,null)),i.a.createElement(s.b,{path:"/staffLogin"},i.a.createElement(bt,null)),i.a.createElement(s.b,{path:["/staff/:staffId/:page/:period","/staff/:staffId/:page"]},i.a.createElement(ua,null)),i.a.createElement(s.a,{from:"/staff/:staffId",to:"/staff/:staffId/Profile"}),i.a.createElement(s.b,{path:"/staff"},i.a.createElement(ua,null)),i.a.createElement(s.a,{from:"/Manage/MyPage/:page/:id/:period",to:"/Manage/MyPage/:page/:period"}),i.a.createElement(s.b,{path:["/Manage/AllStaffs/:staffId/:page/:period","/Manage/AllStaffs/:staffId/:page/","/Manage/MyPage/:page/:period","/Manage/MyPage/:page/"]},i.a.createElement(ja,null)),i.a.createElement(s.a,{from:"/Manage/AllStaffs/:staffId",to:"/Manage/AllStaffs/:staffId/Profile"}),i.a.createElement(s.b,{path:"/Manage/AllStaffs"},i.a.createElement(ja,null)),i.a.createElement(s.b,{path:["/Manage/ManageTimesheets/:staffId/:period","/Manage/ManageTimesheets/:staffId","/Manage/ManageTimesheets"]},i.a.createElement(ja,null)),i.a.createElement(s.b,{path:["/Manage/AllStations/:stationId/:page"]},i.a.createElement(ja,null)),i.a.createElement(s.a,{from:"/Manage/AllStations/:stationId",to:"/Manage/AllStations/:stationId/BasicInfo"}),i.a.createElement(s.b,{path:"/Manage/AllStations"},i.a.createElement(ja,null)),i.a.createElement(s.a,{from:"/Manage",to:"/Manage/MyPage/Profile"}),i.a.createElement(s.b,{path:"/Manage"},i.a.createElement(ja,null)),i.a.createElement(s.b,{path:"/Register/:registerCode"},i.a.createElement(ua,null)),i.a.createElement(s.b,{path:"/"},i.a.createElement($,null))))},Ca=(a(613),a(666)),ka=a(412),Ta=Object(ka.a)((function(e,t){var a=t.headers,r=JSON.parse(sessionStorage.getItem("staffKey"));r||(r=JSON.parse(localStorage.getItem("stationKey")))||(r=JSON.parse(sessionStorage.getItem("stationKey")));var i=r?r.value:null;return{headers:Object(n.a)(Object(n.a)({},a),{},{authorization:i?"bearer ".concat(i):null})}})),Ra=new g.HttpLink({uri:"http://localhost:4000"}),Da=new g.ApolloClient({cache:new g.InMemoryCache,link:Ta.concat(Ra)});c.a.render(i.a.createElement(g.ApolloProvider,{client:Da},i.a.createElement(Ca.a,null,i.a.createElement(wa,null))),document.getElementById("root"))}},[[424,1,2]]]);
//# sourceMappingURL=main.09db5621.chunk.js.map