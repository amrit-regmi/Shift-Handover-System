(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{349:function(e,t,a){},425:function(e,t,a){e.exports=a(614)},614:function(e,t,a){"use strict";a.r(t);var n=a(11),r=a(0),i=a.n(r),l=a(95),c=a.n(l),o=a(41),s=a.n(o),m=a(62),u=a(5),d=a(35),f=a(9),p=a(660),E=a(85),g=a(397),b=a(661),h=a(139),O=a(290),y=a(414),v=a(662),S=a(20);function C(){var e=Object(S.a)(["\n  query fetchStation($id: String!){\n    getStation(id: $id) {\n      costumers {\n        contract\n        aircrafts {\n          id\n          registration\n        }\n        name\n        id\n      }\n      shifts {\n        id\n        name\n        startTime\n      }\n      location\n      id\n      address {\n        country\n        postcode\n        city\n        street\n      }\n      phone\n      email\n      staffList{\n        id\n        name\n        lastActive{\n          activeAt\n        }\n      }\n      procedures{\n        title\n        description\n      }\n      mailingList\n\n    }\n  }\n\n"]);return C=function(){return e},e}function j(){var e=Object(S.a)(["\n query ($detailed: Boolean = false ){\n  allStations (detailed: $detailed){\n    id\n    location\n    shifts @skip(if: $detailed){\n      name\n      startTime\n    }\n    address @include(if: $detailed){\n      country\n      postcode\n      city\n      street\n    }\n    phone @include(if: $detailed)\n    email @include(if: $detailed)\n    activeStaffs @include(if: $detailed)\n    \n  }\n}"]);return j=function(){return e},e}var w=Object(f.gql)(j()),k=Object(f.gql)(C());function T(){var e=Object(S.a)(["mutation  assignCostumers( $stationId: String! $costumers:[String!]!){\n    assignCostumers(\n      stationId: $stationId,\n      costumers: $costumers\n    ){\n      id\n      costumers {\n        id\n        name\n        contract\n        aircrafts{\n        id\n      }\n    }\n    }\n  }\n\n \n"]);return T=function(){return e},e}function I(){var e=Object(S.a)(["mutation deleteStation ( $stationId: String!){\n    deleteStation( stationId: $stationId){\n      status\n      message\n    }\n\n  }\n\n  "]);return I=function(){return e},e}function A(){var e=Object(S.a)(["mutation changeStationKey(\n    $stationKey:String!\n    $stationId: String!\n  ){\n    changeStationKey(\n      stationKey: $stationKey\n      stationId: $stationId\n    ){\n     status\n      message\n    }\n  }\n\n  "]);return A=function(){return e},e}function D(){var e=Object(S.a)([" mutation removeShift( $id:String! ,$stationId: String!){\n    removeShift(\n      id:$id\n      stationId: $stationId\n    ){\n      status\n      message\n    }\n  }\n  "]);return D=function(){return e},e}function R(){var e=Object(S.a)(["mutation addShifts($shifts:[ShiftInfoInput!]!, $stationId: String!){\n    addShifts(\n      shifts:$shifts\n      stationId: $stationId\n    ) {\n      id\n      name\n      startTime\n    }\n  }"]);return R=function(){return e},e}function F(){var e=Object(S.a)(["mutation removeFromMailingList($email:String! , $stationId: String!){\n    removeFromMailingList(\n      email: $email\n      stationId: $stationId\n    ){\n      status\n      message\n    }\n  }"]);return F=function(){return e},e}function $(){var e=Object(S.a)([" mutation addToMailingList($emails:[String!]! , $stationId: String!){\n    addToMailingList(\n      email: $emails\n      stationId: $stationId\n    ){\n      status\n      message\n    }\n  }\n\n  "]);return $=function(){return e},e}function N(){var e=Object(S.a)(["\n  mutation addStation ($location:String! , $address: AddressInput! , $phone: String! ,$email: String!, $shifts: [ShiftInfoInput], $costumers: [String], $stationKey:String! ){\n    addStation(\n      location:$location\n      address:$address\n      phone:$phone\n      email:$email\n      shifts:$shifts\n      costumers:$costumers\n      stationKey: $stationKey\n    ){\n      id\n    }\n  }"]);return N=function(){return e},e}function P(){var e=Object(S.a)(["\n  mutation stationLogin($id: String!, $password:String!){\n    loginToStation(id: $id, password: $password) \n  }\n"]);return P=function(){return e},e}var x=Object(f.gql)(P()),M=Object(f.gql)(N()),H=Object(f.gql)($()),L=Object(f.gql)(F()),q=Object(f.gql)(R()),_=Object(f.gql)(D()),B=Object(f.gql)(A()),K=Object(f.gql)(I()),z=Object(f.gql)(T()),U=a(22),Y=a(659),V=function(e){var t=e.dispatch,a=e.notification;return Object(r.useEffect)((function(){var e=setTimeout((function(){t({type:"REMOVE_NOTIFICATION",payload:{id:a.id}})}),5e3);return function(){clearTimeout(e)}}),[]),i.a.createElement(Y.a,{success:"SUCCESS"===a.type,error:"ERROR"===a.type,attached:!0,onDismiss:function(){return t({type:"REMOVE_NOTIFICATION",payload:{id:a.id}})}},a.content)},J=function(){var e=Object(r.useContext)(Q),t=Object(u.a)(e,2),a=t[0],n=t[1];return i.a.createElement(O.a,{basic:!0,style:{width:"inherit",position:"fixed",zIndex:1e3,padding:0}},a.map((function(e){return i.a.createElement(V,{key:e.id,notification:e,dispatch:n})})))},Q=Object(r.createContext)(),W=[],G=function(e,t){switch(console.log("this is initialized"),console.log(t.type),t.type){case"ADD_NOTIFICATION":return[].concat(Object(U.a)(e),[{id:e.length+1,content:t.payload.content,type:t.payload.type}]);case"REMOVE_NOTIFICATION":return e.filter((function(e){return e.id!==t.payload.id}));default:return e}},Z=function(e){var t=Object(r.useReducer)(G,W);return i.a.createElement(Q.Provider,{value:t},i.a.createElement(J,null),e.children)},X=function(){var e=Object(r.useContext)(Q),t=Object(u.a)(e,2)[1],a=Object(d.g)(),n=Object(r.useState)({}),l=Object(u.a)(n,2),c=l[0],o=l[1],S=Object(r.useState)(""),C=Object(u.a)(S,2),j=C[0],k=C[1],T=Object(r.useState)(!1),I=Object(u.a)(T,2),A=I[0],D=I[1],R=Object(f.useQuery)(w,{notifyOnNetworkStatusChange:!0}),F=R.loading,$=(R.error,R.data),N=Object(f.useMutation)(x,{onError:function(e){t({type:"ADD_NOTIFICATION",payload:{content:i.a.createElement(i.a.Fragment,null,"Error, Cannot Login",i.a.createElement("br",null)," ",e.message),type:"ERROR"}})}}),P=Object(u.a)(N,2),M=P[0],H=P[1];Object(r.useEffect)((function(){if(H.data){var e=H.data.loginToStation;k(e),sessionStorage.setItem("stationKey",JSON.stringify(e)),A&&localStorage.setItem("stationKey",JSON.stringify(e)),a.push("/shiftReport/station/".concat(c.value))}}),[H.data]);var L=function(){var e=Object(m.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),M({variables:{id:c.value,password:j}});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),q=JSON.parse(sessionStorage.getItem("stationKey"));if(!q){var _=localStorage.getItem("stationKey");q=JSON.parse(_),sessionStorage.setItem("stationKey",JSON.stringify(_))}q&&a.push("/shiftReport/station/".concat(q.id));var B=function(){D(!A)};return i.a.createElement(g.a,{textAlign:"center",style:{height:"100vh"},verticalAlign:"middle"},i.a.createElement(g.a.Column,{style:{maxWidth:450}},i.a.createElement(b.a,{as:"h2",color:"blue",textAlign:"center"},i.a.createElement(h.a,{src:"/LogoMin.png"})," Please select a station"),i.a.createElement(p.a,{size:"large",style:{textAlign:"left"},onSubmit:L},i.a.createElement(O.a,{clearing:!0,stacked:!0},F&&i.a.createElement(O.a,{loading:!0,basic:!0}),!F&&$.allStations&&$.allStations.map((function(e){return i.a.createElement(p.a.Field,{style:{float:"left",clear:"none",marginRight:"10px"},key:e.id},i.a.createElement(y.a,{label:e.location,value:e.id,checked:c.value===e.id,onChange:function(e,t){return function(e,t){var a=t.value,n=t.label;o({value:a,label:n})}(0,t)}}))})),i.a.createElement("div",{style:{clear:"both"}}),c.value&&function(e){return i.a.createElement(i.a.Fragment,null,i.a.createElement(p.a.Input,{name:"stationKey",value:j,onChange:function(e){var t=e.target;return k(t.value)},label:"Enter password for ".concat(e.label),fluid:!0,icon:"lock",iconPosition:"left",placeholder:"Password",type:"password"}),i.a.createElement(p.a.Checkbox,{name:"rememberKey",label:"Remember on this computer",checked:A,onClick:B}),i.a.createElement(E.a,{fluid:!0,size:"large",color:"blue"},"Retrieve Shift Report"))}(c))),i.a.createElement(v.a,{horizontal:!0},"Or"),i.a.createElement(O.a,{clearing:!0,stacked:!0},i.a.createElement(E.a,{content:"Log in to personal page",icon:"user",size:"large",color:"teal",fluid:!0,onClick:function(){return a.push("/staffLogin")}}))))};a(349);function ee(){var e=Object(S.a)(["\n  query fetchReportbyShift($station: String!, $shift: String!, $date: Date!){\n    getShiftReportByShift(station: $station, shift: $shift, date: $date) {\n      startTime,\n      endTime,\n      id,\n      shift,\n      station{\n        location\n      }\n    }\n  }\n"]);return ee=function(){return e},e}function te(){var e=Object(S.a)([" \n  query fetchReportList ( $stationId: String,  ){\n    getReportList (stationId: $stationId){\n      startTime,\n      endTime,\n      id,\n      shift\n      station{\n        location\n      }\n    }\n  }\n\n\n"]);return te=function(){return e},e}function ae(){var e=Object(S.a)(["\nquery fetchReport($id:String, $station: String, $flag: String){\n    getShiftReport(id: $id, station: $station, flag: $flag) {\n      endTime\n      id\n      shift\n      staffAndTime {\n        id\n        staff {\n          name\n        }\n        endTime\n        startTime\n      }\n      startTime\n      station {\n        location\n        id\n      }\n      tasks {\n        id\n        aircraft {\n          registration\n          id\n          costumer {\n            name\n          }\n        }\n        taskCategory\n        description\n        status\n        updates {\n          action\n          handoverId {\n            id\n            shift\n          }\n          note\n        }\n        \n      }\n    } \n}\n\n"]);return ae=function(){return e},e}var ne=Object(f.gql)(ae()),re=Object(f.gql)(te()),ie=Object(f.gql)(ee()),le=a(668),ce=a(663),oe=a(398),se=function(e){var t=e.activeItem,a=e.setActiveItem,n=Object(d.g)(),l=Object(r.useState)(!1),c=Object(u.a)(l,2),o=c[0],s=c[1],m=Object(r.useState)(""),f=Object(u.a)(m,2),p=f[0],g=f[1],b=function(){return i.a.createElement(ce.a,{open:o,cancelButton:"I understand that all reporting will be lost, Continue",confirmButton:"Cancel and Continue Reporting",header:"Are You sure?",content:"You are navigationg away from from the reporting page, doing so will result in losing all the inputs on the report page. Do you want to continue?",onCancel:function(){a(p),s(!1)},onConfirm:function(){s(!1)}})},h=function(e,n){var r=n.name;if("startNewReport"===t)return g(r),void s(!0);a(r)};return i.a.createElement(i.a.Fragment,null,i.a.createElement(oe.a,{inverted:!0,color:"blue",stackable:!0},i.a.createElement(oe.a.Item,{header:!0},"  Shift Reporting System "),i.a.createElement(oe.a.Item,{name:"lastShiftReport",active:"lastShiftReport"===t,onClick:h}),i.a.createElement(oe.a.Item,{name:"browseAllReports",active:"browseAllReports"===t,onClick:h}),i.a.createElement(oe.a.Item,{name:"startNewReport",active:"startNewReport"===t,onClick:h}),i.a.createElement(oe.a.Item,{name:"stationInfo",active:"stationInfo"===t,onClick:h}),i.a.createElement(oe.a.Menu,{position:"right"},i.a.createElement(E.a,{primary:!0,name:"Switch Station ",active:"logout"===t,onClick:function(){localStorage.removeItem("stationKey"),sessionStorage.removeItem("stationKey"),n.push("/")}},"Switch Station"))),i.a.createElement(b,null))},me=a(214),ue=a(118),de=a(43),fe=a(12),pe=a.n(fe),Ee=function(e){var t=e.task,a=e.handoverId,n=pe.a.find(t.updates,["handoverId",{id:a}]);return i.a.createElement(O.a,null,!n.action.includes("TASK_CREATED")&&i.a.createElement(ue.a,{size:"mini",basic:!0},"Tasks from previous shifts"),("DEFERRED"===n.action||"TASK_CREATED_DEFERRED"===n.action)&&i.a.createElement(i.a.Fragment,null,i.a.createElement(ue.a,{size:"mini",color:"red",basic:!0}," Deferred "),i.a.createElement(ue.a,{color:"red",size:"mini",basic:!0}," Action Required ")),"CLOSED"===n.action&&i.a.createElement(ue.a,{color:"green",size:"mini",basic:!0}," Completed "),"OPEN"===t.status&&n&&i.a.createElement(i.a.Fragment,null,!n.action.includes("TASK_CREATED")&&i.a.createElement(ue.a,{size:"mini",basic:!0}," ",n.action," "),i.a.createElement(ue.a,{color:"purple",size:"mini",basic:!0}," Open ")),!n.action.includes("TASK_CREATED")&&t.updates.length>1&&i.a.createElement(ue.a,{as:"a",size:"mini",onClick:function(){}}," ",i.a.createElement(de.a,{name:"history"})," Action History   "),i.a.createElement(O.a,{style:{paddingTop:0,paddingLeft:0},basic:!0,compact:!0},t.description,"   "))},ge=function(e){var t=e.genericTasks,a=e.handoverId;return 0===t.legth?null:i.a.createElement(i.a.Fragment,null,i.a.createElement(O.a,{stacked:!0},i.a.createElement(b.a,{color:"blue",as:"h4",block:!0}," ",t[0].taskCategory," "),i.a.createElement(me.a,null,pe.a.map(t,(function(e){return i.a.createElement(Ee,{key:e.id,task:e,handoverId:a})})))))},be=function(e){var t=e.aircraftTasks,a=e.handoverId;return 0===t.legth?null:i.a.createElement(O.a,{stacked:!0},pe.a.map(t,(function(e,t){return i.a.createElement(me.a,{key:t},i.a.createElement(b.a,{color:"blue",as:"h4",block:!0}," ",i.a.createElement(de.a,{name:"plane"})," Work Performed for ",t),pe.a.map(e,(function(e,t){return i.a.createElement(me.a,{key:t},i.a.createElement(O.a,null,t),pe.a.map(e,(function(e){return i.a.createElement(Ee,{key:e.id,task:e,handoverId:a})})))})))})))},he=a(664),Oe=function(e){var t=e.timesheets;return i.a.createElement(O.a,null,i.a.createElement(he.a,{celled:!0},i.a.createElement(he.a.Header,null,i.a.createElement(he.a.Row,null,i.a.createElement(he.a.HeaderCell,null,"Staff"),i.a.createElement(he.a.HeaderCell,null,"Start Time"),i.a.createElement(he.a.HeaderCell,null,"End TIme"))),i.a.createElement(he.a.Body,null,t.map((function(e){return i.a.createElement(he.a.Row,{key:e.id},i.a.createElement(he.a.Cell,null,e.staff.name),i.a.createElement(he.a.Cell,null,e.startTime.substring(10)),i.a.createElement(he.a.Cell,null,e.endTime.substring(10)))})))))},ye=function(e){var t=e.reportData;if(!t)return i.a.createElement(O.a,null,"No reports found");var a=pe.a.groupBy(t.tasks,(function(e){return e.taskCategory})),n=pe.a.mapValues(a,(function(e,t){return"AIRCRAFT"===t?pe.a.chain(a.AIRCRAFT).groupBy((function(e){return e.aircraft.costumer.name})).mapValues((function(e){return pe.a.groupBy(e,(function(e){return e.aircraft.registration}))})).value():e}));return i.a.createElement(me.a,null,i.a.createElement(O.a,{basic:!0,clearing:!0},i.a.createElement(b.a,{floated:"left"}," Shift Report from ",t.shift," shift ",i.a.createElement("span",null,i.a.createElement("h5",null,"(",t.startTime.substring(10)," - ",t.endTime.substring(10),")"))),i.a.createElement(b.a,{floated:"right",as:"h5"},"  ",t.startTime.substring(10,0),i.a.createElement("span",null,i.a.createElement("br",null),t.station.location)," ")),i.a.createElement(Oe,{timesheets:t.staffAndTime}),pe.a.map(n,(function(e,a){return"AIRCRAFT"===a?i.a.createElement(be,{key:a,aircraftTasks:e,handoverId:t.id}):i.a.createElement(ge,{key:a,genericTasks:e,handoverId:t.id})})))},ve=Object(r.createContext)({lastShiftReport:[],station:[]}),Se=function(e,t){switch(t.type){case"ADD_LASTSHIFTREPORT":return Object(n.a)(Object(n.a)({},e),{},{lastShiftReport:t.payload});case"INIT_STATION":return Object(n.a)(Object(n.a)({},e),{},{station:t.payload});default:return e}},Ce=a(56),je=a(18),we=a(616),ke=a(80),Te=a(117),Ie=a(619),Ae=a(298),De=function(e){var t=e.label,a=Object(ke.a)(e,["label"]),n=Object(je.f)(),r=n.setFieldValue,l=n.setFieldTouched,c=Object(je.e)(a),o=Object(u.a)(c,2),s=o[0],m=o[1];return i.a.createElement(p.a.Field,{width:"4"},t&&i.a.createElement("label",null,t),i.a.createElement(Te.DateTimeInput,Object.assign({error:!(!m.touched||!m.error),popupPosition:"right center"},s,a,{dateTimeFormat:"DD-MM-YYYY HH:mm",closable:!0,onBlur:function(){l(s.name,!0)},onChange:function(e,t){var a=t.value;r(s.name,a)},preserveViewMode:!1})),m.touched&&m.error?i.a.createElement(ue.a,{pointing:!0,prompt:!0},m.error):"")},Re=function(e){var t=e.label,a=Object(ke.a)(e,["label"]),n=Object(je.f)(),r=n.setFieldValue,l=n.setFieldTouched,c=Object(je.e)(a),o=Object(u.a)(c,2),s=o[0],m=o[1];return i.a.createElement(p.a.Field,{width:"4"},t&&i.a.createElement("label",null,t),i.a.createElement(Te.TimeInput,Object.assign({error:!(!m.touched||!m.error),popupPosition:"right center"},s,a,{closable:!0,onBlur:function(){l(s.name,!0)},onChange:function(e,t){var a=t.value;r(s.name,a)}})),m.touched&&m.error?i.a.createElement(ue.a,{pointing:!0,prompt:!0},m.error):"")},Fe=function(e){var t=e.width,a=Object(ke.a)(e,["width"]),n=Object(je.e)(a),r=Object(u.a)(n,2),l=r[0],c=r[1];return i.a.createElement(i.a.Fragment,null,i.a.createElement(p.a.Field,{error:!(!c.touched||!c.error),width:t},i.a.createElement("label",null,a.inputlabel?a.inputlabel:""),i.a.createElement(Ie.a,Object.assign({},l,a)),"hidden"!==a.type&&c.touched&&c.error&&i.a.createElement(ue.a,{pointing:!0,prompt:!0},c.error)))},$e=function(e){var t=e.label,a=e.children,n=e.checked,r=Object(ke.a)(e,["label","children","checked"]);return i.a.createElement(O.a,{style:{display:n?"block":"inline-block"}},i.a.createElement(Ae.a,Object.assign({checked:n},r,{toggle:!0})),i.a.createElement("label",{style:{display:"inline-block",marginLeft:"5px",verticalAlign:"super"}}," ",t.toUpperCase()," "),a)},Ne=function(e){e.label;var t=Object(ke.a)(e,["label"]),a=Object(je.e)(t),n=Object(u.a)(a,2),r=n[0],l=n[1];return i.a.createElement(p.a.TextArea,Object.assign({error:l.touched&&l.error},r,t))},Pe=function(e){if(!e)return null;if(isNaN(e)){switch([/^(-?(?:[1-9][0-9]*)?[0-9]{4})-(1[0-2]|0[1-9])-(3[01]|0[1-9]|[12][0-9])T(2[0-3]|[01][0-9]):([0-5][0-9]):([0-5][0-9])(\.[0-9]+)?(Z)?$/].findIndex((function(t){return!!e.match(t)}))){case 0:var t=e.split("T"),a=t[0],n=t[1],r=a.split("-"),i=n.split(".")[0].split(":");return r[2]+"-"+r[1]+"-"+r[0]+" "+i[0]+":"+i[1];default:return null}}var l=new Date(e);return"".concat(l.getDate().toString().padStart(2,0),"-").concat((l.getMonth()+1).toString().padStart(2,0),"-").concat(l.getFullYear()," ").concat(l.getHours().toString().padStart(2,0),":").concat(l.getMinutes().toString().padStart(2,0))},xe=function(e,t,a,n){if(!e)return null;var r;if(Object(fe.isNumber)(e))r=new Date(e);else{var i=e.split(" "),l=i[0].split("-"),c="".concat(l[2],"-").concat(l[1],"-").concat(l[0]," ").concat(i[1]);r=Date.parse(c)}switch(a){case"d":if("add"===n)return Pe(r+24*t*60*60*1e3);if("sub"===n)return Pe(r-24*t*60*60*1e3);break;case"h":if("add"===n)return Pe(r+60*t*60*1e3);if("sub"===n)return Pe(r-60*t*60*1e3);break;case"m":if("add"===n)return Pe(r+60*t*1e3);if("sub"===n)return Pe(r-60*t*1e3);break;default:return Pe(r)}},Me=function(e){var t;if(Object(fe.isNumber)(e))t=new Date(e);else{var a=e.split(" "),n=a[0].split("-"),r="".concat(n[2],"-").concat(n[1],"-").concat(n[0]," ").concat(a[1]||"00",":").concat("00"|a[2]);t=Date.parse(r)}return t},He=function(e){var t=new Date(e.valueOf()),a=(e.getDay()+6)%7;t.setDate(t.getDate()-a+3);var n=t.valueOf();return t.setMonth(0,1),4!==t.getDay()&&t.setMonth(0,1+(4-t.getDay()+7)%7),1+Math.ceil((n-t)/6048e5)},Le=function(e,t){var a=new Date(Date.UTC(t,0,1+7*(e-1))),n=a.getDay(),r=a;return n<=4?r.setDate(a.getDate()-a.getDay()+1):r.setDate(a.getDate()+8-a.getDay()),r},qe=function(e){e||(e=4);var t=(new Date).getMonth();return Object(U.a)(new Array(e)).map((function(e,a){return{key:a,text:(n=t-a,new Proxy(["January","February","March","April","May","June","July","August","September","October","November","December"],{get:function(e,t){return isNaN(t)||(t=parseInt(t,10))<0&&(t+=e.length),e[t]}})[n]),value:t-1<0?11+t-a:t-a};var n}))},_e=function(e){e||(e=4);for(var t=new Date,a=t.getMonth(),n=t.getFullYear(),r=He(new Date(n-1,11,28)),i=He(new Date(n,a-e,1)),l=[],c=He(t);c!==i-1;){var o={key:c,text:c,value:c};l.push(o),0===(c-=1)&&(c=r)}return l},Be=function(e){var t;if(e)return e.name||(t=Object(n.a)(Object(n.a)({},t),{},{name:"Staff name is required"})),t=Object(n.a)(Object(n.a)({},t),Ke(e.startTime,e.endTime))},Ke=function(e,t,a){var r;return e||(r=Object(n.a)(Object(n.a)({},r),{},{startTime:"Start time is required"})),t||(r=Object(n.a)(Object(n.a)({},r),{},{endTime:"End time is required"})),e.match(/^(0[1-9]|[12][0-9]|3[01])-(0[1-9]|1[0-2])-\d\d\d\d (0[0-9]|1[0-9]|2[0-3]):([0-9]|[0-5][0-9])$/)||(r=Object(n.a)(Object(n.a)({},r),{},{startTime:"Start time should be on format DD-MM-YYYY HH:MM"})),t.match(/^(0[1-9]|[12][0-9]|3[01])-(0[1-9]|1[0-2])-\d\d\d\d (0[0-9]|1[0-9]|2[0-3]):([0-9]|[0-5][0-9])$/)||(r=Object(n.a)(Object(n.a)({},r),{},{endTime:"End time should be on format DD-MM-YYYY HH:MM"})),!a&&Me(e)+864e5<=Date.now()&&(r=Object(n.a)(Object(n.a)({},r),{},{startTime:"Start time should be within last 24 hours"})),a&&new Date(a).getDate()!==new Date(Me(e)).getDate()&&(r=Object(n.a)(Object(n.a)({},r),{},{startTime:"Start time should be on ".concat(Pe(new Date(a)).split(" ")[0])})),Me(e)>=Me(t)&&(r=Object(n.a)(Object(n.a)({},r),{},{startTime:"Start time cannot be later than endtime"})),Me(e)>Date.now()&&(r=Object(n.a)(Object(n.a)({},r),{},{startTime:"Start time cannot be on future"})),Me(t)>Date.now()&&(r=Object(n.a)(Object(n.a)({},r),{},{endTime:"End time cannot be on future"})),r},ze=function(e){var t=null;return"DEFERRED"===e.status&&(e.action&&"NOTES_ADDED"!==e.action||(console.log(e),t=Object(n.a)(Object(n.a)({},t),{},{action:"Action was requested on this task. Please perform a action. "}))),e.status||e.action||(t=Object(n.a)(Object(n.a)({},t),{},{action:"Task must have one of the following status"})),e.description&&""!==e.description.trim()||(t=Object(n.a)(Object(n.a)({},t),{},{description:"Please add task description"})),t},Ue=function(e){return e?e.match(/^[\w-.]+@([\w-]+\.)+[\w-]{2,4}$/)?void 0:"Incorrect email format":"Email is required"},Ye=function(e){return e&&""!==e.trim?e.length<4?"Name must be at least 4 character long":void 0:"Full name is required"},Ve=function(e){var t=e.name,a=e.pointing;return i.a.createElement(je.a,{name:t},(function(e){var n=e.form,r=Object(je.d)(n.errors,t);return Object(je.d)(n.touched,t)&&r&&"string"===typeof r?i.a.createElement(ue.a,{pointing:a,style:{height:"fit-content"},color:"red",basic:!0},r):null}))},Je=a(253);function Qe(){var e=Object(S.a)(["\n mutation requestClarification($id: String!, $clearify: String){\n  requestClarification(\n     id: $id,\n     clearify:$clearify,    \n   ){\n    id\n    remarks{\n      by\n      date\n      edit\n      text\n      title\n    }\n   }\n }\n"]);return Qe=function(){return e},e}function We(){var e=Object(S.a)(["\n mutation deleteTimeSheet($id: String!){\n   deleteTimeSheet(\n     id: $id,    \n   ){\n     status\n     message\n   }\n }\n"]);return We=function(){return e},e}function Ge(){var e=Object(S.a)(["\n mutation approveTimeSheet($id: String!, $status: String!){\n   approveTimeSheet(\n     id: $id,\n     status: $status\n   ){\n     id \n     status \n     remarks{\n      by\n      date\n      edit\n      text\n      title\n    }\n   }\n }\n"]);return Ge=function(){return e},e}function Ze(){var e=Object(S.a)(["\n mutation updateTimeSheet($id: String, $startTime: String , $endTime: String, $station: String, $shift : String, $break: Int, $staff: String, $remarks: [RemarkInput], $handover: String){\n  addToTimeSheet(\n      id: $id\n      startTime: $startTime , \n      endTime: $endTime,\n      station: $station, \n      shift: $shift,  \n      staff: $staff\n      break: $break,\n      remarks:$remarks,\n      handover:$handover,\n  )\n    {\n      id\n      startTime\n      status\n      date\n      endTime\n      break\n      remarks{\n        by\n        date\n        edit\n        text\n        title\n      }\n      staff{\n        id\n        name\n        reqHours\n      }\n      shiftReport {\n        shift\n        id\n        station {\n          id\n          location\n        }\n      }\n\n      shift\n      station{\n        id\n        location\n      }\n\n  } \n  \n\n }\n"]);return Ze=function(){return e},e}function Xe(){var e=Object(S.a)(["\n  mutation signOff($startTime: String!, $break:Int, $endTime:String!, $username: String, $password:String, $idCardCode: String, $additionalAction: String, $id:String, $email: String, $name: String ){\n    signOffTimeSheet(\n      startTime: $startTime, \n      endTime:$endTime, \n      break: $break,\n      username: $username, \n      password: $password , \n      additionalAction: $additionalAction,\n      email: $email,\n      name: $name,\n      idCardCode: $idCardCode\n      id: $id\n      ) {\n        name,\n        value,\n        break,\n        startTime,\n        endTime,\n        id\n      }\n  }"]);return Xe=function(){return e},e}var et=Object(f.gql)(Xe()),tt=Object(f.gql)(Ze()),at=Object(f.gql)(Ge()),nt=Object(f.gql)(We()),rt=Object(f.gql)(Qe()),it=function(e){var t=e.setOpen,a=e.open,l=e.fieldName,c=e.removeClick,o=e.removeStaff,d=e.setRemoveStaff,h=Object(je.f)(),y=h.getFieldMeta,S=h.setFieldValue,C=Object(f.useMutation)(et,{onError:function(e){console.log(e)}}),j=Object(u.a)(C,2),w=j[0],k=j[1],T=k.loading,I=k.error,A=k.data,D=y("".concat(l,".startTime")).value,R=y("".concat(l,".endTime")).value,F=y("".concat(l,".break")).value,$=Object(r.useState)(""),N=Object(u.a)($,2),P=N[0],x=N[1],M=Object(r.useState)(""),H=Object(u.a)(M,2),L=H[0],q=H[1],_=Object(r.useState)(""),B=Object(u.a)(_,2),K=B[0],z=B[1],U=Object(r.useState)(D),V=Object(u.a)(U,2),J=V[0],Q=V[1],W=Object(r.useState)(R),G=Object(u.a)(W,2),Z=G[0],X=G[1],ee=Object(r.useState)(F),te=Object(u.a)(ee,2),ae=te[0],ne=te[1];Object(r.useEffect)((function(){Q(D),X(R)}),[R,D]),Object(r.useEffect)((function(){I&&x({type:"error",message:"Sorry, ".concat(I.message)}),A&&null!=A.signOffTimeSheet&&(o?(c(),d(!1),t(!1)):(S("".concat(l,".startTime"),A.signOffTimeSheet.startTime),S("".concat(l,".endTime"),A.signOffTimeSheet.endTime),S("".concat(l,".signOffKey"),A.signOffTimeSheet.value),t(!1)))}),[I,A]);var re=function(){var e=Object(m.a)(s.a.mark((function e(t){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={startTime:t.startTime,endTime:t.endTime,break:t.breakt,username:L,password:K,additionalAction:o?"remove":"update",id:y("".concat(l)).value.id},console.log(a),e.next=4,w({variables:a});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return T?i.a.createElement(we.a,{active:!0,inverted:!0},i.a.createElement(le.a,{active:!0,inverted:!0},"Verifying")):i.a.createElement(Je.a,{closeIcon:!0,closeOnEscape:!1,closeOnDimmerClick:!1,open:a,onClose:function(){x(!1),t(!1)},onOpen:function(){return t(!0)}},i.a.createElement(Je.a.Header,null,y("".concat(l,".name")).value," "),i.a.createElement(Je.a.Content,null,P&&(P?i.a.createElement(Y.a,{success:"success"===P.type,error:"error"===P.type,onDismiss:function(){return x("")}}," ",P.message):null),i.a.createElement(je.c,{enableReinitialize:!0,initialValues:{startTime:J,endTime:Z,breakt:ae,username:"",password:"",email:"",fullname:"",resetEmail:""},validate:function(e){var t={};return t=Object(n.a)(Object(n.a)({},t),Ke(e.startTime,e.endTime))},onSubmit:function(e){re(e)}},(function(e){e.values;var t=e.handleSubmit;e.errors,e.touched;return i.a.createElement(p.a,{size:"large",onSubmit:t},i.a.createElement(p.a.Group,null,i.a.createElement(De,{label:"Start Time",dateTimeFormat:"DD-MM-YYYY HH:mm",name:"startTime",maxDate:xe(Date.now(),30,"m","sub"),minDate:xe(Date.now(),20,"h","sub"),onChange:function(e,t){var a=t.value;Q(a)}}),i.a.createElement(De,{label:"End Time",dateTimeFormat:"DD-MM-YYYY HH:mm",name:"endTime",maxDate:Pe(Date.now()),minDate:xe(J,20,"m","add"),onChange:function(e,t){var a=t.value;X(a)}}),i.a.createElement(Fe,{inputlabel:"Break",label:"Minutes ",labelPosition:"right corner",name:"breakt",type:"number",min:"0",onChange:function(e,t){var a=t.value;ne(a)}})),i.a.createElement(b.a,{as:"h3",color:"red",textAlign:"center"},o?"Enter credentials to confirm remove.":"Enter credential to save changes"),i.a.createElement(i.a.Fragment,null,i.a.createElement(O.a,null,i.a.createElement(g.a,{columns:2,stackable:!0},i.a.createElement(v.a,{vertical:!0},"Or"),i.a.createElement(g.a.Row,{verticalAlign:"middle"},i.a.createElement(g.a.Column,null,i.a.createElement(g.a.Row,{style:{textAlign:"center"}},i.a.createElement(b.a,{as:"h5",icon:!0},i.a.createElement(de.a,{name:"sign in alternate"}),"Use Credentials")),i.a.createElement(g.a.Row,null,i.a.createElement(p.a.Group,null,i.a.createElement(p.a.Input,{label:"Username",onChange:function(e,t){var a=t.value;return q(a)}}),i.a.createElement(p.a.Input,{label:"Password",type:"password",onChange:function(e,t){var a=t.value;return z(a)}})),i.a.createElement(p.a.Field,{style:{textAlign:"center"}},i.a.createElement(E.a,{type:"submit",primary:!0}," Sign ")))),i.a.createElement(g.a.Column,{textAlign:"center"},i.a.createElement(g.a.Row,null,i.a.createElement(b.a,{icon:!0},i.a.createElement(de.a,{name:"barcode",size:"massive"}),"Use IdCard")),i.a.createElement(g.a.Row,null,i.a.createElement(E.a,{primary:!0},"Scan"))))))))}))))},lt=function(e){var t=e.staff,a=e.fieldName,n=e.values,l=e.index,c=e.remove,o=Object(r.useState)(!1),s=Object(u.a)(o,2),m=s[0],d=s[1],f=Object(r.useState)(!1),g=Object(u.a)(f,2),b=g[0],h=g[1];return t?i.a.createElement(O.a,null,t.signOffKey&&i.a.createElement(ue.a,{attached:"top left",size:"mini",basic:!0,color:"grey"},"Signed Off "),i.a.createElement(p.a.Group,null,i.a.createElement(Fe,{width:4,readOnly:t.signOffKey,name:"".concat(a,".name")}),i.a.createElement(De,{readOnly:t.signOffKey&&!t.changing,maxDate:xe(Date.now(),30,"m","sub"),minDate:xe(Date.now(),20,"h","sub"),name:"".concat(a,".startTime")}),i.a.createElement(De,{readOnly:t.signOffKey&&!t.changing,maxDate:Pe(Date.now()),minDate:xe(n.startTime,20,"m","add"),name:"".concat(a,".endTime")}),i.a.createElement(je.a,{type:"hidden",value:"",name:"".concat(a,".signOffKey")}),i.a.createElement(je.a,{type:"hidden",value:"",name:"".concat(a,".break")}),i.a.createElement(E.a,{style:{height:"fit-content"},type:"button",circular:!0,icon:"cancel",basic:!0,onClick:function(){h(!0),d(!0)}}),i.a.createElement(i.a.Fragment,null,i.a.createElement(E.a,{style:{height:"fit-content"},type:"button",inverted:!0,color:"red",size:"small",onClick:function(){d(!0)}}," Change"))),i.a.createElement(it,{setOpen:d,open:m,startTime:n.staffs[l].startTime,endTime:n.staffs[l].endTime,breakt:n.staffs[l].break,fieldName:a,removeStaff:b,setRemoveStaff:h,removeClick:function(){return c(l)}})):null},ct=function(e){var t=e.values,a=e.addStaffOpen;return i.a.createElement(i.a.Fragment,null,i.a.createElement(je.b,{name:"staffs"},(function(e){var n=e.remove;e.push,e.replace;return i.a.createElement(r.Fragment,null,i.a.createElement(b.a,{as:"h3"},"Staffs"),i.a.createElement(O.a.Group,null,t.staffs.length>0&&t.staffs.map((function(e,a){return i.a.createElement(lt,{key:a,index:a,staff:e,fieldName:"staffs.".concat(a),values:t,remove:n})}))),i.a.createElement(E.a,{type:"button",icon:!0,primary:!0,onClick:function(){return a(!0)}},i.a.createElement(de.a,{name:"plus circle"})," Add "),"  ",i.a.createElement(Ve,{name:"staffs",pointing:"left"}))})))},ot=a(353),st=function(e){var t=e.label,a=e.onRemove,n=e.disabled,l=(e.children,e.name),c=(Object(ke.a)(e,["label","onRemove","disabled","children","name"]),Object(je.f)()),o=c.setFieldValue,s=c.getFieldProps,m=c.setFieldTouched,d=c.getFieldMeta,f=Object(r.useState)(!1),g=Object(u.a)(f,2),b=g[0],h=g[1],O=s("".concat(l,".action")).value,y=s("".concat(l,".status")).value,S=s("".concat(l,".newNote")).value,C=function(e,t){e.preventDefault(),o("".concat(l,".action"),t),b&&!S&&j()},j=function(){if(b){var e=S.trim();h(!1),o("".concat(l,".newNote"),e)}else h(!0)},w=function(){return O&&"NOTES_ADDED"!==O?i.a.createElement("div",{style:{padding:"0.3125em 1.5em"}},i.a.createElement(ue.a,{size:"mini",basic:!0},"Task from previous shifts "),S&&S.trim()&&i.a.createElement(ue.a,{size:"mini",basic:!0,color:"blue",as:"a",onClick:function(){return j()}},"Notes Added "),i.a.createElement(ue.a,{size:"mini",basic:!0,color:"green"},O," "),i.a.createElement(ue.a,{as:"a",size:"mini",basic:!0,color:"yellow",onClick:function(e){return o("".concat(l,".action"),""),void(S&&h(!0))}}," ",i.a.createElement(de.a,{name:"undo"})," Undo Action ")):i.a.createElement("div",{style:{padding:"0.3125em 1.5em"}},i.a.createElement(ue.a,{size:"mini",basic:!0},"Task from previous shifts "),S&&S.trim()&&i.a.createElement(ue.a,{size:"mini",basic:!0,color:"blue"},"Notes Added "),i.a.createElement(ue.a,{size:"mini",basic:!0,color:"purple"},"Open "),n&&"DEFERRED"===y&&i.a.createElement(ue.a,{size:"mini",basic:!0,color:"red"},"Action Required "))};return i.a.createElement(i.a.Fragment,null,i.a.createElement(v.a,null),n&&i.a.createElement(w,null),i.a.createElement(p.a.Group,{style:{marginBottom:"0px"}},i.a.createElement("label",{style:{display:"inline-block",padding:"0.9375em 0px 0px 0.3125em",width:"1.5625em"}},t+1),i.a.createElement(Ne,{name:"".concat(l,".description"),readOnly:n,rows:"1",width:"16"}),i.a.createElement(E.a,{type:"button",circular:!0,icon:"cancel",style:{visibility:n?"hidden":"",height:"fit-content"},basic:!0,onClick:function(e){return function(e){e.preventDefault(),a()}(e)}})),!n&&i.a.createElement("div",{style:{padding:"0.5em 1.5em"}},i.a.createElement(Ve,{name:"".concat(l,".action"),pointing:"below"}),i.a.createElement(p.a.Group,null,i.a.createElement(p.a.Checkbox,{checked:"CLOSED"===O,label:"closed",onChange:function(e,t){return function(e,t){m("".concat(l,".description"),!0),d("".concat(l,".description")).error?m("".concat(l,".description")):o("".concat(l,".action"),t?"CLOSED":"")}(0,t.checked)}}),i.a.createElement(p.a.Checkbox,{checked:"DEFERRED"===O||"OPEN"===O,label:"Is Open Task",onChange:function(e,t){return function(e,t){m("".concat(l,".description"),!0),d("".concat(l,".description")).error?m("".concat(l,".description")):o("".concat(l,".action"),t?"OPEN":"")}(0,t.checked)}}),i.a.createElement(p.a.Checkbox,{label:"Action Required",checked:"DEFERRED"===O,onChange:function(e,t){return function(e,t){m("".concat(l,".description"),!0),d("".concat(l,".description")).error?m("".concat(l,".description")):o("".concat(l,".action"),t?"DEFERRED":"OPEN")}(0,t.checked)}}))),n&&"CLOSED"!==O&&"DEFERRED"!==O&&i.a.createElement("div",{style:{margin:"0px 3.125em 0.625em 1.5em"}},i.a.createElement(ot.a,{panels:[{key:"panel-1",title:"Updates",content:"These are updates"}]}),i.a.createElement(Ve,{name:"".concat(l,".action"),pointing:"below"}),i.a.createElement("div",null,i.a.createElement(E.a,{size:"mini",type:"button",onClick:function(e){return j(e)}}," ",b?"Hide Notes":S?"Show Notes":"Add Notes"),i.a.createElement(E.a.Group,{size:"mini"},i.a.createElement(E.a,{type:"button",size:"mini",positive:!0,value:"CLOSED",onClick:function(e,t){var a=t.value;return C(e,a)}},"Close Task"),i.a.createElement(E.a.Or,{size:"mini"}),i.a.createElement(E.a,{type:"button",size:"mini",negative:!0,value:"DEFERRED",onClick:function(e,t){var a=t.value;return C(e,a)}}," Defer Task to next Shift")))),i.a.createElement(Ne,{rows:"1",readOnly:!(!O||"NOTES_ADDED"===O),hidden:!b,style:{paddingBotton:"0.3125em",margin:"0px 3.125em 0.625em 1.5em"},name:"".concat(l,".newNote"),width:"14",onChange:function(e,t){var a=t.value;""!==a.trim()?(o("".concat(l,".newNote"),a),O||o("".concat(l,".action"),"NOTES_ADDED")):(o("".concat(l,".newNote"),""),"NOTES_ADDED"===O&&o("".concat(l,".action"),""))}}))},mt=function(e){var t=e.tasksIdentifier,a=e.tasks,n=e.taskCategory,r=e.onRemove,l=e.aircraftId;return i.a.createElement(je.b,{name:"tasks.".concat(t)},(function(e){var c=e.push,o=e.remove;return i.a.createElement(i.a.Fragment,null,a&&a.map((function(e,a){return i.a.createElement(st,{key:a,label:a,name:"tasks.".concat(t,".").concat(a),disabled:e.id&&("DEFERRED"===e.status||"OPEN"===e.status),onRemove:function(){r&&r(),o(a)}})})),i.a.createElement(E.a,{type:"button",icon:!0,style:{marginLeft:"10px"},primary:!0,onClick:function(e){return c(function(){var e={description:"",status:"",action:"",taskCategory:t};return n&&"AIRCRAFT"===n&&(e.aircraft=l,e.taskCategory=n),e}())}},i.a.createElement(de.a,{name:"plus circle"})," Add"))}))},ut=function(e){var t=e.costumers,a=e.setCheckedAircrafts,l=e.checkedAircrafts,c=e.values,o=Object(je.f)().setFieldValue,s=Object(r.useState)({open:!1,aircraft:"",event:""}),m=Object(u.a)(s,2),d=m[0],f=m[1];return i.a.createElement(i.a.Fragment,null,t&&t.map((function(e){return i.a.createElement(r.Fragment,{key:e.name},i.a.createElement(b.a,{as:"h3"},"Work Performed for ",e.name),e.aircrafts.map((function(e){return i.a.createElement(r.Fragment,{key:e.id},i.a.createElement($e,{label:e.registration,checked:l[e.registration]&&l[e.registration].checked,disabled:l[e.registration]&&l[e.registration].disbleCheck,onChange:function(t,r){var i=r.checked;t.preventDefault(),!i||c.tasks[e.registration]&&0!==c.tasks[e.registration].length||(a(Object(n.a)(Object(n.a)({},l),{},Object(Ce.a)({},e.registration,{checked:i}))),o("tasks.".concat(e.registration),[{description:"",status:"",action:"",taskCategory:"AIRCRAFT",aircraft:e.id}])),i||c.tasks[e.registration].length>0&&f({open:!0,aircraft:e.registration})}},i.a.createElement(ce.a,{open:d.open,header:"Uncheck Aircraft ".concat(d.aircraft),content:"Are you sure you want to uncheck this aircraft? Doing so will remove all the entered tasks for this Aircraft",onCancel:function(){f({open:!1})},onConfirm:function(){console.log("called me"),o("tasks.".concat(d.aircraft),null),a(Object(n.a)(Object(n.a)({},l),{},Object(Ce.a)({},d.aircraft,{checked:!1}))),f({open:!1})}}),l[e.registration]&&l[e.registration].checked&&i.a.createElement(mt,{tasksIdentifier:e.registration,tasks:c.tasks[e.registration],taskCategory:"AIRCRAFT",aircraftId:e.id,onRemove:function(){1===c.tasks[e.registration].length&&a(Object(n.a)(Object(n.a)({},l),{},Object(Ce.a)({},e.registration,{checked:!1})))}})))})))})))},dt=a(227),ft=a(39),pt=function(e){var t=e.setOpen,a=e.open,l=(e.e,Object(je.f)()),c=l.getFieldMeta,o=l.setFieldValue,d=Object(f.useMutation)(et,{onError:function(e){console.log(e)}}),h=Object(u.a)(d,2),y=h[0],S=h[1],C=S.loading,j=S.error,w=S.data,k=c("startTime").value,T=c("endTime").value,I=Object(r.useState)(""),A=Object(u.a)(I,2),D=A[0],R=A[1],F=Object(r.useState)(""),$=Object(u.a)(F,2),N=$[0],P=$[1],x=Object(r.useState)(""),M=Object(u.a)(x,2),H=M[0],L=M[1],q=Object(r.useState)(k),_=Object(u.a)(q,2),B=_[0],K=_[1],z=Object(r.useState)(T),V=Object(u.a)(z,2),J=V[0],Q=V[1],W=Object(r.useState)("30"),G=Object(u.a)(W,2),Z=G[0],X=G[1],ee=Object(r.useState)(!1),te=Object(u.a)(ee,2),ae=te[0],ne=te[1],re=Object(r.useState)(!1),ie=Object(u.a)(re,2),ce=ie[0],oe=ie[1];Object(r.useEffect)((function(){K(k),Q(T)}),[T,k]),Object(r.useEffect)((function(){if(j&&(ae&&R({type:"error",message:"Failed to register user. ".concat(j.message)}),R(ce?{type:"error",message:"Failed to reset password. ".concat(j.message)}:{type:"error",message:"Failed to add user. ".concat(j.message)})),w&&null!=w.signOffTimeSheet){var e=c("staffs").value;if(pe.a.find(e,{id:w.signOffTimeSheet.id}))R({type:"error",message:"".concat(w.signOffTimeSheet.name," is already exist on report")});else{var t=[].concat(Object(U.a)(e),[{name:w.signOffTimeSheet.name,startTime:w.signOffTimeSheet.startTime,endTime:w.signOffTimeSheet.endTime,signOffKey:w.signOffTimeSheet.value,id:w.signOffTimeSheet.id,break:w.signOffTimeSheet.break}]);o("staffs",t),ae&&(R({type:"success",message:"".concat(w.signOffTimeSheet.name," is added to report.<br/> Further registration instruction sent to email. Please complete registration within 48 hours")}),ne(!1)),ce?(R({type:"success",message:"".concat(w.signOffTimeSheet.name," is added to report <br/> Password reset link sent to email.")}),oe(!1)):R({type:"success",message:"".concat(w.signOffTimeSheet.name," is added to report")})}}}),[j,w]);var se=function(){var e=Object(m.a)(s.a.mark((function e(t){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=ae?{startTime:t.startTime,endTime:t.endTime,break:parseInt(Z),email:t.email,name:t.fullname,additionalAction:"register"}:ce?{startTime:t.startTime,endTime:t.endTime,break:parseInt(Z),email:t.resetEmail,additionalAction:"reset"}:{startTime:t.startTime,endTime:t.endTime,break:parseInt(Z),username:N,password:H},console.log(a),e.next=4,y({variables:a});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return C?i.a.createElement(we.a,{active:!0,inverted:!0},i.a.createElement(le.a,{active:!0,inverted:!0},"Veryfing User")):i.a.createElement(Je.a,{closeIcon:!0,closeOnEscape:!1,closeOnDimmerClick:!1,open:a,onClose:function(){oe(!1),ne(!1),R(!1),t(!1)},onOpen:function(){return t(!0)}},i.a.createElement(Je.a.Header,null,"Add User to Shift "),i.a.createElement(Je.a.Content,null,D&&(D?i.a.createElement(Y.a,{success:"success"===D.type,error:"error"===D.type,onDismiss:function(){return R("")}}," ",D.message):null),i.a.createElement(je.c,{enableReinitialize:!0,initialValues:{startTime:B,endTime:J,breakt:Z,username:"",password:"",email:"",fullname:"",resetEmail:""},validate:function(e){var t={};if(t=Object(n.a)(Object(n.a)({},t),Ke(e.startTime,e.endTime)),ce){var a=Ue(e.resetEmail);a&&(t.resetEmail=a)}if(ae){var r=Ue(e.email);r&&(t.email=r);var i=Ye(e.fullname);i&&(t.fullname=i)}return console.log(t),t},onSubmit:function(e){console.log(e,"submitted"),se(e)}},(function(e){e.values;var t=e.handleSubmit;e.errors,e.touched;return i.a.createElement(p.a,{size:"large",onSubmit:t},i.a.createElement(p.a.Group,null,i.a.createElement(De,{label:"Start Time",dateTimeFormat:"DD-MM-YYYY HH:mm",name:"startTime",maxDate:xe(Date.now(),30,"m","sub"),minDate:xe(Date.now(),20,"h","sub"),onChange:function(e,t){var a=t.value;K(a)}}),i.a.createElement(De,{label:"End Time",dateTimeFormat:"DD-MM-YYYY HH:mm",name:"endTime",maxDate:Pe(Date.now()),minDate:xe(B,20,"m","add"),onChange:function(e,t){var a=t.value;Q(a)}}),i.a.createElement(Fe,{inputlabel:"Break",label:"Minutes ",labelPosition:"right corner",name:"breakt",type:"number",min:"0",onChange:function(e,t){var a=t.value;X(a)}})),i.a.createElement(b.a,{as:"h5",color:"blue",textAlign:"center"}),!ae&&!ce&&i.a.createElement(i.a.Fragment,null,i.a.createElement(O.a,null,i.a.createElement(g.a,{columns:2,stackable:!0},i.a.createElement(v.a,{vertical:!0},"Or"),i.a.createElement(g.a.Row,{verticalAlign:"middle"},i.a.createElement(g.a.Column,null,i.a.createElement(g.a.Row,{style:{textAlign:"center"}},i.a.createElement(b.a,{as:"h5",icon:!0},i.a.createElement(de.a,{name:"sign in alternate"}),"Use Credentials")),i.a.createElement(g.a.Row,null,i.a.createElement(p.a.Group,null,i.a.createElement(p.a.Input,{label:"Username",onChange:function(e,t){var a=t.value;return P(a)}}),i.a.createElement(p.a.Input,{label:"Password",type:"password",onChange:function(e,t){var a=t.value;return L(a)}})),i.a.createElement(p.a.Field,{style:{textAlign:"center"}},i.a.createElement(E.a,{type:"submit",primary:!0}," Sign ")),i.a.createElement(p.a.Field,{style:{textAlign:"center"}},i.a.createElement(E.a,{size:"tiny",onClick:function(){return oe(!0)}},"Forgot Password")))),i.a.createElement(g.a.Column,{textAlign:"center"},i.a.createElement(g.a.Row,null,i.a.createElement(b.a,{icon:!0},i.a.createElement(de.a,{name:"barcode",size:"massive"}),"Use IdCard")),i.a.createElement(g.a.Row,null,i.a.createElement(E.a,{primary:!0},"Scan")))))),i.a.createElement(ft.a,{style:{textAlign:"center"}},i.a.createElement("label",null," If you do not have a account yet, contact your supervisor or click below."),i.a.createElement(E.a,{type:"button",onClick:function(){return ne(!0)}}," New User "))),ae&&i.a.createElement(O.a,{basic:!0},i.a.createElement(Y.a,{positive:!0},i.a.createElement(Y.a.Header,null,"Register info"),"Please enter following information to add yourself to shift . Registraion instruction will be forwarded to you on the provided email. It is important that you register as soon as possible."),i.a.createElement(Y.a,{warning:!0,visible:!0},i.a.createElement(Y.a.Header,null,"Attention!!"),"Your info will be added to report automatically after this step, make sure you enter your name and work time correctly"),i.a.createElement(p.a.Group,null,i.a.createElement(Fe,{width:"12",name:"fullname",label:"Full Name"}),i.a.createElement(Fe,{width:"12",name:"email",label:"Email Address"})),i.a.createElement(dt.a,null,i.a.createElement(E.a,{positive:!0},"Register"),i.a.createElement(E.a,{type:"button",negative:!0,onClick:function(){return ne(!1)}},"Cancel"))),ce&&i.a.createElement(O.a,{basic:!0},i.a.createElement(Y.a,{warning:!0,visible:!0},i.a.createElement(Y.a.Header,null,"Reset Password"),"Please enter your email address used while creating account."),i.a.createElement(Y.a,{warning:!0,visible:!0},i.a.createElement(Y.a.Header,null,"Attention!!"),"Your info will be added to report automatically after this step, make sure you ",i.a.createElement("strong",null,"Enter your work time correctly")),i.a.createElement(Fe,{width:"12",name:"resetEmail",label:"Email Address"}),i.a.createElement(dt.a,null,i.a.createElement(E.a,{primary:!0},"Reset"),i.a.createElement(E.a,{negative:!0,onClick:function(){return oe(!1)}},"Cancel"))))}))))};function Et(){var e=Object(S.a)(["\n  mutation submitReport($station: String!, $shift:String! , $startTime: String! ,$endTime: String!, $tasks: [ShiftReportTask]! , $staffs: [ShiftReportStaffs!]! ) { \n  submitShiftReport(\n    station:$station\n    shift:$shift\n    startTime: $startTime\n    endTime: $endTime\n    tasks:$tasks\n    staffs: $staffs\n  ){\n    endTime\n    id\n    shift\n    staffAndTime {\n      id\n      staff {\n        name\n      }\n      endTime\n      startTime\n    }\n    startTime\n    station {\n      location\n      id\n    }\n    tasks {\n      aircraft {\n        registration\n        id\n        costumer {\n          name\n        }\n      }\n      taskCategory\n      description\n      id\n      status\n      updates {\n        action\n        handoverId {\n          id\n          shift\n        }\n        note\n      }\n      \n    }\n  } \n}\n"]);return Et=function(){return e},e}var gt=Object(f.gql)(Et()),bt=function(e){var t=e.setActiveItem,a=Object(r.useContext)(ve),l=Object(r.useContext)(Q),c=Object(u.a)(l,2)[1],o=a.state.station,s=a.state.lastShiftReport,m=Object(r.useState)(!1),d=Object(u.a)(m,2),g=d[0],h=d[1],y=Object(r.useState)(o.costumers),v=Object(u.a)(y,2),S=v[0],C=v[1],j=Object(r.useState)({}),w=Object(u.a)(j,2),k=w[0],T=w[1],I=Object(r.useState)({startTime:"",endTime:"",staffs:[],tasks:{}}),A=Object(u.a)(I,2),D=A[0],R=A[1],F=Object(f.useMutation)(gt,{update:function(e,t){var a={getShiftReport:t.data.submitShiftReport};e.writeQuery({query:ne,variables:{station:o.id,flag:"MOST_RECENTLY_COMPLETED"},data:a}),console.log(t,a)},onCompleted:function(){t("lastShiftReport")},onError:function(e){c({type:"ADD_NOTIFICATION",payload:{content:e.message,type:"ERROR"}})}}),$=Object(u.a)(F,2),N=$[0],P=$[1].loading,x=function(e){var t=new Date(Me(e));return o.shifts.reduce((function(e,a){var n=a.startTime.split(":"),r=new Date(t);r.setHours(n[0]),r.setMinutes(n[1]);var i=(t-r)/36e5;return i>e.diff&&e.diff<0||i>0&&i<e.diff?{name:a.name,diff:i}:e}),{name:"",diff:-24}).name};Object(r.useEffect)((function(){var e={},t={},a=[];s&&s.tasks&&s.tasks.map((function(r){if("DEFERRED"===r.status||"OPEN"===r.status){var i={id:r.id,description:r.description,status:r.status,updates:r.updates,action:"",newNote:"",taskCategory:r.taskCategory};r.aircraft&&(e[r.aircraft.registration]={checked:!0,disbleCheck:!0}),r.aircraft&&t[r.aircraft.registration]?t[r.aircraft.registration].push(Object(n.a)({},i)):r.aircraft?t[r.aircraft.registration]=[Object(n.a)({},i)]:t[r.taskCategory]?t[r.taskCategory].push(i):t[r.taskCategory]=[i],r.aircraft&&(pe.a.find(o.costumers,pe.a.matchesProperty("name",r.aircraft.costumer.name))||(pe.a.find(a,pe.a.matchesProperty("name",r.aircraft.costumer.name))?a.aircrafts.push({registration:r.aircraft.registration,id:r.aircraft.id}):a.push({name:r.aircraft.costumer.name,aircrafts:[{registration:r.aircraft.registration,id:r.aircraft.id}]})))}})),C([].concat(Object(U.a)(S),a)),R(Object(n.a)(Object(n.a)({},D),{},{tasks:t})),T(e)}),[]);return P?i.a.createElement(O.a,{style:{height:"10rem"},basic:!0,size:"huge"},i.a.createElement(we.a,{active:!0,inverted:!0},i.a.createElement(le.a,{inverted:!0},"Submitting Data"))):i.a.createElement(i.a.Fragment,null,i.a.createElement(je.c,{enableReinitialize:!0,initialValues:D,validate:function(e){var t={};t=Object(n.a)(Object(n.a)({},t),Ke(e.startTime,e.endTime));var a=function(e){var t;return e&&e.length?(e&&e.length&&(t=pe.a.mapValues(e,(function(e){var t=Be(e);return pe.a.isEmpty(t)?(e.signOffKey||(t=Object(n.a)(Object(n.a)({},t),{},{signOffKey:"Each staff must sign off"})),t):t=Object(n.a)(Object(n.a)({},t),{},{signOffKey:"Please fix staff inputs"})}))),pe.a.mapKeys(t,(function(e,a){pe.a.isEmpty(e)&&delete t[a]})),t):t="Report must have staff information, please add staff"}(e.staffs),r=function(e){if(!e)return null;var t=pe.a.mapValues(e,(function(e){var t=pe.a.mapValues(e,(function(e){return ze(e)}));return pe.a.pickBy(t,pe.a.identity)}));return pe.a.mapKeys(t,(function(e,a){pe.a.isEmpty(e)&&delete t[a]})),t}(e.tasks);return pe.a.isEmpty(r)||(t.tasks=r),pe.a.isEmpty(a)||(t.staffs=a),t},onSubmit:function(e){var t=function(e){var t={station:o.id,staffs:e.staffs,startTime:e.startTime,endTime:e.endTime,tasks:{}},a=pe.a.reduce(e.tasks,(function(e,t,a){var r=pe.a.map(t,(function(e,t){var r;if(D.tasks[a]&&D.tasks[a][t]){r=D.tasks[a]&&D.tasks[a][t];var i=Object.keys(r).filter((function(t){return r[t]!==e[t]}));if(!i)return null;var l=i.reduce((function(t,a){return t[a]=Object(n.a)(Object(n.a)({},t),{},Object(Ce.a)({},a,e[a]))}),{});e=Object(n.a)({id:e.id},l)}return e}));return r=r.filter((function(e){return null!==e})),[].concat(Object(U.a)(e),Object(U.a)(r))}),[]),r=e.staffs.map((function(e){return{signOffKey:e.signOffKey,name:e.name}}));return t=Object(n.a)(Object(n.a)({},t),{},{tasks:a,staffs:r,shift:x(e.startTime)})}(e);N({variables:t})}},(function(e){var t=e.values,a=e.handleSubmit,n=e.errors,r=e.touched,l=e.submitCount;return i.a.createElement(i.a.Fragment,null,i.a.createElement(p.a,{onSubmit:a},i.a.createElement(p.a.Group,null,i.a.createElement(De,{label:"Shift Start Time",name:"startTime",maxDate:xe(Date.now(),30,"m","sub"),minDate:xe(Date.now(),20,"h","sub")}),i.a.createElement(De,{label:"Shift End Time",name:"endTime",maxDate:Pe(Date.now()),minDate:xe(t.startTime,20,"m","add")})),i.a.createElement(ct,{values:t,touched:r,errors:n,addStaffOpen:h}),i.a.createElement(ut,{costumers:S,checkedAircrafts:k,setCheckedAircrafts:T,values:t}),i.a.createElement(b.a,{as:"h3"},"Other Tasks"),i.a.createElement(mt,{tasksIdentifier:"OTHER",tasks:t.tasks.OTHER}," "),i.a.createElement(b.a,{as:"h3"},"Logistics Task"),i.a.createElement(mt,{tasksIdentifier:"LOGISTICS",tasks:t.tasks.LOGISTICS}," "),i.a.createElement(Y.a,{error:!0,content:i.a.createElement(b.a,{as:"h5"},"There are some errors on the report ",i.a.createElement(b.a.Subheader,null,"Please fix the errors before trying again")),visible:!0===(!pe.a.isEmpty(n)&&l>0)}),i.a.createElement(Y.a,{success:!0,content:i.a.createElement(b.a,{as:"h5"},"Great! Everything seems to be fixed ",i.a.createElement(b.a.Subheader,null,"Please, proceed to submit whenever ready")),visible:!0===(pe.a.isEmpty(n)&&l>0)}),i.a.createElement(O.a,{disabled:!pe.a.isEmpty(n)&&l>0,color:"blue",inverted:!0,tertiary:!0,clearing:!0},i.a.createElement(E.a,{floated:"right",type:"submit",primary:!0}," Submit Report ")," ")),i.a.createElement(pt,{setOpen:h,open:g,shiftStartTime:t.startTime,shiftEndTime:t.endTime}))})))},ht=a(667),Ot=function(e){var t=e.openReport,a=e.setOpenReport,r=Object(f.useLazyQuery)(ne),l=Object(u.a)(r,2),c=l[0],o=l[1],s=o.error,m=o.loading,d=o.data;return i.a.createElement(Je.a,{onClose:function(){return a({id:"",open:!1})},onMount:function(){t.id?c({variables:{id:t.id}}):a(Object(n.a)(Object(n.a)({},t),{},{id:"",open:!1}))},open:t.open},s&&i.a.createElement(i.a.Fragment,null,i.a.createElement(Je.a.Content,null," ",i.a.createElement(b.a,{as:"h5"},"Oouch...Something Went Wrong, Please try again")," ")),m&&i.a.createElement(le.a,{active:!0},"Retriving Report"),d&&d.getShiftReport&&i.a.createElement(i.a.Fragment,null,i.a.createElement(Je.a.Header,null,"Shift Report: ",d.getShiftReport.startTime.split(" ")[0]," ",d.getShiftReport.station.location," ",d.getShiftReport.shift," shift"),i.a.createElement(Je.a.Content,null,i.a.createElement(ye,{reportData:d.getShiftReport}," "))))},yt=function(){var e,t=Object(r.useContext)(ve).state.station,a=Object(f.useQuery)(re,{variables:{stationId:t.id}}),n=a.error,l=a.loading,c=a.data,o=Object(r.useState)({id:"",open:!1}),s=Object(u.a)(o,2),m=s[0],d=s[1];return c&&(e=c.getReportList,e=pe.a.groupBy(e,(function(e){return e.startTime.split(" ")[0]})),e=pe.a.mapValues(e,(function(e){return pe.a.groupBy(e,(function(e){return e.station.location}))}))),l?i.a.createElement(le.a,{active:!0},"Initiatilizing reporting"):n?(console.log(n),i.a.createElement(b.a,{as:"h5"},"Something Went Wrong, Please try again")):i.a.createElement(i.a.Fragment,null,i.a.createElement(he.a,{compact:!0,celled:!0,striped:!0,structured:!0},i.a.createElement(he.a.Header,null,i.a.createElement(he.a.Row,null,i.a.createElement(he.a.HeaderCell,null," Date "),i.a.createElement(he.a.HeaderCell,{textAlign:"center"}," Station "),i.a.createElement(he.a.HeaderCell,null," Shift "))),i.a.createElement(he.a.Body,null,e&&pe.a.map(e,(function(t,a){return i.a.createElement(r.Fragment,{key:a},Object.entries(t).map((function(t,n){var r=Object(u.a)(t,2),l=r[0],c=r[1];return i.a.createElement(he.a.Row,{key:l},0===n&&i.a.createElement(he.a.Cell,{collapsing:!0,rowSpan:Object.keys(e[a]).length},a),i.a.createElement(he.a.Cell,{textAlign:"center"},l),i.a.createElement(he.a.Cell,null,i.a.createElement(ht.a,{horizontal:!0},pe.a.map(c,(function(e){return i.a.createElement(ht.a.Item,{as:"a",key:e.id,onClick:function(){d({id:e.id,open:!0})}},e.shift)})))))})))})))),i.a.createElement(Ot,{setOpenReport:d,openReport:m}))},vt=a(24),St=a(665),Ct=a(174),jt=a(175),wt=a(618),kt=a(239);function Tt(){var e=Object(S.a)(["\nmutation deleteCostumer( $costumer: String){\n  deleteCostumer(\n    costumer: $costumer\n    ){\n      status\n      message\n    }\n}"]);return Tt=function(){return e},e}function It(){var e=Object(S.a)(["\nmutation removeStationCostumer( $station: String! , $costumer: String){\n  removeCostumerStation(\n    station: $station\n    costumer: $costumer\n    ){\n      status\n      message\n    }\n}"]);return It=function(){return e},e}function At(){var e=Object(S.a)(["\nmutation removeContactCostumer( $id: String! , $costumer: String){\n  removeContact(\n    id: $id\n    costumer: $costumer\n    ){\n      status\n      message\n    }\n}"]);return At=function(){return e},e}function Dt(){var e=Object(S.a)(["\nmutation removeAircraft( $id: String!){\n  removeAircraft(\n    id: $id\n    ){\n      status\n      message\n    }\n}"]);return Dt=function(){return e},e}function Rt(){var e=Object(S.a)(["\nmutation addStationCostumer( $stations: [String!]! , $costumer: String){\n  addStationsToCostumer(\n    stations: $stations\n    costumer: $costumer\n    ){\n      id\n      stations{\n        id\n        location\n      }\n    }\n}"]);return Rt=function(){return e},e}function Ft(){var e=Object(S.a)(["\nmutation addContactCostumer( $keyContacts: [ContactInput!]! , $costumer: String!){\n  addContact(\n    keyContacts: $keyContacts\n    costumer: $costumer\n    ){      \n        id\n        description\n        email\n        phone   \n    }\n}"]);return Ft=function(){return e},e}function $t(){var e=Object(S.a)(["\nmutation addAircrafttoCostumer( $registration: [String!]! $costumer: String!){\n  addAircrafts(\n    registration: $registration\n    costumer: $costumer\n    ){\n      id\n      registration\n    }\n}"]);return $t=function(){return e},e}function Nt(){var e=Object(S.a)(["\nmutation addnewCostumer( $name: String! $stations: [String], $keyContacts: [ContactInput], $contract: String! ,$aircrafts: [String]){\n  addCostumer(\n    name: $name\n    stations: $stations\n    keyContacts: $keyContacts\n    aircrafts: $aircrafts\n    contract: $contract){\n      name\n      id\n      contract\n      aircrafts{\n        id\n        registration\n      }\n      stations{\n        id\n      }\n    }\n}"]);return Nt=function(){return e},e}var Pt=Object(f.gql)(Nt()),xt=Object(f.gql)($t()),Mt=Object(f.gql)(Ft()),Ht=Object(f.gql)(Rt()),Lt=Object(f.gql)(Dt()),qt=Object(f.gql)(At()),_t=Object(f.gql)(It()),Bt=Object(f.gql)(Tt());function Kt(){var e=Object(S.a)([" \nquery getCostumerId ($id:String){\n  getCostumer(\n    id:$id\n  ){\n    name\n    id \n    stations{\n      id\n      location\n      address{\n        street\n        postcode\n        city\n        country\n      }\n    }\n    aircrafts{\n      id\n      registration\n    }\n    contract\n    keyContacts{\n      id\n      phone\n      description\n      email\n    }\n\n\n  }\n}\n\n"]);return Kt=function(){return e},e}function zt(){var e=Object(S.a)(["\nquery fetchAllCostumers ($detailed: Boolean = false) {\n    allCostumers {\n      name\n      id\n      stations  @include(if: $detailed) {\n        id\n        location\n      }\n      contract @include(if: $detailed)\n      aircrafts @include(if: $detailed) {\n        id\n        registration\n      }\n    }\n  }\n"]);return zt=function(){return e},e}var Ut=Object(f.gql)(zt()),Yt=Object(f.gql)(Kt()),Vt=function(e){var t=e.confirm,a=e.setOpen,n=e.open;return i.a.createElement(Je.a,{open:n,closeOnEscape:!1,closeOnDimmerClick:!1},i.a.createElement(Je.a.Header,null,"Confirm"),i.a.createElement(Je.a.Content,null,t.title),i.a.createElement(Je.a.Actions,null,i.a.createElement(E.a,{positive:!0,onClick:function(){t.fn(),a(!1)}},"Confirm "),i.a.createElement(E.a,{negative:!0,onClick:function(){return a(!1)}},"Cancel ")))};function Jt(){var e=Object(S.a)(["\n                fragment NewAircraft on Aircraft {\n                  id\n                  registration\n                }\n              "]);return Jt=function(){return e},e}var Qt=function(e){var t=e.open,a=e.setOpen,n=e.costumer,l=Object(r.useContext)(Q),c=Object(u.a)(l,2)[1],o=Object(f.useMutation)(xt,{update:function(e,t){var a=t.data.addAircrafts;e.modify({id:"Costumer:".concat(n.id),fields:{aircrafts:function(t,n){var r=n.readField,i=[];return Object(fe.forEach)(a,(function(n,l){t.some((function(e){return r("id",e)!==n.id}))&&i.push(e.writeFragment({data:a[l],fragment:Object(f.gql)(Jt())}))})),[].concat(Object(U.a)(t),i)}}})},onCompleted:function(e){var t=e.addAircrafts;c({type:"ADD_NOTIFICATION",payload:{content:"Success, aircrafts ".concat(t.reduce((function(e,t){return e+t.registration+", "}),""),"  added"),type:"SUCCESS"}}),a(!1)},onerror:function(e){c({type:"ADD_NOTIFICATION",payload:{content:i.a.createElement(i.a.Fragment,null,"Error, failed to add aircrafts",i.a.createElement("br",null)," ",e.message),type:"ERROR"}}),a(!1)}}),s=Object(u.a)(o,1)[0];return i.a.createElement(je.c,{initialValues:{aircrafts:[]},validate:function(e){var t={};if(e.aircrafts.length){var a=[];Object(fe.forEach)(e.aircrafts.split(","),(function(e){e.trim().length<3&&a.push(e.toUpperCase())})),a.length&&(t.aircrafts="".concat(a.toString()," invalid Aircraft Registration, should at least 3 characters"))}else t.aircrafts="Enter at least one Aircraft";return t},onSubmit:function(e){var t=e.aircrafts.toUpperCase().split(",");s({variables:{registration:t,costumer:n.id}})}},(function(e){var n=e.handleSubmit;return i.a.createElement(Je.a,{open:t,closeOnEscape:!1,closeOnDimmerClick:!1},i.a.createElement(Je.a.Header,null,"Select Stations to Add"),i.a.createElement(Je.a.Content,null,i.a.createElement(p.a,null,i.a.createElement(Fe,{name:"aircrafts",label:"Aircrafts",type:"text",width:"8",placeholder:'Aircrfat Registrations separeted by comma ","'}))),i.a.createElement(Je.a.Actions,null,i.a.createElement(E.a,{type:"submit",positive:!0,onClick:function(e){e.preventDefault(),n()}}," Add "),i.a.createElement(E.a,{type:"button",negative:!0,onClick:function(){return a(!1)}}," Cancel ")))}))};function Wt(){var e=Object(S.a)(["\n                fragment NewContact on Contact {\n                  id\n                  email\n                  phone\n                  description\n                }\n              "]);return Wt=function(){return e},e}var Gt=function(e){var t=e.open,a=e.setOpen,l=e.costumer,c=Object(r.useContext)(Q),o=Object(u.a)(c,2)[1],s=Object(f.useMutation)(Mt,{update:function(e,t){var a=t.data.addContact;e.modify({id:"Costumer:".concat(l.id),fields:{keyContacts:function(t,n){var r=n.readField,i=[];return Object(fe.forEach)(a,(function(a){t.some((function(e){return r("id",e)!==a.id}))&&i.push(e.writeFragment({data:a,fragment:Object(f.gql)(Wt())}))})),[].concat(Object(U.a)(t),i)}}})},onCompleted:function(e){e.addContact;o({type:"ADD_NOTIFICATION",payload:{content:"Success, contacts added",type:"SUCCESS"}}),a(!1)},onerror:function(e){o({type:"ADD_NOTIFICATION",payload:{content:i.a.createElement(i.a.Fragment,null,"Error, failed to add contacts",i.a.createElement("br",null)," ",e.message),type:"ERROR"}}),a(!1)}}),m=Object(u.a)(s,1)[0];return i.a.createElement(je.c,{initialValues:{keyContacts:[{description:"",phone:"",email:""}]},validate:function(e){var t={};return e.keyContacts.length&&Object(fe.forEach)(e.keyContacts,(function(e,a){e.description||(t.keyContacts||(t.keyContacts=[]),t.keyContacts[a]||(t.keyContacts[a]={}),t.keyContacts[a].description="Please provide contact description"),e.phone||e.email||(t.keyContacts||(t.keyContacts=[]),t.keyContacts[a]||(t.keyContacts[a]={}),t.keyContacts[a].phone="At least a phone or a email is required",t.keyContacts[a].email="At least a phone or a email is required"),e.email&&Ue(e.email)&&(t.keyContacts||(t.keyContacts=[]),t.keyContacts[a]||(t.keyContacts[a]={}),t.keyContacts[a].email="Invalid Email")})),t},onSubmit:function(e){m({variables:Object(n.a)(Object(n.a)({},e),{},{costumer:l.id})})}},(function(e){var n=e.handleSubmit,l=e.values;return i.a.createElement(Je.a,{open:t,closeOnEscape:!1,closeOnDimmerClick:!1},i.a.createElement(Je.a.Header,null,"Select Stations to Add"),i.a.createElement(Je.a.Content,null,i.a.createElement(p.a,null,i.a.createElement(je.b,{name:"keyContacts"},(function(e){var t=e.push,a=e.remove;return i.a.createElement(i.a.Fragment,null,l.keyContacts.length>0&&l.keyContacts.map((function(e,t){return i.a.createElement(r.Fragment,{key:t},i.a.createElement(p.a.Group,{style:{margin:0},widths:"13"},i.a.createElement(Fe,{name:"keyContacts[".concat(t,"].description"),label:"Description"}),i.a.createElement(Fe,{name:"keyContacts[".concat(t,"].phone"),label:"Phone"}),i.a.createElement(Fe,{name:"keyContacts[".concat(t,"].email"),label:"Email"}),0!==t&&i.a.createElement(de.a,{link:!0,name:"cancel",color:"red",onClick:function(){return a(t)}})))})),i.a.createElement(E.a,{style:{marginTop:"1rem"},type:"button",circular:!0,icon:!0,size:"mini",primary:!0,onClick:function(){return t({description:"",phone:"",email:""})}},i.a.createElement(de.a,{name:"plus"})))})))),i.a.createElement(Je.a.Actions,null,i.a.createElement(E.a,{type:"submit",positive:!0,onClick:function(e){e.preventDefault(),n()}}," Add "),i.a.createElement(E.a,{type:"button",negative:!0,onClick:function(){return a(!1)}}," Cancel ")))}))},Zt=a(140),Xt=function(e){var t=Object.assign({},e),a=Object(je.e)(t),n=Object(u.a)(a,2),r=n[0],l=n[1];return i.a.createElement(p.a.Field,null,i.a.createElement("label",null,t.inputlabel),i.a.createElement(Ie.a,Object.assign({},r,t,{error:l.touched&&l.error})))},ea=function(e){var t=e.name,a=Object(je.f)().getFieldProps,n=a("".concat(t,".title")).value,r=a("".concat(t,".date")).value,l=a("".concat(t,".by")).value,c=a("".concat(t,".text")).value,o=a("".concat(t,".edit")).value;return n&&"Add Clearification"!==n?i.a.createElement(O.a,null,i.a.createElement(b.a,{as:"h5"},n,i.a.createElement(b.a.Subheader,null,"by ",l," on ",r)),n&&i.a.createElement("p",null,c),o&&i.a.createElement(ht.a,null,pe.a.map(o,(function(e,t){return i.a.createElement(ht.a.Item,{key:t},t[0].toUpperCase()+t.substring(1).replace(/([a-z])([A-Z])/g,"$1 $2"),":",i.a.createElement("span",{style:{color:"red",fontStyle:"italic",textDecoration:"line-through"}}," ",e.split("to")[0]," "),"to",i.a.createElement("span",{style:{color:"green"}}," ",e.split("to")[1]," "))})))):i.a.createElement(O.a,{basic:!0},n&&i.a.createElement(b.a,{as:"h5"},"Add Clearification"===n&&"Clearification Added",i.a.createElement(b.a.Subheader,null,"by ",l," on ",r)),i.a.createElement(Ne,{name:"".concat(t,".text")}))},ta=function(e){var t=e.label,a=Object(ke.a)(e,["label"]),n=Object(je.f)().setFieldValue,r=Object(je.e)(a),l=Object(u.a)(r,2),c=l[0],o=l[1];return i.a.createElement(p.a.Field,{error:!(!o.touched||!o.error)},!a.labeled&&i.a.createElement("label",null,t),i.a.createElement(Ie.a,{label:!!a.labeled&&t,input:i.a.createElement(Zt.a,Object.assign({},c,a,{style:a.labeled?{margin:0,borderTopLeftRadius:0,borderBottomLeftRadius:0}:{},onChange:a.onChange?a.onChange:function(e,t){var r=t.value;n(a.name,r)}}))}),o.touched&&o.error&&i.a.createElement(ue.a,{pointing:!0,prompt:!0},o.error))},aa=function(e){var t=e.open,a=e.setOpen,l=e.costumer,c=Object(r.useContext)(Q),o=Object(u.a)(c,2)[1],s=Object(r.useState)([]),m=Object(u.a)(s,2),d=m[0],g=m[1],b=Object(f.useLazyQuery)(w),h=Object(u.a)(b,2),O=h[0],y=h[1],v=y.loading,S=y.data;Object(r.useEffect)((function(){if(S&&S.allStations){var e=l.stations.map((function(e){return e.id})),t=[];S.allStations.reduce((function(a,n,r){return n.id&&!e.includes(n.id)&&t.push({key:r,value:n.id,text:n.location}),t}),[]),g(t)}}),[l.stations,S]);var C=Object(f.useMutation)(Ht,{update:function(e,t){var a=t.data.addStationsToCostumer;Object(fe.forEach)(a.stations,(function(t){e.modify({id:"Station:".concat(t.id),fields:{costumers:function(e,t){var n=t.readField;return e.some((function(e){return n("id",e)===a.id}))?e:[].concat(Object(U.a)(e),[{__ref:"Costumer:".concat(a.id)}])}}})}))},onCompleted:function(e){e.addStationsToCostumer;o({type:"ADD_NOTIFICATION",payload:{content:"Success, stations added",type:"SUCCESS"}}),a(!1)},onerror:function(e){o({type:"ADD_NOTIFICATION",payload:{content:i.a.createElement(i.a.Fragment,null,"Error, failed to add stations",i.a.createElement("br",null)," ",e.message),type:"ERROR"}}),a(!1)}}),j=Object(u.a)(C,1)[0];return i.a.createElement(je.c,{initialValues:{stations:[]},validate:function(e){var t={};return e.stations.length||(t.stations="Please select at least one station"),t},onSubmit:function(e){j({variables:Object(n.a)(Object(n.a)({},e),{},{costumer:l.id})})}},(function(e){var n=e.handleSubmit,r=e.setFieldValue;e.dirty;return i.a.createElement(Je.a,{open:t,closeOnEscape:!1,closeOnDimmerClick:!1},i.a.createElement(Je.a.Header,null,"Select Stations to Add"),i.a.createElement(Je.a.Content,null,i.a.createElement(p.a,null,i.a.createElement(ta,{name:"stations",labeled:!0,label:"Station",placeholder:"Select Stations",search:!0,loading:v,selection:!0,multiple:!0,width:"8",options:d,onFocus:function(){return O()},onChange:function(e,t){var a=t.value;r("stations",a)}}))),i.a.createElement(Je.a.Actions,null,i.a.createElement(E.a,{type:"submit",positive:!0,onClick:function(e){e.preventDefault(),n()}}," Add "),i.a.createElement(E.a,{type:"button",negative:!0,onClick:function(){return a(!1)}}," Cancel ")))}))},na=function(e){var t=e.costumerData,a=e.costumerId,n=JSON.parse(sessionStorage.getItem("staffKey")),l=Object(r.useContext)(Q),c=Object(u.a)(l,2)[1],o=Object(r.useState)(""),s=Object(u.a)(o,2),m=s[0],p=s[1],h=Object(r.useState)(!1),y=Object(u.a)(h,2),v=y[0],S=y[1],C=Object(r.useState)(!1),j=Object(u.a)(C,2),w=j[0],k=j[1],T=Object(r.useState)(!1),I=Object(u.a)(T,2),A=I[0],D=I[1],R=Object(d.i)(),F=Object(d.g)(),$=Object(f.useQuery)(Yt,{variables:{id:R.costumerId||a},skip:t}),N=$.loading,P=$.error,x=$.data,M=Object(f.useMutation)(_t),H=Object(u.a)(M,1)[0],L=Object(f.useMutation)(Bt,{update:function(e){e.evict({id:"Costumer:".concat(m.id)})},onCompleted:function(){F.goBack(),c({type:"ADD_NOTIFICATION",payload:{content:"Success, costumer ".concat(m.name," deleted"),type:"SUCCESS"}})},onerror:function(e){c({type:"ADD_NOTIFICATION",payload:{content:i.a.createElement(i.a.Fragment,null,"Error, failed to delete  costumer ".concat(m.name),i.a.createElement("br",null)," ",e.message),type:"ERROR"}})}}),q=Object(u.a)(L,1)[0],_=Object(f.useMutation)(qt),B=Object(u.a)(_,1)[0],K=Object(f.useMutation)(Lt),z=Object(u.a)(K,1)[0],U=function(e){var t=e.variables,a=e.location;H({variables:t,update:function(e){e.modify({id:"Station:".concat(t.station),fields:{costumers:function(e,t){var a=t.readField;return e.filter((function(e){return m.id!==a("id",e)}))}}}),e.modify({id:"Costumer:".concat(m.id),fields:{stations:function(e,a){var n=a.readField;return e.filter((function(e){return console.log(t.station,n("id",e),t.stationId!==n("id",e)),t.station!==n("id",e)}))}}})}}).then((function(e){c({type:"ADD_NOTIFICATION",payload:{content:"Success, Station ".concat(a||""," deassigned for costumer ").concat(m.name),type:"SUCCESS"}}),F.goBack()}),(function(e){return c({type:"ADD_NOTIFICATION",payload:{content:i.a.createElement(i.a.Fragment,null,"Error, Cannot deassign costumer ".concat(m.name," ").concat(a?"and "+a:""),i.a.createElement("br",null)," ",e.message),type:"ERROR"}})}))},Y=Object(r.useState)({title:"",fn:function(){}}),V=Object(u.a)(Y,2),J=V[0],W=V[1],G=Object(r.useState)(!1),Z=Object(u.a)(G,2),X=Z[0],ee=Z[1];return Object(r.useEffect)((function(){t&&p(t),x&&p(x.getCostumer)}),[t,x,p]),m?N?i.a.createElement(O.a,{basic:!0},i.a.createElement(le.a,{active:!0}," Adding New Costumer")):P?i.a.createElement(b.a,{as:"h4"},"Something went wrong"):i.a.createElement(i.a.Fragment,null,i.a.createElement(b.a,{as:"h3"},m.name),i.a.createElement(g.a,{padded:!0},i.a.createElement(g.a.Row,{columns:"3"},i.a.createElement(g.a.Column,null,i.a.createElement(b.a,{as:"h5"}," Aircrafts "),i.a.createElement(O.a,null,m.aircrafts&&m.aircrafts.map((function(e,t){return i.a.createElement(O.a,{key:t,compact:!0,style:{display:"inline-flex",margin:"0.1rem",width:"4.3rem"}},n&&n.permission.admin&&i.a.createElement(ue.a,{floating:!0,size:"tiny",style:{backgroundColor:"transparent"}},i.a.createElement(de.a,{link:!0,name:"cancel",onClick:function(){W({title:"Are you sure you want to  deassign Aircraft ".concat(e.registration," from this Costumer ?"),fn:function(){!function(e){var t=e.id,a=e.registration;z({variables:{id:t},update:function(e){e.evict({id:"Aircraft:".concat(t)})}}).then((function(e){return c({type:"ADD_NOTIFICATION",payload:{content:"Success, Aircraft ".concat(a," removed"),type:"SUCCESS"}})}),(function(e){return c({type:"ADD_NOTIFICATION",payload:{content:i.a.createElement(i.a.Fragment,null,"Error, Cannot remove Aircrfat ".concat(a),i.a.createElement("br",null)," ",e.message),type:"ERROR"}})}))}({id:e.id,registration:e.registration})}}),ee(!0)}})),e.registration)})),n&&n.permission.admin&&i.a.createElement(E.a,{style:{marginTop:"1rem",display:"block"},circular:!0,icon:!0,primary:!0,size:"small",onClick:function(){return k(!0)}},i.a.createElement(de.a,{name:"add"})))),i.a.createElement(g.a.Column,null,i.a.createElement(b.a,{as:"h5"}," Key Contacts "),i.a.createElement(he.a,null,i.a.createElement(he.a.Header,null,i.a.createElement(he.a.Row,null,i.a.createElement(he.a.HeaderCell,null," Description "),i.a.createElement(he.a.HeaderCell,null," Phone "),i.a.createElement(he.a.HeaderCell,null," Email "),i.a.createElement(he.a.HeaderCell,null," "))),i.a.createElement(he.a.Body,null,m.keyContacts&&m.keyContacts.length>0&&m.keyContacts.map((function(e,t){return i.a.createElement(he.a.Row,{key:t},i.a.createElement(he.a.Cell,null,e.description),i.a.createElement(he.a.Cell,null,e.phone),i.a.createElement(he.a.Cell,null,e.email),n&&(n.permission.admin||n.permission.station.edit.includes(R.stationId))&&i.a.createElement(he.a.Cell,null,i.a.createElement(de.a,{link:!0,name:"cancel",onClick:function(){W({title:"Are you sure you want to  remove contact ".concat(e.description," from this Costumer ?"),fn:function(){!function(e){var t=e.id,a=e.description;B({variables:{id:t,costumer:m.id},update:function(e){console.log(t),e.evict({id:"Contact:".concat(t)})}}).then((function(e){return c({type:"ADD_NOTIFICATION",payload:{content:"Success, Contact ".concat(a," removed"),type:"SUCCESS"}})}),(function(e){return c({type:"ADD_NOTIFICATION",payload:{content:i.a.createElement(i.a.Fragment,null,"Error, Cannot remove Contact ".concat(a),i.a.createElement("br",null)," ",e.message),type:"ERROR"}})}))}({id:e.id,description:e.description})}}),ee(!0)}})))}))),n&&(n.permission.admin||n.permission.station.edit.includes(R.stationId))&&i.a.createElement(he.a.Footer,null,i.a.createElement(he.a.Row,null,i.a.createElement(he.a.Cell,null,i.a.createElement(E.a,{circular:!0,icon:!0,primary:!0,size:"small",onClick:function(){return D(!0)}},i.a.createElement(de.a,{name:"add"}))))))),i.a.createElement(g.a.Column,null,i.a.createElement(b.a,{as:"h5"}," Stations "),i.a.createElement(he.a,{padded:!0},i.a.createElement(he.a.Header,null,i.a.createElement(he.a.Row,null,i.a.createElement(he.a.HeaderCell,null," Station "),i.a.createElement(he.a.HeaderCell,null),i.a.createElement(he.a.HeaderCell,null))),i.a.createElement(he.a.Body,null,m.stations&&m.stations.length>0&&m.stations.map((function(e,t){return i.a.createElement(he.a.Row,{key:t},i.a.createElement(he.a.Cell,null,e.location),i.a.createElement(he.a.Cell,null,"".concat(e.address.city," , ").concat(e.address.country)," ",i.a.createElement(wt.a,{name:e.address.country&&e.address.country.toLowerCase()})),n&&(n.permission.admin||n.permission.station.edit.includes(R.stationId))&&i.a.createElement(he.a.Cell,null,R.stationId!==e.id&&i.a.createElement(de.a,{link:!0,name:"cancel",onClick:function(){W({title:"Are you sure you want to  remove station ".concat(e.location," from this Costumer ?"),fn:function(){U({variables:{station:e.id,costumer:m.id},location:e.location})}}),ee(!0)}})))}))),n&&(n.permission.admin||n.permission.station.edit.includes(R.stationId))&&i.a.createElement(he.a.Footer,null,i.a.createElement(he.a.Row,null,i.a.createElement(he.a.Cell,null,i.a.createElement(E.a,{circular:!0,icon:!0,primary:!0,size:"small",onClick:function(){return S(!0)}},i.a.createElement(de.a,{name:"add"})))))))),i.a.createElement(g.a.Row,null,R.stationId&&n&&(n.permission.admin||n.permission.station.edit.map((function(e){return e._id})).includes(R.stationId))&&i.a.createElement(E.a,{negative:!0,onClick:function(){W({title:"Are you sure you want to  remove costumer ".concat(m.name," from this station ?"),fn:function(){U({variables:{station:R.stationId,costumer:m.id}})}}),ee(!0)}}," Remove from Station "),!R.stationId&&n&&n.permission.admin&&i.a.createElement(E.a,{icon:!0,negative:!0,onClick:function(){W({title:"Are you sure you want to  delete costumer ".concat(m.name," ?"),fn:function(){q({variables:{costumer:m.id}})}}),ee(!0)}}," ",i.a.createElement(de.a,{name:"trash"})," Delete Costumer "))),X&&i.a.createElement(Vt,{open:X,confirm:J,setOpen:ee}),v&&i.a.createElement(aa,{open:v,setOpen:S,costumer:m}),w&&i.a.createElement(Qt,{open:w,setOpen:k,costumer:m}),A&&i.a.createElement(Gt,{open:A,setOpen:D,costumer:m})):null},ra=function(e){var t=e.open,a=e.setOpen,l=e.station,c=Object(r.useContext)(Q),o=Object(u.a)(c,2)[1],s=Object(r.useState)([]),m=Object(u.a)(s,2),d=m[0],g=m[1],b=Object(f.useLazyQuery)(Ut),h=Object(u.a)(b,2),O=h[0],y=h[1],v=y.loading,S=y.data;Object(r.useEffect)((function(){if(S&&S.allCostumers){var e=l.costumers.map((function(e){return e.id})),t=S.allCostumers.map((function(e,t){return{key:t,value:e.id,text:e.name}}));g(t.filter((function(t){return!e.includes(t.value)})))}}),[S,l.costumers]);var C=Object(f.useMutation)(z,{update:function(e,t){var a=t.data.assignCostumers;Object(fe.forEach)(a.costumers,(function(t){e.modify({id:"Costumer:".concat(t.id),fields:{stations:function(e,t){var a=t.readField;return e.some((function(e){return a("id",e)===l.id}))?e:[].concat(Object(U.a)(e),[{__ref:"Sation:".concat(l.id)}])}}})}))},onCompleted:function(e){console.log(e),o({type:"ADD_NOTIFICATION",payload:{content:"Success, costumers assigned to station",type:"SUCCESS"}}),a(!1)},onerror:function(e){o({type:"ADD_NOTIFICATION",payload:{content:i.a.createElement(i.a.Fragment,null,"Error, failed to assign costumers",i.a.createElement("br",null)," ",e.message),type:"ERROR"}}),a(!1)}}),j=Object(u.a)(C,1)[0];return i.a.createElement(je.c,{initialValues:{costumers:[]},validate:function(e){var t={};return e.costumers.length||(t.costumers="Please select at least one costumer"),t},onSubmit:function(e){j({variables:Object(n.a)(Object(n.a)({},e),{},{stationId:l.id})})}},(function(e){var n=e.handleSubmit,r=e.setFieldValue;return i.a.createElement(Je.a,{open:t,closeOnEscape:!1,closeOnDimmerClick:!1},i.a.createElement(Je.a.Header,null,"Select costumers to Assign"),i.a.createElement(Je.a.Content,null,i.a.createElement(p.a,null,i.a.createElement(ta,{name:"costumers",labeled:!0,label:"Costumers",placeholder:"Select Costumers",search:!0,loading:v,selection:!0,multiple:!0,width:"8",options:d,onFocus:function(){return O()},onChange:function(e,t){var a=t.value;r("costumers",a)}}))),i.a.createElement(Je.a.Actions,null,i.a.createElement(E.a,{type:"submit",positive:!0,onClick:function(e){e.preventDefault(),n()}}," Add "),i.a.createElement(E.a,{type:"button",negative:!0,onClick:function(){return a(!1)}}," Cancel ")))}))},ia=function(e){var t=e.open,a=e.setOpen,n=e.station,l=Object(r.useContext)(Q),c=Object(u.a)(l,2)[1],o=Object(r.useState)([]),s=Object(u.a)(o,2),m=s[0],d=s[1],g=Object(f.useMutation)(H,{update:function(e){e.modify({id:"Station:".concat(n.id),fields:{mailingList:function(e){var t=[];return Object(fe.forEach)(m,(function(a){e.some((function(e){return e===a}))||t.push(a)})),[].concat(Object(U.a)(e),t)}}})},onCompleted:function(e){e.addAircrafts;c({type:"ADD_NOTIFICATION",payload:{content:"Success, emails ".concat(m.toString(),"  added"),type:"SUCCESS"}}),a(!1)},onerror:function(e){c({type:"ADD_NOTIFICATION",payload:{content:i.a.createElement(i.a.Fragment,null,"Error, failed to add emails",i.a.createElement("br",null)," ",e.message),type:"ERROR"}}),a(!1)}}),b=Object(u.a)(g,1)[0];return i.a.createElement(je.c,{initialValues:{emails:""},validate:function(e){var t={};if(e.emails.length){var a=[];Object(fe.forEach)(e.emails.split(","),(function(e){Ue(e.trim())&&a.push(e)})),a.length&&(t.emails="".concat(a.toString()," Invalid emails"))}else t.emails="Enter at least one Email";return console.log(t),t},onSubmit:function(e){d(e.emails.split(",")),b({variables:{emails:e.emails.split(","),stationId:n.id}})}},(function(e){var n=e.handleSubmit;return i.a.createElement(Je.a,{open:t,closeOnEscape:!1,closeOnDimmerClick:!1},i.a.createElement(Je.a.Header,null,"Select Stations to Add"),i.a.createElement(Je.a.Content,null,i.a.createElement(p.a,null,i.a.createElement(Fe,{name:"emails",label:"Emails",type:"text",width:"8",placeholder:'Emails separeted by comma ","'}))),i.a.createElement(Je.a.Actions,null,i.a.createElement(E.a,{type:"submit",positive:!0,onClick:function(e){e.preventDefault(),n()}}," Add "),i.a.createElement(E.a,{type:"button",negative:!0,onClick:function(){return a(!1)}}," Cancel ")))}))};function la(){var e=Object(S.a)(["\n                fragment NewShift on ShiftInfo {\n                  id\n                  name\n                  startTime\n                }\n              "]);return la=function(){return e},e}var ca=function(e){var t=e.open,a=e.setOpen,l=e.station,c=Object(r.useContext)(Q),o=Object(u.a)(c,2)[1],s=Object(f.useMutation)(q,{update:function(e,t){var a=t.data.addShifts;e.modify({id:"Station:".concat(l.id),fields:{shifts:function(t,n){var r=n.readField,i=[];return Object(fe.forEach)(a,(function(a){t.some((function(e){return r("id",e)===a.id}))||i.push(e.writeFragment({data:a,fragment:Object(f.gql)(la())}))})),[].concat(Object(U.a)(t),i)}}})},onCompleted:function(){o({type:"ADD_NOTIFICATION",payload:{content:"Success, shifts added",type:"SUCCESS"}}),a(!1)},onerror:function(e){o({type:"ADD_NOTIFICATION",payload:{content:i.a.createElement(i.a.Fragment,null,"Error, failed to add shifts",i.a.createElement("br",null)," ",e.message),type:"ERROR"}}),a(!1)}}),m=Object(u.a)(s,1)[0];return i.a.createElement(je.c,{initialValues:{shifts:[{name:"",startTime:""}]},validate:function(e){var t={};return e.shifts.length&&Object(fe.forEach)(e.shifts,(function(e,a){e.name||(t.shifts||(t.shifts=[]),t.shifts[a]||(t.shifts[a]={}),t.shifts[a].name="Please provide shift name"),e.startTime||(t.shifts||(t.shifts=[]),t.shifts[a]||(t.shifts[a]={}),t.shifts[a].startTime="Shift start time is required"),e.startTime&&(e.startTime.match(/^(0[0-9]|1[0-9]|2[0-3]):[0-5][0-9]$/)||(t.shifts||(t.shifts=[]),t.shifts[a]||(t.shifts[a]={}),t.shifts[a].startTime="Shift start should be on format HH:mm"))})),t},onSubmit:function(e){m({variables:Object(n.a)(Object(n.a)({},e),{},{stationId:l.id})})}},(function(e){var n=e.handleSubmit,l=e.values;return i.a.createElement(Je.a,{open:t,closeOnEscape:!1,closeOnDimmerClick:!1},i.a.createElement(Je.a.Header,null,"Select Stations to Add"),i.a.createElement(Je.a.Content,null,i.a.createElement(p.a,null,i.a.createElement(je.b,{name:"shifts"},(function(e){var t=e.push,a=e.remove;return i.a.createElement(i.a.Fragment,null,l.shifts.length>0&&l.shifts.map((function(e,t){return i.a.createElement(r.Fragment,{key:t},i.a.createElement(p.a.Group,{style:{margin:0},widths:"13"},i.a.createElement(Fe,{name:"shifts[".concat(t,"].name"),placeholder:"Shift Name"}),i.a.createElement(Re,{name:"shifts[".concat(t,"].startTime"),label:!0,placeholder:"Start Time"}),0!==t&&i.a.createElement(de.a,{link:!0,name:"cancel",color:"red",onClick:function(){return a(t)}})))})),i.a.createElement(E.a,{style:{marginTop:"1rem"},type:"button",circular:!0,icon:!0,size:"mini",primary:!0,onClick:function(){return t({name:"",startTime:""})}},i.a.createElement(de.a,{name:"plus"})))})))),i.a.createElement(Je.a.Actions,null,i.a.createElement(E.a,{type:"submit",positive:!0,onClick:function(e){e.preventDefault(),n()}}," Add "),i.a.createElement(E.a,{type:"button",negative:!0,onClick:function(){return a(!1)}}," Cancel ")))}))},oa=a(168),sa=a(169),ma=function(e){var t=Object(r.useContext)(Q),a=Object(u.a)(t,2)[1],n=Object(f.useMutation)(B,{onCompleted:function(){a({type:"ADD_NOTIFICATION",payload:{content:"Success, key reset ",type:"SUCCESS"}}),e.setOpen(!1)},onError:function(t){a({type:"ADD_NOTIFICATION",payload:{content:i.a.createElement(i.a.Fragment,null,"Error, failed to change key",i.a.createElement("br",null)," ",t.message),type:"ERROR"}}),e.setOpen(!1)}}),l=Object(u.a)(n,2),c=l[0],o=l[1].loading;return i.a.createElement(Je.a,{closeIcon:!0,closeOnEscape:!1,closeOnDimmerClick:!1,open:e.open,onClose:function(){return e.setOpen(!1)},onOpen:function(){return e.setOpen(!0)}},i.a.createElement(oa.a,null,"StationKey Reset"),i.a.createElement(sa.a,null,o&&i.a.createElement(we.a,{active:!0},"Updating key",i.a.createElement(le.a,null)),i.a.createElement(je.c,{initialValues:{newKey:"",confirmKey:""},validate:function(e){var t={};return e.newKey||(t.newKey="New key cannot be empty"),e.newKey!==e.confirmKey&&(t.confirmKey="New key and confirm key must match"),t},onSubmit:function(t){console.log("Calles"),c({variables:{stationId:e.station.id,stationKey:t.newKey}})}},(function(e){var t=e.handleSubmit,a=e.dirty,n=e.errors;return i.a.createElement(p.a,{style:{marginBottom:"5rem"},onSubmit:t},i.a.createElement(g.a,null,i.a.createElement(g.a.Row,null,i.a.createElement(Fe,{name:"newKey",label:"New key",type:"password"})),i.a.createElement(g.a.Row,null,i.a.createElement(Fe,{name:"confirmKey",label:"Confirm key",type:"password"}))),a&&pe.a.isEmpty(n)&&i.a.createElement(E.a,{type:"submit",style:{marginTop:"1rem"},positive:!0},"Change key"))}))))},ua=function(e){var t=JSON.parse(sessionStorage.getItem("staffKey")),a=Object(r.useContext)(Q),n=Object(u.a)(a,2)[1],l=Object(r.useState)(!1),c=Object(u.a)(l,2),o=c[0],s=c[1],m=Object(r.useState)(!1),h=Object(u.a)(m,2),y=h[0],v=h[1],S=Object(r.useState)(!1),C=Object(u.a)(S,2),j=C[0],w=C[1],T=Object(r.useState)(!1),I=Object(u.a)(T,2),A=I[0],D=I[1],R=Object(r.useState)({title:"",fn:function(){}}),F=Object(u.a)(R,2),$=F[0],N=F[1],P=Object(r.useState)(e.data),x=Object(u.a)(P,2),M=x[0],H=x[1],q=Object(d.g)(),B=Object(d.i)().stationId,z=Object(f.useQuery)(k,{variables:{id:B},onerror:function(e){n({type:"ADD_NOTIFICATION",payload:{content:i.a.createElement(i.a.Fragment,null,"Error, could not retrive Station",i.a.createElement("br",null)," ",e.message),type:"ERROR"}})}}).data;Object(r.useEffect)((function(){z&&z.getStation&&H(z.getStation)}),[z]);var Y=Object(f.useMutation)(K,{variables:{stationId:B},update:function(e){e.evict({id:"Station:".concat(B)})},onCompleted:function(e){e.addContact;n({type:"ADD_NOTIFICATION",payload:{content:"Station Deleted",type:"SUCCESS"}}),q.push("/Manage/AllStations")},onerror:function(e){n({type:"ADD_NOTIFICATION",payload:{content:i.a.createElement(i.a.Fragment,null,"Error, failed to delete Station",i.a.createElement("br",null)," ",e.message),type:"ERROR"}})}}),V=Object(u.a)(Y,1)[0],J=Object(f.useMutation)(L),W=Object(u.a)(J,1)[0],G=Object(f.useMutation)(_),Z=Object(u.a)(G,1)[0];return i.a.createElement(i.a.Fragment,null,i.a.createElement(g.a,{padded:!0},i.a.createElement(g.a.Row,null,i.a.createElement(O.a,{basic:!0,attached:!0},i.a.createElement(b.a,{as:"h5"},"Mailing List",i.a.createElement(b.a.Subheader,null,"Below emails will receive the shift reports on submit.")),i.a.createElement(he.a,{attached:!0,compact:!0,collapsing:!0,padded:!0},i.a.createElement(he.a.Body,null,M&&M.mailingList.map((function(e,t){return i.a.createElement(he.a.Row,{key:t},i.a.createElement(he.a.Cell,null,e),i.a.createElement(he.a.Cell,null,i.a.createElement(de.a,{link:!0,name:"trash",onClick:function(){s(!0),N({title:" Are you sure you want to delete this email",fn:function(){return function(e){W({variables:{email:e,stationId:B},update:function(t){t.modify({id:"Station:".concat(B),fields:{mailingList:function(t){return Object(U.a)(t.filter((function(t){return t!==e})))}}})}}).then((function(t){return n({type:"ADD_NOTIFICATION",payload:{content:"Success, ".concat(e," removed from mailing list "),type:"SUCCESS"}})}),(function(e){return n({type:"ADD_NOTIFICATION",payload:{content:"Error, coluld not remove email",type:"ERROR"}})}))}(e)}})}})))})))),i.a.createElement(p.a.Button,{style:{marginTop:"0.5rem"},primary:!0,size:"tiny",onClick:function(){return w(!0)}}," Add More ")),i.a.createElement(O.a,{basic:!0,attached:!0},i.a.createElement(b.a,{as:"h5"},"Shifts",i.a.createElement(b.a.Subheader,null,"Below are the working shifts for this station. ")),i.a.createElement(he.a,{attached:!0,compact:!0,collapsing:!0,padded:!0},i.a.createElement(he.a.Body,null,M&&M.shifts.map((function(e,t){return i.a.createElement(he.a.Row,{key:t},i.a.createElement(he.a.Cell,null,e.name," ",i.a.createElement("strong",null,"starts at")," ",e.startTime),i.a.createElement(he.a.Cell,null,i.a.createElement(de.a,{link:!0,name:"trash",onClick:function(){s(!0),N({title:" Are you sure you want to remove this shift",fn:function(){return t=e.id,a=e.name,void Z({variables:{id:t,stationId:B},update:function(e){e.evict({id:"ShiftInfo:".concat(t)})}}).then((function(e){return n({type:"ADD_NOTIFICATION",payload:{content:"Success, ".concat(a," shift removed from station "),type:"SUCCESS"}})}),(function(e){return n({type:"ADD_NOTIFICATION",payload:{content:"Error, coluld not remove shift",type:"ERROR"}})}));var t,a}})}})))})))),i.a.createElement(p.a.Button,{style:{marginTop:"0.5rem"},primary:!0,size:"tiny",onClick:function(){return v(!0)}}," Add More ")),i.a.createElement(O.a,{attached:!0},i.a.createElement(b.a,{as:"h5"},"Staff signing mehtods",i.a.createElement(b.a.Subheader,null,"Staff can sign and report working hours using following Methods ")),i.a.createElement("p",null,"This feature is not Implmented yet. By default, user should sign with his credentials.")),i.a.createElement(O.a,{attached:!0},i.a.createElement(E.a,{primary:!0,onClick:function(){D(!0)}}," Reset station key ")))),t.permission.admin&&i.a.createElement(E.a,{negative:!0,onClick:function(){s(!0),N({title:" Are you sure you want to delete this station",fn:function(){return V()}})}}," DELETE STATION "),o&&i.a.createElement(Vt,{open:o,confirm:$,setOpen:s}),y&&i.a.createElement(ca,{station:M,open:y,setOpen:v}),j&&i.a.createElement(ia,{station:M,open:j,setOpen:w}),A&&i.a.createElement(ma,{station:M,open:A,setOpen:D}))},da=function(e){var t=e.station,a=e.activeItem,n=e.setActiveItem,r=e.setActiveCostumer,l=Object(d.g)(),c=JSON.parse(sessionStorage.getItem("staffKey")),o=Object(d.h)(),s=function(e,t){var i=t.name;n(i),r(""),a!==i&&c&&l.push(function(e){var t=o.pathname.split("/").filter((function(e){return""!==e}));return t.reduce((function(e,n,r){return n===a||t.length-1===r?(t.splice(1),e):e+"/"+n}),"")+"/"+e}(i))};return i.a.createElement(oe.a,{pointing:!0,secondary:!0},i.a.createElement(oe.a.Item,{header:!0},t.location),i.a.createElement(oe.a.Item,{position:"right",name:"BasicInfo",active:"BasicInfo"===a,onClick:s}),i.a.createElement(oe.a.Item,{name:"Procedures",active:"Procedures"===a,onClick:s}),i.a.createElement(oe.a.Item,{name:"Costumers",active:"Costumers"===a,onClick:s}),c&&(c.permission.admin||c.permission.station.edit.map((function(e){return e._id})).includes(t.id))&&i.a.createElement(oe.a.Item,{name:"Settings",active:"Settings"===a,onClick:s}))},fa=function(e){var t=Object(r.useState)(""),a=Object(u.a)(t,2),n=a[0],l=a[1],c=Object(r.useState)("BasicInfo"),o=Object(u.a)(c,2),s=o[0],m=o[1],p=Object(r.useState)(""),h=Object(u.a)(p,2),y=h[0],v=h[1],S=Object(r.useState)(!1),C=Object(u.a)(S,2),j=C[0],w=C[1],T=Object(d.g)(),I=Object(d.h)(),A=I.pathname&&I.pathname.split("/").filter((function(e){return e})),D=Object(d.i)();Object(r.useEffect)((function(){D.page&&m(D.page)}),[D]);var R=Object(d.i)().stationId;e.stationId&&(R=e.stationId);var F=JSON.parse(sessionStorage.getItem("staffKey")),$=Object(f.useQuery)(k,{variables:{id:R},skip:!R}),N=$.loading,P=$.data;Object(r.useEffect)((function(){P&&l(P.getStation)}),[P]);var x=function(e){var t=Object(U.a)(A);return t.reduce((function(a,n,r){return r>e?(t.splice(1),a):a+"/"+n}),"")};return R&&n&&!N?i.a.createElement(i.a.Fragment,null,F&&i.a.createElement(St.a,null,A.map((function(e,t){return 0===t?"":i.a.createElement(r.Fragment,{key:t},i.a.createElement(Ct.a,{active:t===A.length-1,as:t<A.length-1?vt.b:"",to:x(t)},2===t&&n.location,4===t&&"costumers"===A[t-1].toLowerCase()&&n.costumers.filter((function(t){return t.id===e}))[0]&&n.costumers.filter((function(t){return t.id===e}))[0].name,2!==t&&4!==t&&e),t<A.length-1&&i.a.createElement(jt.a,null))}))),i.a.createElement(da,{station:n,activeItem:s,setActiveItem:m,setActiveCostumer:v}," "),"BasicInfo"===s&&i.a.createElement(g.a,{padded:!0},i.a.createElement(g.a.Row,{columns:"4"},i.a.createElement(g.a.Column,null,i.a.createElement(b.a,{as:"h4"},"Address:",i.a.createElement(b.a.Subheader,null,n.address.street,i.a.createElement("br",null),n.address.postcode,n.address.city,i.a.createElement("br",null),n.address.country," ",i.a.createElement(wt.a,{name:n.address.country.toLowerCase()})))),i.a.createElement(g.a.Column,null,i.a.createElement(b.a,{as:"h4"},"Contact:",i.a.createElement(b.a.Subheader,null,i.a.createElement("strong",null,"Email: ")," ",n.email,i.a.createElement("br",null),i.a.createElement("strong",null,"Phone: "),n.phone.reduce((function(e,t){return e+" / "+t}))))),i.a.createElement(g.a.Column,null,i.a.createElement(b.a,{as:"h4"},"Shifts:",n.shifts.map((function(e,t){return i.a.createElement(b.a.Subheader,{key:t}," ",e.name," ",i.a.createElement("strong",null," Starts at: ")," ",e.startTime,i.a.createElement("br",null))}))))),i.a.createElement(g.a.Row,null,i.a.createElement(g.a.Column,null,i.a.createElement(b.a,{as:"h4"},"Current Staffs:"),i.a.createElement(he.a,{collapsing:!0},i.a.createElement(he.a.Header,null,i.a.createElement(he.a.Row,null,i.a.createElement(he.a.HeaderCell,null," Name "),i.a.createElement(he.a.HeaderCell,null," Last Active At:  "))),i.a.createElement(he.a.Body,null,n.staffList.length>0&&n.staffList.map((function(e,t){return i.a.createElement(he.a.Row,{key:t},i.a.createElement(he.a.Cell,null,F&&F.permission.staff.view?i.a.createElement(vt.b,{to:"/Manage/AllStaffs/".concat(e.id,"/Profile")},e.name):e.name),i.a.createElement(he.a.Cell,null,Pe(e.lastActive.activeAt)))}))))))),"Procedures"===s&&i.a.createElement(b.a,{as:"h5"}," This Station Procedure feature is not Implemented yet, will be implemanted soon ...",i.a.createElement(b.a.Subheader,null,"After this implemetation, one will be able to add/ view / search all the station related procedure such as 'Garbage Disposal , Hanger Booking , Supplies Delivery ...' on this section")),"Costumers"===s&&!(D.costumerId||y)&&i.a.createElement(i.a.Fragment,null,i.a.createElement(kt.a.Group,null,n.costumers&&n.costumers.map((function(e){return i.a.createElement(kt.a,{key:e.id,link:!0,raised:!0,onClick:function(){F?T.push("".concat(I.pathname,"/").concat(e.id)):v(e.id)}},i.a.createElement(kt.a.Content,{textAlign:"center",header:e.name}),i.a.createElement(kt.a.Content,{textAlign:"center"},e.contract?e.contract+" Contract":""),i.a.createElement(kt.a.Content,{textAlign:"center",extra:!0},i.a.createElement(b.a,{as:"h5"}," ",i.a.createElement(de.a,{name:"plane"})," Total Aircrafts: ",e.aircrafts.length)))}))),F&&(F.permission.admin||F.permission.station.edit.map((function(e){return e._id})).includes(R))&&i.a.createElement(O.a,{basic:!0,compact:!0},i.a.createElement(E.a,{primary:!0,icon:!0,onClick:function(){return w(!0)}},i.a.createElement(de.a,{name:"add circle"})," Add More"),j&&i.a.createElement(ra,{open:j,setOpen:w,station:n}))),"Costumers"===s&&(D.costumerId||y)&&i.a.createElement(na,{costumerId:y}),"Settings"===s&&i.a.createElement(ua,{data:n})):i.a.createElement(O.a,{basic:!0},i.a.createElement(le.a,{active:!0},"Loading Station"))},pa=function(){var e=Object(d.g)(),t=Object(r.useContext)(ve),a=Object(r.useReducer)(Se,t),n=Object(u.a)(a,2),l=n[0],c=n[1],o=Object(r.useContext)(Q),s=Object(u.a)(o,2)[1];JSON.parse(sessionStorage.getItem("stationKey"))||e.push("/");var m,p=Object(d.i)(),E=p.id,g=p.station,y=Object(r.useState)("lastShiftReport"),v=Object(u.a)(y,2),S=v[0],C=v[1];g&&E&&(m={station:E,flag:"MOST_RECENTLY_COMPLETED"});var j=[Object(f.useQuery)(ne,{variables:m,onError:function(){return s({type:"ADD_NOTIFICATION",payload:{content:A.message,type:"ERROR"}})}}),Object(f.useQuery)(k,{variables:{id:E}})],w=Object(u.a)(j,2),T=w[0],I=T.loading,A=T.error,D=T.data,R=w[1].data;return Object(r.useEffect)((function(){R&&c({type:"INIT_STATION",payload:R.getStation})}),[R]),Object(r.useEffect)((function(){D&&c({type:"ADD_LASTSHIFTREPORT",payload:D.getShiftReport})}),[D]),I?i.a.createElement(le.a,{active:!0},"Fetching Data"):i.a.createElement(i.a.Fragment,null,i.a.createElement(ve.Provider,{value:{state:l,dispatch:c}},i.a.createElement(O.a,{basic:!0},i.a.createElement(b.a,{textAlign:"right",color:"blue",floated:"right"},"Shift Reporting System ",i.a.createElement("br",null),i.a.createElement("span",null,i.a.createElement("h5",null," Station: ",R&&R.getStation.location," "))),i.a.createElement(h.a,{src:"\\LogoBig.png",size:"medium"})),i.a.createElement(se,{activeItem:S,setActiveItem:C}),"lastShiftReport"===S&&i.a.createElement(ye,{reportData:D&&D.getShiftReport}),"browseAllReports"===S&&i.a.createElement(yt,null),"startNewReport"===S&&i.a.createElement(bt,{setActiveItem:C}),"stationInfo"===S&&i.a.createElement(fa,{stationId:E})))};function Ea(){var e=Object(S.a)(["\n  mutation registerStaff( $registerCode:String!, $username: String!, $password: String!){\n    registerStaff(\n      registerCode: $registerCode\n      username: $username,\n      password:$password,\n    ){\n      status,\n      message\n    }\n  }"]);return Ea=function(){return e},e}function ga(){var e=Object(S.a)(["\n  mutation deleteStaff( $id: String!){\n    staffDelete(\n      id: $id,\n    ){\n      status\n      message\n    }\n  }\n"]);return ga=function(){return e},e}function ba(){var e=Object(S.a)(["\n  mutation toggleleStaffStatus( $id: String!, $disabled: Boolean! ){\n    setStaffStatus(\n      id: $id,\n      disabled: $disabled\n      )\n      {\n      status\n      message\n    }\n  }\n"]);return ba=function(){return e},e}function ha(){var e=Object(S.a)(["\n  mutation addStaff( $name: String!, $email: String!, $contractType: String! , $ contractHours: Int!, $position: String, $idCardCode: String){\n    addStaff(\n      name: $name,\n      email:$email,\n      contractType: $contractType,\n      contractHours: $contractHours,\n      position: $position\n      idCardCode: $idCardCode\n    ){\n      id,\n      name,\n      email,\n      phone\n    }\n  }\n"]);return ha=function(){return e},e}function Oa(){var e=Object(S.a)(["\nmutation staffEdit($id:String! $email:String, $phone: String , $contractType: String , $reqHours: Float , $position :String){\n  staffEdit(\n    id: $id,\n    email:$email,\n    phone:$phone,\n    contractType: $contractType,\n    reqHours: $reqHours,\n    position: $position\n  ){\n    id\n    email\n    phone\n    contractType\n    reqHours\n    position\n  }\n}"]);return Oa=function(){return e},e}function ya(){var e=Object(S.a)(["\nmutation changePassword ( $id: String!, $password: String!, $newPassword: String! ){\n  changePassword ( \n    id: $id,\n    password: $password,\n    newPassword: $newPassword\n    ){\n      status\n      message\n    }\n}"]);return ya=function(){return e},e}function va(){var e=Object(S.a)(["\nmutation resetPasswordReq ($id: String!){\n  resetPasswordReq(\n    id: $id,\n  ){\n    status\n    message\n  }\n}"]);return va=function(){return e},e}function Sa(){var e=Object(S.a)(["\nmutation resetRegisterCode ($id: String!){\n  resetRegisterCode(\n    id: $id,\n  ){\n    status\n    message\n  }\n}"]);return Sa=function(){return e},e}function Ca(){var e=Object(S.a)(["\nmutation resetPassword ($resetCode: String!, $password: String!){\n  resetPassword(\n    password: $password,\n    resetCode: $resetCode\n  ){\n    status\n    message\n  }\n}"]);return Ca=function(){return e},e}function ja(){var e=Object(S.a)(["\n  mutation staffLogin($username: String!, $password:String!){\n    staffLogin(username: $username, password: $password) \n  }\n"]);return ja=function(){return e},e}var wa=Object(f.gql)(ja()),ka=Object(f.gql)(Ca()),Ta=Object(f.gql)(Sa()),Ia=Object(f.gql)(va()),Aa=Object(f.gql)(ya()),Da=Object(f.gql)(Oa()),Ra=Object(f.gql)(ha()),Fa=Object(f.gql)(ba()),$a=Object(f.gql)(ga()),Na=Object(f.gql)(Ea()),Pa=function(){var e=Object(r.useContext)(Q),t=Object(u.a)(e,2)[1],a=Object(d.g)(),n=Object(r.useState)(""),l=Object(u.a)(n,2),c=l[0],o=l[1],y=Object(r.useState)(""),S=Object(u.a)(y,2),C=S[0],j=S[1],w=Object(f.useMutation)(wa,{onError:function(e){t({type:"ADD_NOTIFICATION",payload:{content:i.a.createElement(i.a.Fragment,null,"Error, Cannot Login",i.a.createElement("br",null)," ",e.message),type:"ERROR"}})}}),k=Object(u.a)(w,2),T=k[0],I=k[1].data;Object(r.useEffect)((function(){if(I){var e=I.staffLogin;sessionStorage.setItem("staffKey",JSON.stringify(e)),a.push("/staff/".concat(e.id))}}),[I]);var A=function(){var e=Object(m.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),T({variables:{username:c,password:C}});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),D=JSON.parse(sessionStorage.getItem("staffKey"));return D&&a.push("/staff/".concat(D.id)),i.a.createElement(g.a,{textAlign:"center",style:{height:"100vh"},verticalAlign:"middle"},i.a.createElement(g.a.Column,{style:{maxWidth:450}},i.a.createElement(b.a,{as:"h2",color:"blue",textAlign:"center"},i.a.createElement(h.a,{src:"/LogoMin.png"}),"  Log-in to your account"),i.a.createElement(p.a,{size:"large",style:{textAlign:"left"},onSubmit:A},i.a.createElement(O.a,{stacked:!0},i.a.createElement(p.a.Input,{fluid:!0,icon:"user",iconPosition:"left",placeholder:"username",onChange:function(e,t){var a=t.value;return o(a)}}),i.a.createElement(p.a.Input,{fluid:!0,icon:"lock",iconPosition:"left",placeholder:"Password",type:"password",onChange:function(e,t){var a=t.value;return j(a)}}),i.a.createElement(E.a,{type:"submit",color:"blue",fluid:!0,size:"large"},"Login"))),i.a.createElement(v.a,{horizontal:!0},"Or"),i.a.createElement(O.a,{stacked:!0},i.a.createElement(E.a,{type:"button",content:"Log in to station",size:"large",color:"teal",fluid:!0,onClick:function(){return a.push("/stationLogin")}}))))},xa=a(114),Ma=a(98),Ha=a(236),La=a(172),qa=a(92),_a=a(669);function Ba(){var e=Object(S.a)(["\nquery getAllTimeSheets(\n  $staffId: String, $staff: [String] ,$period: String, $from: String , $to: String, $number: Int, $groupBy: String , $year: Int, $stations: [String], $filterStatus: String\n){\n  getAllTimeSheets(\n    staff:$staff,\n    period:$period,\n    from: $from,\n    to:$to ,\n    number:$number ,\n    groupBy:$groupBy,\n    year:$year ,\n    stations:$stations\n    filterStatus: $filterStatus\n    )\n  getStaff(\n      id: $staffId\n      ){    \n    name}\n   \n}"]);return Ba=function(){return e},e}function Ka(){var e=Object(S.a)(["query getTimesheetByUser($staff: String!, $filterDuration: String! ,$number: Int!, $year: Int!){\n  getTimeSheetByUser(\n    staff: $staff,\n     filterDuration: $filterDuration, \n     number: $number, \n     year: $year\n    ) {\n      id\n      startTime\n      status\n      date\n      endTime\n      break\n      remarks{\n        by\n        date\n        edit\n        text\n        title\n      }\n      staff{\n        name\n        reqHours\n        contractType\n      }\n      shiftReport {\n        shift\n        id\n        station {\n          id\n          location\n        }\n      }\n\n      shift\n      station{\n        id\n        location\n      }\n\n  },\n\n  getStaff(\n    id: $staff\n    ){    \n  name}\n\n}"]);return Ka=function(){return e},e}var za=Object(f.gql)(Ka()),Ua=Object(f.gql)(Ba()),Ya=function(e){var t=Object(r.useContext)(Q),a=Object(u.a)(t,2)[1],l=Object(d.i)(),c=JSON.parse(sessionStorage.getItem("staffKey")),o=Object(f.useQuery)(w,{skip:!1===e.add}),g=o.loading,h=o.data,y=Object(f.useLazyQuery)(ie),v=Object(u.a)(y,2),S=v[0],C=v[1],j=C.loading,k=C.data,T=Object(f.useMutation)(tt,{onError:function(t){a({type:"ADD_NOTIFICATION",payload:{content:i.a.createElement(i.a.Fragment,null,"Error, Failed to ".concat(e.add?"Add":"Update"," timesheet record "),i.a.createElement("br",null),t.message),type:"ERROR"}}),B()}}),I=Object(u.a)(T,2),A=I[0],D=I[1].loading,R=Object(r.useState)([]),F=Object(u.a)(R,2),$=F[0],N=F[1],P=Object(r.useState)(!1),x=Object(u.a)(P,2),M=x[0],H=x[1];Object(r.useEffect)((function(){if(h){var e=h.allStations.map((function(e,t){return{key:t,value:e.id,text:e.location}}));N(e)}}),[h]);var L=function(e){if(h){var t=h.allStations.filter((function(t){return t.id===e}));if(t&&t[0].shifts)return t[0].shifts.map((function(e,t){return{key:t,value:e.name,text:e.name}}))}},q=function(e,t,a){var n=new Date(Me(e)),r=new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate())).toISOString();S({variables:{date:r,shift:t,station:a}})},_=function(){var t=Object(m.a)(s.a.mark((function t(r){var c;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:c=Object(n.a)(Object(n.a)({},r),{},{break:parseInt(r.break)}),k&&k.getShiftReportByShift&&k.getShiftReportByShift.id&&(c.handover=k.getShiftReportByShift.id),e.add||(c.id=e.id),r.remarks.length>=e.remarks.length&&c.remarks.splice(0,e.remarks.length),A({variables:c,update:function(t,r){e.add&&t.modify({fields:{getTimeSheetByUser:function(e,t){var a=t.readField,n=r.data.addToTimeSheet;return e.some((function(e){return a("id",e)===n.id}))?e:[].concat(Object(U.a)(e),[n])},getAllTimeSheets:function(e){var t=l.period;if(!t)return e;var a=r.data.addToTimeSheet,i=pe.a.cloneDeep(e),c=((Me(a.endTime)-Me(a.startTime))/36e5-(a.break||0)/60).toFixed(1);if(i[t]||(i[t]={}),!i[t][a.staff.name])return i[t][a.staff.name]={},i[t][a.staff.name].station=Object(Ce.a)({},a.station.location,1),i[t][a.staff.name].itemsPending=1,i[t][a.staff.name].totHours=c,i;var o=i[t][a.staff.name].station;return i[t][a.staff.name]=Object(n.a)(Object(n.a)({},i[t][a.staff.name]),{},{itemsPending:i[t][a.staff.name].itemsPending+1,totHours:(parseFloat(i[t][a.staff.name].totHours)+parseFloat(c)).toFixed(1),station:Object(n.a)(Object(n.a)({},o),{},Object(Ce.a)({},a.station.location,o[a.station.location]+1))}),i}},broadcast:!1}),a({type:"ADD_NOTIFICATION",payload:{content:i.a.createElement(i.a.Fragment,null,"Success, ".concat(e.add?"Added":"Updated"," timesheet record for ").concat(c.startTime.split(" ")[0])),type:"SUCCESS"}}),B()}});case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),B=function(){e.setOpen(!1),H(!1)},K=e.add?"Adding Work Time Record to Date ".concat(Pe(Date.parse(e.date)).split(" ")[0]):"Editing Work Time Record to Date ".concat(Pe(Date.parse(e.date)).split(" ")[0]);return i.a.createElement(Je.a,{closeIcon:!0,closeOnEscape:!1,closeOnDimmerClick:!1,open:e.open,onClose:function(){return B()},onOpen:function(){return e.setOpen(!0)}},i.a.createElement(Je.a.Header,null,K," "),i.a.createElement(Je.a.Content,null,D&&i.a.createElement(we.a,{active:!0},i.a.createElement(le.a,null)),i.a.createElement(je.c,{initialValues:function(){var t={startTime:e.startTime,endTime:e.endTime,break:e.break||30,remarks:e.remarks||[]};return e.add&&(t.staff=e.staffId,t.startTime=Pe(new Date(e.date).setHours(0)),t.endTime=new Date(e.date).setHours(8)>Date.now()?Pe(Me(Date.now())):Pe(new Date(e.date).setHours(8)),t.station="",t.shift="",t.remarks=[{title:"Manually Entered to TimeSheet",date:Pe(Date.now()),by:c.name}]),t}(),validate:function(t){var a={};return a=Object(n.a)(Object(n.a)({},a),Ke(t.startTime,t.endTime,e.date)),pe.a.isEmpty(a)&&function(t){if(!e.add){var a=0===e.remarks.length?0:e.remarks.length,n=Object(U.a)(t.remarks);t.startTime===e.startTime&&t.endTime===e.endTime||((!n[a]||n[a]&&"Edited"!==n[a].title)&&n.splice(a,0,{title:"Edited",date:Pe(Date.now()),by:c.name,edit:{}}),t.startTime!==e.startTime&&(n[a].edit.startTime="".concat(e.startTime," to  ").concat(t.startTime)),t.endTime!==e.endTime&&(n[a].edit.endTime="".concat(e.endTime," to  ").concat(t.endTime)),t.remarks=n),t.startTime===e.startTime&&n[a]&&t.remarks[a].edit&&delete n[a].edit.startTime,t.endTime===e.endTime&&n[a]&&t.remarks[a].edit&&delete n[a].edit.endTime,n[a]&&n[a].edit&&pe.a.isEmpty(n[a].edit)&&n.splice(a,1),t.remarks=n}}(t),a},onSubmit:function(e){if(e.remarks.length&&!e.remarks[e.remarks.length-1].title&&!e.remarks[e.remarks.length-1].text){var t=Object(U.a)(e.remarks);t.splice(e.remarks.length-1,1),e.remarks=t}e.remarks.length&&!e.remarks[e.remarks.length-1].title&&e.remarks[e.remarks.length-1].text&&(e.remarks[e.remarks.length-1].title="Remark Added"),_(e)}},(function(t){var a=t.values,n=t.handleSubmit,r=t.setFieldValue;return i.a.createElement(p.a,{size:"large",style:{marginBottom:"5rem"},onSubmit:n},i.a.createElement(p.a.Group,null,i.a.createElement(De,{label:"Start Time",dateTimeFormat:"DD-MM-YYYY HH:mm",name:"startTime",maxDate:xe(Date.now(),30,"m","sub"),minDate:Pe(Date.parse(e.date))}),i.a.createElement(De,{label:"End Time",dateTimeFormat:"DD-MM-YYYY HH:mm",name:"endTime",maxDate:Date.now()<Me(a.endTime)?Pe(Date.now()):xe(a.startTime,20,"h","add"),minDate:xe(a.startTime,20,"m","add")}),i.a.createElement(Xt,{inputlabel:"Break",label:"Minutes ",labelPosition:"right corner",name:"break",type:"number",min:"0"})),e.add&&i.a.createElement(p.a.Group,null,i.a.createElement(ta,{label:" Select Station",loading:g,name:"station",placholder:"Select Station",search:!0,selection:!0,options:$,onChange:function(e,t){var n=t.value;r("station",n);var i=function(e,t){if(h){var a=h.allStations.filter((function(e){return e.id===t}));if(a&&a[0].shifts){var n=new Date(Me(e));return a[0].shifts.reduce((function(e,t){var a=t.startTime.split(":"),r=new Date(n);r.setHours(a[0]),r.setMinutes(a[1]);var i=(n-r)/36e5;return i>e.diff&&e.diff<0||i>0&&i<e.diff?{name:t.name,diff:i}:e}),{name:"",diff:-24}).name}}}(a.startTime,n);r("shift",i),q(a.startTime,i,n)}}),i.a.createElement(ta,{label:" Select Shift",disabled:!a.station,name:"shift",placholder:"Select Shift",search:!0,selection:!0,options:a.station?L(a.station):[],onChange:function(e,t){var n=t.value;r("shift",n),q(a.startTime,n,a.station)}})),j&&i.a.createElement(O.a,{secondary:!0,loading:!0},"Verifying ",a.shift," Shift"),a.shift&&k&&k.getShiftReportByShift&&i.a.createElement(O.a,{clearing:!0,secondary:!0},i.a.createElement(b.a,{as:"h3"},i.a.createElement(de.a,{name:"check circle",color:"green"})," Verified"),i.a.createElement(b.a,{floated:"left",as:"h5"},k.getShiftReportByShift.station.location," ",a.shift," Shift ",k.getShiftReportByShift.startTime.split(" ")[0],i.a.createElement(b.a.Subheader,null,i.a.createElement("strong",null," Shift Start : ")," ",k.getShiftReportByShift.startTime,i.a.createElement("strong",null," Shift End : ")," ",k.getShiftReportByShift.endTime," ")),i.a.createElement(E.a,{type:"button",floated:"right",onClick:function(){return e.openReport({id:k.getShiftReportByShift.id,open:!0})}}," View Shift Report")),a.shift&&k&&!k.getShiftReportByShift&&i.a.createElement(Y.a,{warning:!0,visible:!0,header:"Selected shift is not reported",content:"Adding to record to unreported shift will not be reflected on any shift reports thus cannot be verified. This may result on work time not being approved"}),i.a.createElement("label",null,i.a.createElement("strong",null,"Remarks")),i.a.createElement(je.b,{name:"remarks"},(function(t){var n=t.push,r=t.remove;return i.a.createElement(i.a.Fragment,null,a.remarks&&a.remarks.length>0&&a.remarks.map((function(e,t){return i.a.createElement(ea,{key:t,name:"remarks.".concat(t),value:e})})),"APPROVED"!==e.status&&i.a.createElement(p.a.Button,{type:"button",onClick:function(e){e.preventDefault(),M?(r(a.remarks.length-1),H(!1)):(a.remarks.length>0&&"Clearification Requested"===a.remarks[a.remarks.length-1].title?n({title:"Add Clearification",date:Pe(Date.now()),by:c.name,text:""}):n({title:"",date:Pe(Date.now()),by:c.name,text:""}),H(!0))}},!M&&a.remarks.length>0&&"Clearification Requested"===a.remarks[a.remarks.length-1].title?"Add Clearification":M?"Remove Remark":"Add Remark"))})),"APPROVED"!==e.status&&i.a.createElement(E.a,{type:"submit",floated:"right",positive:!0},"Save"),i.a.createElement(E.a,{type:"button",floated:"right",negative:!0,onClick:function(){return B()}},"Cancel"))}))))},Va=function(e){var t=e.timeSheet,a=e.rowSpan,l=e.openReport,c=e.index,o=e.date,s=e.staffId,m=JSON.parse(sessionStorage.getItem("staffKey")),g=Object(d.i)(),h=m.permission&&m.permission.timesheet,y=t.startTime,v=t.endTime,S=t.shiftReport&&t.shiftReport.station.location,C=t.shiftReport&&t.shiftReport.shift||t.shift,j=t.break,w=t.total,k=t.overTime,T=t.remarks||[],I=Object(r.useState)(!1),A=Object(u.a)(I,2),D=A[0],R=A[1],F=Object(r.useState)(!1),$=Object(u.a)(F,2),N=$[0],P=$[1],x=Object(r.useState)(!1),M=Object(u.a)(x,2),H=M[0],L=M[1],q=Object(r.useState)(!1),_=Object(u.a)(q,2),B=_[0],K=_[1],z=Object(r.useState)(""),U=Object(u.a)(z,2),V=U[0],J=U[1],Q=Object(f.useMutation)(at),W=Object(u.a)(Q,2),G=W[0],Z=W[1].loading,X=Object(f.useMutation)(nt),ee=Object(u.a)(X,2),te=ee[0],ae=ee[1].loading,ne=Object(f.useMutation)(rt),re=Object(u.a)(ne,2),ie=re[0],le=re[1].loading,ce=!t.id.toString().match(/^[0-9a-fA-F]{24}$/);return i.a.createElement(he.a.Row,{key:t.id,negative:!function(){var e=new Date(o).getDay();return 0!==e&&6!==e}()},0===c&&i.a.createElement(he.a.Cell,{collapsing:!0,rowSpan:a},o.split("T")[0]),i.a.createElement(he.a.Cell,null," ",S," "),i.a.createElement(he.a.Cell,{onClick:function(e){e.preventDefault(),l({id:t.shiftReport&&t.shiftReport.id,open:!0})}},t.shiftReport&&t.shiftReport.id?i.a.createElement("a",{href:""}," ",C," "):C?"".concat(C," "):"","  "),i.a.createElement(he.a.Cell,null,y&&y.split(" ")[1]),i.a.createElement(he.a.Cell,null," ",v&&v.split(" ")[1]," "),i.a.createElement(he.a.Cell,null," ",j," "),i.a.createElement(he.a.Cell,null," ",w||""," "),0===c&&i.a.createElement(he.a.Cell,{rowSpan:a}," ",k||""," "),i.a.createElement(he.a.Cell,null," ","PENDING_APPROVAL"===t.status?"No":"APPROVED"===t.status?"Yes":t.status," "),i.a.createElement(he.a.Cell,null,T&&T.length>0&&i.a.createElement(i.a.Fragment,null,"".concat(T[T.length-1].title," ").concat(T[T.length-1].date.split(" ")[0]),"  ",i.a.createElement("br",null),"  ",T[T.length-1].text,"`  ",i.a.createElement("br",null),i.a.createElement("a",{href:"#",onClick:function(e){e.preventDefault(),R(!0)}},"See all"))),i.a.createElement(he.a.Cell,null,i.a.createElement(O.a,{loading:Z||ae||le,disabled:Z||ae||le,size:"tiny",basic:!0,style:{width:"max-content",display:"inline-block"}},ce&&h&&(h.sign.length>0||m.id===s)&&i.a.createElement(E.a,{icon:"add",size:"mini",circular:!0,onClick:function(){P(!0),R(!0)}}),!ce&&i.a.createElement(i.a.Fragment,null,"APPROVED"!==t.status&&0!==h.sign.filter((function(e){return t.station&&e._id===t.station.id})).length&&i.a.createElement(_a.a,{trigger:i.a.createElement(E.a,{icon:"edit",size:"mini",circular:!0,onClick:function(){P(!1),R(!0)}}),content:"Edit Timesheet",position:"bottom center"}),0!==h.sign.filter((function(e){return t.station&&e._id===t.station.id})).length&&m.id!==s&&i.a.createElement(i.a.Fragment,null,i.a.createElement(_a.a,{trigger:i.a.createElement(E.a,{color:"APPROVED"===t.status?"green":"grey",icon:"check",size:"mini",circular:!0,onClick:function(){G({variables:{id:t.id,status:"APPROVED"===t.status?"":"APPROVED"},update:function(e,a){e.modify({fields:{getAllTimeSheets:function(e,n){n.readField;var r=g.period;if(!r)return e;var i=a.data.approveTimeSheet.status,l=pe.a.cloneDeep(e);return console.log("before",l[r][t.staff.name].itemsPending),l[r][t.staff.name].itemsPending="APPROVED"===i?l[r][t.staff.name].itemsPending-1:l[r][t.staff.name].itemsPending+1,l}}})}})}}),content:"APPROVED"===t.status?"Undo Approve":"Approve",position:"bottom center"}),"APPROVED"!==t.status&&i.a.createElement(_a.a,{size:"huge",wide:"very",style:{width:"100%"},trigger:i.a.createElement(E.a,{color:"blue",icon:"talk",size:"mini",circular:!0}),onOpen:function(){return K(!0)},onClose:function(){return K(!1)},open:B,content:i.a.createElement(p.a,{onSubmit:function(){!function(){var e={id:t.id,clearify:V};ie({variables:e})}(),K(!1)}},i.a.createElement(b.a,{as:"h5"},"Request Clearification "),i.a.createElement(p.a.TextArea,{value:V,onChange:function(e,t){var a=t.value;return J(a)}}),i.a.createElement(p.a.Button,{floated:"right",type:"submit",primary:!0}," Send")),on:"click",position:"bottom right"})),"APPROVED"!==t.status&&(0!==h.sign.filter((function(e){return t.station&&e._id===t.station.id})).length||m.id===s)&&i.a.createElement(_a.a,{as:Y.a,warning:!0,trigger:i.a.createElement(E.a,{color:"red",icon:"trash",size:"mini",circular:!0}),content:i.a.createElement(i.a.Fragment,null,i.a.createElement(Y.a.Header,null,"Are you sure, you want to remove this record?"),i.a.createElement("p",null," Action is non reversible and will remove all the instances of this record from the system."),i.a.createElement(E.a,{fluid:!0,color:"red",icon:"trash",content:"Confirm",onClick:function(){t.id,te({variables:{id:t.id},update:function(e,a){a.data.deleteTimeSheet&&"SUCCESS"===a.data.deleteTimeSheet.status&&e.modify({fields:{getTimeSheetByUser:function(e){return e.DELETE},getAllTimeSheets:function(e,a){a.readField;var r=g.period;if(!r)return e;var i=pe.a.cloneDeep(e),l=i[r][t.staff.name].totHours-w;if(0===l)return delete i[r],i;var c=i[r][t.staff.name].station;return i[r][t.staff.name]=Object(n.a)(Object(n.a)({},i[r][t.staff.name]),{},{itemsPending:i[r][t.staff.name].itemsPending-1,totHours:l,station:Object(n.a)(Object(n.a)({},c),{},Object(Ce.a)({},t.station.location,c[t.station.location]-1))}),i}},broadcast:!1})}}),L(!1)}})),on:"click",onOpen:function(){return L(!0)},onClose:function(){return L(!1)},open:H,position:"bottom center"})))),i.a.createElement(Ya,{staffId:s,id:t.id,openReport:l,date:o,open:D,status:t.status,setOpen:R,startTime:y,endTime:v,break:j,add:N,remarks:T}))},Ja=function(e){var t,a=e.startDate,l=e.endDate,c=e.data,o=e.staffId,s=e.title,m=Object(r.useState)({id:"",open:!1}),d=Object(u.a)(m,2),f=d[0],p=d[1],E=Object(U.a)(new Array(Math.ceil((l-a)/864e5)+1)).map((function(e,t){var n=t;return new Date(Date.UTC(a.getFullYear(),a.getMonth(),a.getDate()+n)).toISOString()})),g=pe.a.zipObject(E,E.map((function(e,t){return[{id:t}]}))),h=0,O=0;if(c){var y=(t=pe.a.groupBy(c.getTimeSheetByUser,"date"))&&pe.a.mapValues(t,(function(e,t){var a=0,r=0;return(e=e.map((function(e,t){var i=60*e.break*1e3,l=((Me(e.endTime)-Me(e.startTime)-i)/36e5).toFixed(1);return e=Object(n.a)(Object(n.a)({},e),{},{total:parseFloat(l)}),a+=parseFloat(l),r=(a-e.staff.reqHours).toFixed(1),e})))[0]=Object(n.a)(Object(n.a)({},e[0]),{},{overTime:r}),O+=parseFloat(r),h+=a,e}));t=Object(n.a)(Object(n.a)({},g),y)}var v={position:"sticky",top:"0",zIndex:1};return i.a.createElement(i.a.Fragment,null,s&&i.a.createElement(b.a,{as:"h5",floated:"right"},s),i.a.createElement(he.a,{celled:!0,striped:!0,structured:!0,textAlign:"center"},i.a.createElement(he.a.Header,null,i.a.createElement(he.a.Row,null,i.a.createElement(he.a.HeaderCell,{style:v}," Date "),i.a.createElement(he.a.HeaderCell,{style:v}," Station "),i.a.createElement(he.a.HeaderCell,{style:v}," Shift "),i.a.createElement(he.a.HeaderCell,{style:v}," Start Time "),i.a.createElement(he.a.HeaderCell,{style:v}," End Time "),i.a.createElement(he.a.HeaderCell,{style:v}," Break (Mins) "),i.a.createElement(he.a.HeaderCell,{style:v}," Total (Hrs) "),i.a.createElement(he.a.HeaderCell,{style:v}," OverTime "),i.a.createElement(he.a.HeaderCell,{style:v}," Approved "),i.a.createElement(he.a.HeaderCell,{style:v}," Remarks "),i.a.createElement(he.a.HeaderCell,{style:v}," Actions"))),i.a.createElement(he.a.Body,null,t&&pe.a.map(t,(function(e,t){return i.a.createElement(r.Fragment,{key:t},e.map((function(a,n){return i.a.createElement(Va,{staffId:o,date:t,index:n,key:a.id,openReport:p,timeSheet:a,rowSpan:e.length})})))}))),i.a.createElement(he.a.Footer,null,i.a.createElement(he.a.Row,null,i.a.createElement(he.a.HeaderCell,{colSpan:"6"},"Total"),i.a.createElement(he.a.HeaderCell,null," ",h.toFixed(1)," "),i.a.createElement(he.a.HeaderCell,null," ",O.toFixed(1)," "),i.a.createElement(he.a.HeaderCell,{colSpan:"3"})))),i.a.createElement(Ot,{setOpenReport:p,openReport:f}))},Qa=function(e){var t=e.staffId,a=e.setStaffName,n=e.period,l=e.selected,c=e.selectedYear,o=e.timesheetOnly,s=JSON.parse(sessionStorage.getItem("staffKey")),m=Object(r.useState)(n||"week"),d=Object(u.a)(m,2),g=d[0],h=d[1],y=new Date,v=Object(r.useState)(l||He(y)),S=Object(u.a)(v,2),C=S[0],j=S[1],w=Object(r.useState)(c||y.getFullYear()),k=Object(u.a)(w,2),T=k[0],I=k[1],A={staff:t||s.id,filterDuration:g,number:C,year:T},D=Object(f.useQuery)(za,{variables:A}),R=D.error,F=D.loading,$=D.data;Object(r.useEffect)((function(){$&&$.getStaff&&a($.getStaff.name)}),[$]);var N=new Proxy(["January","February","March","April","May","June","July","August","September","October","November","December"],{get:function(e,t){return isNaN(t)||(t=parseInt(t,10))<0&&(t+=e.length),e[t]}}),P=function(){var e;return e="month"===g?new Date(T,C,1):Le(C,T),e=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()))}(),x=function(){var e;if("month"===g)e=new Date(T,C+1,0);else{var t=Le(C,T);e=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate()+6))}return e>=y&&(e=new Date(Date.UTC(y.getFullYear(),y.getMonth(),y.getDate()))),e}();if(F)return i.a.createElement(le.a,{active:!0},"Fetching timesheets");if(R)return console.log(R),i.a.createElement(b.a,{as:"h5"},"Something Went Wrong, Please try again");var M=function(){var e=!1;return $&&$.getTimeSheetByUser&&$.getTimeSheetByUser.length>0&&(e=!$.getTimeSheetByUser.some((function(e){return"APPROVED"!==e.status}))),e};return i.a.createElement(i.a.Fragment,null,i.a.createElement(O.a,{basic:!0,style:{marginBottom:"20em"}},i.a.createElement(p.a,null,!o&&i.a.createElement(i.a.Fragment,null,i.a.createElement("label",null," Select by: "),i.a.createElement(p.a.Group,null,i.a.createElement(p.a.Field,null,i.a.createElement(Zt.a,{selection:!0,options:[{key:1,text:"Month",value:"month"},{key:2,text:"Week",value:"week"}],onChange:function(e,t){var a=t.value;h(a),j("month"===a?y.getMonth():He(y))},value:g})),i.a.createElement(p.a.Field,null,i.a.createElement(Zt.a,{compact:"month"!==g,selection:!0,options:"month"===g?function(){var e=y.getMonth();return[{key:1,text:N[e],value:e},{key:2,text:N[e-1],value:e-1<0?N.length+e-1:e-1},{key:3,text:N[e-2],value:e-2<0?N.length+e-2:e-2},{key:4,text:N[e-3],value:e-3<0?N.length+e-3:e-3}]}():function(){for(var e=y.getMonth(),t=y.getFullYear(),a=He(new Date(t-1,11,28)),n=He(new Date(t,e-3,1)),r=[],i=He(y);i!==n-1;){var l={key:i,text:i,value:i};r.push(l),0===(i-=1)&&(i=a)}return r}(),onChange:function(e,t){var a=t.value;j(a),"week"===g&&a>He(y)&&I(y.getFullYear-1),"month"===g&&a>y.getMonth()&&I(y.getFullYear-1)},value:C})))),i.a.createElement(Ja,{staffId:t,startDate:P,endDate:x,data:$,title:"Timesheet ".concat("month"===g?N[C]:"Week ".concat(C,",")," ").concat(T," ")}),t===s.id&&i.a.createElement(O.a,{basic:!0,clearing:!0},i.a.createElement(_a.a,{trigger:i.a.createElement("span",{floated:"right"},i.a.createElement(E.a,{floated:"right",disabled:!M(),type:"button",color:"blue"}," Submit to Payroll")),disabled:M(),content:" All records should be approved for submission"})))))};function Wa(){var e=Object(S.a)(["\n  query verifyUsername( $username: String!){\n    verifyUsername(   \n      username: $username,\n    ){\n      status,\n      message\n    }\n  }"]);return Wa=function(){return e},e}function Ga(){var e=Object(S.a)(["\n  query{ allStaff {\n    id\n    name\n    email\n    phone\n    disabled\n    lastActive{\n      station{\n        location\n      }\n      activeAt\n    }\n  }}\n"]);return Ga=function(){return e},e}function Za(){var e=Object(S.a)(["\n  query allStaffMinimal ($minimal: Boolean = true) { \n    allStaff (minimal :$minimal){\n    id\n    name   \n  }}\n"]);return Za=function(){return e},e}function Xa(){var e=Object(S.a)(["\nquery fetchStaff($registerCode:String,){\n    getStaff(\n      registerCode: $registerCode\n      ){ \n    name\n    }\n  }\n"]);return Xa=function(){return e},e}function en(){var e=Object(S.a)(["\nquery fetchStaff($id:String, $registerCode:String, $withPermission: Boolean!){\n    getStaff(\n      id: $id\n      registerCode: $registerCode\n      ){ \n    id     \n    name\n    idCardCode\n    currentStation{\n      location\n    }\n    email\n    position\n    contractType\n    lastActive{\n      station{\n        location\n      }\n      activeAt\n    }\n    username\n    resetCode\n    phone\n    reqHours\n    registerCode\n    permission  @include(if: $withPermission ) {\n      id\n      station\n      timesheet\n      staff\n      admin\n    }\n    }\n  }\n"]);return en=function(){return e},e}var tn=Object(f.gql)(en()),an=Object(f.gql)(Xa()),nn=Object(f.gql)(Za()),rn=Object(f.gql)(Ga()),ln=Object(f.gql)(Wa()),cn=function(e){var t=e.setFilter,a=JSON.parse(sessionStorage.getItem("staffKey")),n=Object(d.i)(),l=new Date,c=Object(r.useState)([]),o=Object(u.a)(c,2),s=o[0],m=o[1],E=Object(r.useState)("date"),g=Object(u.a)(E,2),b=g[0],h=g[1],y=Object(r.useState)([]),v=Object(u.a)(y,2),S=v[0],C=v[1],j=Object(r.useState)("week"),k=Object(u.a)(j,2),T=k[0],I=k[1],A=Object(r.useState)(Pe(new Date(l.getFullYear(),l.getMonth()-3,1)).split(" ")[0]),D=Object(u.a)(A,2),R=D[0],F=D[1],$=Object(r.useState)(Pe(l).split(" ")[0]),N=Object(u.a)($,2),P=N[0],x=N[1],M=Object(r.useState)(He(l)),H=Object(u.a)(M,2),L=H[0],q=H[1],_=Object(r.useState)(l.getFullYear()),B=Object(u.a)(_,2),K=B[0],z=B[1],U=Object(d.h)().pathname.split("/")[2],Y=Object(r.useState)(""),V=Object(u.a)(Y,2),J=V[0],Q=V[1],W=Object(r.useState)([]),G=Object(u.a)(W,2),Z=G[0],X=G[1],ee=Object(r.useState)(a.permission.timesheet.view.map((function(e,t){return{key:t,value:e._id,text:e.location}}))),te=Object(u.a)(ee,2),ae=te[0],ne=te[1],re=Object(f.useLazyQuery)(w),ie=Object(u.a)(re,2),le=ie[0],ce=ie[1],oe=ce.loading,se=ce.data;Object(r.useEffect)((function(){if(se&&se.allStations){var e=se.allStations.map((function(e,t){return{key:t,value:e.id,text:e.location}}));ne(e)}}),[se]);var me=Object(f.useLazyQuery)(nn),de=Object(u.a)(me,2),fe=de[0],pe=de[1],Ee=pe.loading,ge=pe.data;return Object(r.useEffect)((function(){if(ge){var e=ge.allStaff.map((function(e,t){return{key:t,value:e.id,text:e.name}}));X(e)}}),[ge]),Object(r.useEffect)((function(){t({staff:s,period:b,stations:S,groupBy:T,from:R,to:P,number:L,year:K,filterStatus:J})}),[s,b,S,T,R,P,L,K,J,t]),Object(r.useEffect)((function(){n.staffId?m([n.staffId]):m([]),"mypage"===U.toLowerCase()&&m([a.id])}),[U,a.id,n]),i.a.createElement(i.a.Fragment,null,i.a.createElement(O.a,{size:"tiny",clearing:!0},i.a.createElement(ue.a,{size:"mini",attached:"top left"},"Filters"),i.a.createElement(p.a,{size:"mini"},i.a.createElement(dt.a,{widths:"equal"},!n.staffId&&"mypage"!==U.toLowerCase()&&i.a.createElement(p.a.Dropdown,{label:"Staff",value:s,loading:Ee,options:Z,selection:!0,multiple:!0,clearable:!0,placeholder:"All",onFocus:function(){return fe()},onChange:function(e,t){var a=t.value;return m(a)}}),i.a.createElement(p.a.Dropdown,{label:"Period",value:b,options:[{key:1,value:"date",text:"Date"},{key:2,value:"week",text:"Week"},{key:3,value:"month",text:"Month"}],placeholder:"All",selection:!0,clearable:!0,compact:!0,onChange:function(e,t){var a=t.value;"week"===a&&q(He(l)),"month"===a&&q(l.getMonth()),h(a)}}),"date"===b&&i.a.createElement(i.a.Fragment,null,i.a.createElement(Te.DateInput,{value:R,label:"From",dateFormat:"DD-MM-YYYY",onChange:function(e,t){var a=t.value;F(a)}}),i.a.createElement(Te.DateInput,{value:P,label:"To",dateFormat:"DD-MM-YYYY",onChange:function(e,t){var a=t.value;x(a)}})),("week"===b||"month"===b)&&i.a.createElement(i.a.Fragment,null,i.a.createElement(p.a.Dropdown,{value:L,label:"Select ".concat(b),options:"week"===b?_e():qe(),selection:!0,compact:!0,onChange:function(e,t){var a=t.value;q(a),"week"===b&&a>He(l)&&z(l.getFullYear-1),"month"===b&&a>l.getMonth()&&z(l.getFullYear-1)}})),i.a.createElement(p.a.Dropdown,{label:"Group By",value:T,options:[{key:1,value:"week",text:"Week"},{key:2,value:"month",text:"Month"}],onChange:function(e,t){var a=t.value;return I(a)},selection:!0,compact:!0}),i.a.createElement(p.a.Dropdown,{label:"Station",loading:oe,options:ae,value:S,selection:!0,multiple:!0,clearable:!0,placeholder:"All",onFocus:function(){a.permission.admin&&le()},onChange:function(e,t){var a=t.value;return C(a)}}),i.a.createElement(p.a.Dropdown,{label:"Status",value:J,options:[{key:1,value:"approved",text:"Approved"},{key:2,value:"pending",text:"Pending"}],onChange:function(e,t){var a=t.value;return Q(a)},placeholder:"All",clearable:!0,selection:!0,compact:!0})))))},on=function(e){var t=e.setStaffName,a=new Date,l=Object(d.i)(),c=Object(d.h)(),o=c.pathname.split("/")[2],s=Object(r.useState)({staff:[],period:"date",from:Pe(new Date(a.getFullYear(),a.getMonth()-3,1)).split(" ")[0],to:Pe(a).split(" ")[0],number:He(a),groupBy:"week",year:a.getFullYear(),stations:[],filterStatus:""}),m=Object(u.a)(s,2),p=m[0],E=m[1],g=Object(n.a)({},p);1===p.staff.length&&(g.staffId=p.staff[0]);var b,h=Object(f.useQuery)(Ua,{variables:g,skip:l.period}),O=h.loading,y=h.data;if(Object(r.useEffect)((function(){y&&y.getStaff&&t(y.getStaff.name)}),[y,t]),l.period){var v,S,C,j=l.period.split(" ");return"Week"===j[0]?(v="week",S=j[1],C=j[2]):(v="month",b=j[0],S=["january","february","march","april","may","june","july","august","september","october","november","december"].findIndex((function(e){return e===b.toLowerCase()})),C=j[1]),i.a.createElement(Qa,{period:v,selected:parseInt(S),selectedYear:parseInt(C),staffId:l.staffId,setStaffName:t,timesheetOnly:!0})}return i.a.createElement(i.a.Fragment,null,i.a.createElement(cn,{setFilter:E}),i.a.createElement(le.a,{active:O}," Loading TimeSheet Overview"),i.a.createElement(he.a,null,i.a.createElement(xa.a,null,i.a.createElement(Ma.a,null,!l.staffId&&"mypage"!==o.toLowerCase()&&i.a.createElement(Ha.a,null,"Staff Name"),i.a.createElement(Ha.a,null,"Period"),i.a.createElement(Ha.a,null," Stations"),i.a.createElement(Ha.a,null," Total Hours"),i.a.createElement(Ha.a,null," Status"))),i.a.createElement(La.a,null,y&&y.getAllTimeSheets&&pe.a.map(y.getAllTimeSheets,(function(e,t){return pe.a.map(e,(function(e,a){return i.a.createElement(Ma.a,{key:a,positive:!e.itemsPending,negative:!!e.itemsPending},!l.staffId&&"mypage"!==o.toLowerCase()&&i.a.createElement(qa.a,null,i.a.createElement(vt.b,{to:"/Manage/ManageTimesheets/".concat(e.id),onClick:function(){}}," ",a)),i.a.createElement(qa.a,null,t),i.a.createElement(qa.a,null,pe.a.reduce(e.station,(function(e,t,a){return 0!==t?(e?e+"/":"")+a:e}),"")),i.a.createElement(qa.a,null,e.totHours),i.a.createElement(qa.a,null,i.a.createElement(vt.b,{to:"".concat(c.pathname,"/").concat(l.staffId?"":"".concat(e.id,"/")).concat(t),onClick:function(){}},e.itemsPending?"".concat(e.itemsPending,"  Items Pending"):"All Approved"," ")))}))})))))},sn=function(e){var t=e.setName,a=Object(d.i)(),n=Object(r.useState)(""),l=Object(u.a)(n,2),c=l[0],o=l[1];return i.a.createElement(i.a.Fragment,null,!(a.page&&"timesheetsoverview"===a.page.toLowerCase())&&i.a.createElement(i.a.Fragment,null,i.a.createElement(St.a,null,a.staffId&&i.a.createElement(i.a.Fragment,null,i.a.createElement(St.a.Section,{link:!0,as:vt.b,to:"/Manage/ManageTimesheets"}," Manage Timesheets "),i.a.createElement(St.a.Divider,null),i.a.createElement(St.a.Section,{active:!a.period,as:a.period?vt.b:"",to:"/Manage/ManageTimesheets/".concat(a.staffId)}," ",c," ")),a.period&&i.a.createElement(i.a.Fragment,null,i.a.createElement(St.a.Divider,{icon:"right chevron"}),i.a.createElement(St.a.Section,{active:!0},a.period.replace("_"," "))))),i.a.createElement(on,{setStaffName:t||o}))},mn=function(){var e=Object(r.useContext)(Q),t=Object(u.a)(e,2)[1],a=Object(d.i)(),n=Object(d.g)();sessionStorage.removeItem("staffKey");var l=Object(f.useMutation)(ka,{onCompleted:function(){t({type:"ADD_NOTIFICATION",payload:{content:"Success, password reset. you can now login",type:"SUCCESS"}}),n.push("/staffLogin")},onError:function(e){t({type:"ADD_NOTIFICATION",payload:{content:i.a.createElement(i.a.Fragment,null,"Error, password reset failed ",i.a.createElement("br",null)," ",e.message),type:"ERROR"}})}}),c=Object(u.a)(l,2),o=c[0],s=c[1],m=s.loading;s.error;if(!a.resetCode)return i.a.createElement(b.a,null,"Reset code mising or invalid");return i.a.createElement(O.a,{basic:!0,loading:m},i.a.createElement(je.c,{initialValues:{password:"",confirmPassword:""},validate:function(e){var t={};return e.password&&""!==e.password.trim()||(t.password="Password is required"),e.password!==e.confirmPassword&&(t.confirmPassword="New password and confirm password must match"),t},onSubmit:function(e){o({variables:{resetCode:a.resetCode,password:e.password}})}},(function(e){var t=e.handleSubmit,a=e.dirty,n=e.errors;return i.a.createElement(p.a,{style:{marginBottom:"5rem"},onSubmit:t},i.a.createElement(O.a,null,i.a.createElement(Fe,{name:"password",label:"New Password",type:"password",width:"8"}),i.a.createElement(Fe,{name:"confirmPassword",label:"Confirm Password",type:"password",width:"8"}),i.a.createElement(E.a,{disabled:!(a&&pe.a.isEmpty(n)),type:"submit",style:{marginTop:"1rem"},positive:!0},"Reset")))})))};function un(){var e=Object(S.a)(["\nmutation changePermission( $id: String! $staff: JsonObject, $station: JsonObject, $timesheet: JsonObject ,$admin: Boolean){\n  changePermission(\n    id: $id\n    staff: $staff\n    station: $station\n    timesheet: $timesheet\n    admin: $admin\n    ){\n      id\n      staff\n      station\n      timesheet\n      admin\n    }\n}"]);return un=function(){return e},e}var dn=Object(f.gql)(un()),fn=function(e){var t=e.permissions,a=Object(r.useContext)(Q),l=Object(u.a)(a,2)[1],c=Object(r.useState)([]),o=Object(u.a)(c,2),s=o[0],m=o[1],d=JSON.parse(sessionStorage.getItem("staffKey")),g=Object(r.useState)(t&&t.admin||!1),h=Object(u.a)(g,2),O=h[0],y=h[1],v=d.permission.admin,S=Object(f.useMutation)(dn,{onCompleted:function(){l({type:"ADD_NOTIFICATION",payload:{content:"Success, permission changed",type:"SUCCESS"}})},onError:function(e){l({type:"ADD_NOTIFICATION",payload:{content:i.a.createElement(i.a.Fragment,null,"Error, failed to change permission",i.a.createElement("br",null)," ",e.message),type:"ERROR"}})}}),C=Object(u.a)(S,2),j=C[0],k=C[1].loading,T=function(e){return e&&e.map((function(e){return e?e._id:null}))},I=function(e){if(v)return!0;if("object"===typeof e){if(!pe.a.isEmpty(e))return!0}else if(e)return!0;return!1},A=pe.a.mapValues(t,(function(e,t){if("object"===typeof e){var a=Object(n.a)({},e);return"station"===t&&(a.edit=T(a.edit)),"timesheet"===t&&(a.view=T(a.view),a.sign=T(a.sign)),a}return e})),D=Object(f.useQuery)(w,{skip:!v}),R=D.loading,F=D.data;Object(r.useEffect)((function(){if(F){var e=F.allStations.map((function(e,t){return{key:t,value:e.id,text:e.location}}));m(e)}}),[F]);var $=function(e){if(v)return s;var t=[];switch(e){case"station.edit":return d.permission.station.edit.length&&(t=d.permission.station.edit.map((function(e,t){return{key:t,value:e._id,text:e.location}}))),t;case"timesheet.view":return d.permission.timesheet.view.length&&(t=d.permission.timesheet.view.map((function(e,t){return{key:t,value:e._id,text:e.location}}))),t;case"timesheet.sign":return d.permission.timesheet.sign.length&&(t=d.permission.timesheet.sign.map((function(e,t){return{key:t,value:e._id,text:e.location}}))),t;default:return t}},N=s.map((function(e){return e.value}));return i.a.createElement(je.c,{enableReinitialize:!0,initialValues:Object(n.a)({},A),onSubmit:function(e){var a=Object(n.a)({},e);a.admin?j({variables:{admin:!0,id:t.id}}):(pe.a.reduce(e,(function(e,n,r){A[r]&&pe.a.isEqual(A[r],a[r])&&delete a[r],A[r]&&!pe.a.isEqual(A[r],a[r])&&pe.a.reduce(a[r],(function(e,n,i){pe.a.isEqual(t[r][i],a[r][i])&&delete a[r][i]}),{})}),{}),j({variables:Object(n.a)(Object(n.a)({},a),{},{id:t.id})}))}},(function(e){var a=e.setFieldValue,n=e.values,l=e.handleSubmit,c=e.dirty,o=e.resetForm;return i.a.createElement(i.a.Fragment,null,i.a.createElement(b.a,{as:"h3"},"Permission"),i.a.createElement(Ae.a,{label:"Administrator (All Permissions for all stations)",disabled:!v,toggle:!0,name:"admin",checked:n.admin,onChange:function(e,t){var n=t.checked;a("admin",n),y(n),n&&(a("station.edit",N),a("station.add",!0),a("timesheet.view",N),a("timesheet.sign",N),a("staff.edit",!0),a("staff.add",!0),a("staff.view",!0))}}),i.a.createElement(p.a,{as:"table",loading:R||k,className:"ui celled padded table",onSubmit:l},i.a.createElement(he.a.Header,null,i.a.createElement(he.a.Row,null,i.a.createElement(he.a.HeaderCell,null,"Scope"),i.a.createElement(he.a.HeaderCell,null,"Edit"),i.a.createElement(he.a.HeaderCell,null,"Add"),i.a.createElement(he.a.HeaderCell,null,"View"),i.a.createElement(he.a.HeaderCell,null,"Sign"))),i.a.createElement(La.a,null,pe.a.map(t,(function(e,t){return i.a.createElement(r.Fragment,{key:t},"__typename"!==t&&"id"!==t&&"admin"!==t&&i.a.createElement(je.b,null,(function(){return i.a.createElement(he.a.Row,{key:t},i.a.createElement(he.a.Cell,null,t.toUpperCase()),i.a.createElement(he.a.Cell,null,"station"===t&&i.a.createElement(ta,{multiple:!0,selection:!0,options:$("".concat(t,".edit")),placeholder:"Add Stations",disabled:R||!I(d.permission[t].edit)||O,loading:R,name:"".concat(t,".edit")}),"staff"===t?i.a.createElement(Ae.a,{disabled:!I(d.permission[t].edit)||O,toggle:!0,name:"".concat(t,".edit"),checked:n["".concat(t)].edit,onChange:function(e,n){var r=n.checked;a("".concat(t,".edit"),r),r&&a("".concat(t,".view"),r)}}):""),i.a.createElement(he.a.Cell,null,"timesheet"!==t&&i.a.createElement(Ae.a,{toggle:!0,disabled:!I(d.permission[t].add)||O,name:"".concat(t,".add"),checked:n["".concat(t)].add,onChange:function(e,n){var r=n.checked;console.log("".concat(t,".add"),r),a("".concat(t,".add"),r),"staff"===t&&r&&a("".concat(t,".view"),!0)}})),i.a.createElement(he.a.Cell,null,"staff"===t&&i.a.createElement(Ae.a,{disabled:!I(d.permission[t].view)||O,toggle:!0,name:"".concat(t,".view"),checked:n["".concat(t)].view,onChange:function(e,r){var i=r.checked;n.staff.edit||n.staff.add?a("".concat(t,".view"),!0):a("".concat(t,".view"),i)}}),"timesheet"===t&&i.a.createElement(ta,{multiple:!0,selection:!0,options:$("".concat(t,".view")),placeholder:"Add Stations",disabled:R||!I(d.permission[t].view)||O,loading:R,name:"".concat(t,".view"),onChange:function(e,r){var i=r.value,l=Object(U.a)(new Set([].concat(Object(U.a)(n.timesheet.sign),Object(U.a)(i))));a("".concat(t,".view"),l)}})),i.a.createElement(he.a.Cell,{disabled:"timesheet"!==t},"timesheet"===t&&i.a.createElement(ta,{multiple:!0,selection:!0,name:"".concat(t,".sign"),options:$("".concat(t,".sign")),placeholder:"Add Stations",disabled:R||!I(d.permission[t].sign)||O,onChange:function(e,r){var i=r.value;a("".concat(t,".sign"),i);var l=Object(U.a)(new Set([].concat(Object(U.a)(n.timesheet.view),Object(U.a)(i))));a("".concat(t,".view"),l)},loading:R})))})))})))),c&&i.a.createElement(i.a.Fragment,null,i.a.createElement(E.a,{onClick:function(){return l()}}," Save Changes"),i.a.createElement(E.a,{onClick:function(){return o()}}," Discard Changes")))}))},pn=function(e){var t=Object(r.useContext)(Q),a=Object(u.a)(t,2)[1],l=Object(f.useMutation)(Da,{onCompleted:function(){a({type:"ADD_NOTIFICATION",payload:{content:"Success, staff information saved",type:"SUCCESS"}}),e.setOpen(!1)},onError:function(t){a({type:"ADD_NOTIFICATION",payload:{content:i.a.createElement(i.a.Fragment,null,"Error, failed to save edited information",i.a.createElement("br",null)," ",t.message),type:"ERROR"}}),e.setOpen(!1)}}),c=Object(u.a)(l,2),o=c[0],s=c[1].loading,m={email:e.email,phone:e.phone||"",contractType:e.contractType,contractHours:e.reqHours,position:e.position||""};return i.a.createElement(Je.a,{closeIcon:!0,closeOnEscape:!1,closeOnDimmerClick:!1,open:e.open,onClose:function(){return e.setOpen(!1)},onOpen:function(){return e.setOpen(!0)}},i.a.createElement(oa.a,null,"Editing Staff ",e.name," "),i.a.createElement(sa.a,null,s&&i.a.createElement(we.a,{active:!0},i.a.createElement(le.a,null)),i.a.createElement(je.c,{initialValues:m,validate:function(e){var t={};return/[a-z]/i.test(e.phone)&&(t.phone="Phone number cannot contain alphabets "),e.phone&&e.phone.length<8&&(t.phone="Phone number should be at least 8 charter long "),Ue(e.email)&&(t.email="Invalid Email"),isNaN(e.contractHours)&&(t.contractHours="Contract Hours must be number"),t},onSubmit:function(t){var a=pe.a.omitBy(t,(function(e,t){return m[t]===e}));o({variables:Object(n.a)(Object(n.a)({},a),{},{id:e.id})})}},(function(e){e.values;var t=e.handleSubmit,a=(e.setFieldValue,e.dirty);e.errors;return i.a.createElement(p.a,{style:{marginBottom:"5rem"},onSubmit:t},i.a.createElement(g.a,null,i.a.createElement(g.a.Row,null,i.a.createElement(Fe,{name:"email",label:"Email",type:"email"})),i.a.createElement(g.a.Row,null,i.a.createElement(Fe,{name:"phone",label:"Phone",type:"tel"})),i.a.createElement(g.a.Row,null,i.a.createElement(ta,{name:"contractType",labeled:!0,label:"Contract",selection:!0,options:[{key:1,value:"Contractor",text:"Contractor"},{key:2,value:"Employee",text:"Employee"}]})),i.a.createElement(g.a.Row,null,i.a.createElement(Fe,{name:"contractHours",label:"Required Hours per day"})),i.a.createElement(g.a.Row,null,i.a.createElement(Fe,{name:"position",label:"Position"}))),a&&i.a.createElement(E.a,{type:"submit",floated:"right",positive:!0},"Save"))}))))},En=function(e){var t=Object(r.useContext)(Q),a=Object(u.a)(t,2)[1],n=Object(f.useMutation)(Aa,{onCompleted:function(){a({type:"ADD_NOTIFICATION",payload:{content:"Success, password cahanged",type:"SUCCESS"}}),e.setOpen(!1)},onError:function(t){a({type:"ADD_NOTIFICATION",payload:{content:i.a.createElement(i.a.Fragment,null,"Error, failed to change password",i.a.createElement("br",null)," ",t.message),type:"ERROR"}}),e.setOpen(!1)}}),l=Object(u.a)(n,2),c=l[0],o=l[1],s=o.loading;o.error;return i.a.createElement(Je.a,{closeIcon:!0,closeOnEscape:!1,closeOnDimmerClick:!1,open:e.open,onClose:function(){return e.setOpen(!1)},onOpen:function(){return e.setOpen(!0)}},i.a.createElement(oa.a,null,"Password Change"),i.a.createElement(sa.a,null,s&&i.a.createElement(we.a,{active:!0},"Updating Password",i.a.createElement(le.a,null)),i.a.createElement(je.c,{initialValues:{password:"",newPassword:"",confirmPassword:""},validate:function(e){var t={};return e.password||(t.password="Old Password is required"),e.newPassword===e.password&&(t.newPassword="New password cannot be same as old password"),e.newPassword||(t.newPassword="New password cannot be empty"),e.newPassword!==e.confirmPassword&&(t.confirmPassword="New password and confirm password must match"),console.log(t),t},onSubmit:function(t){c({variables:{id:e.id,password:t.password,newPassword:t.newPassword}})}},(function(e){var t=e.handleSubmit,a=e.dirty,n=e.errors;return i.a.createElement(p.a,{style:{marginBottom:"5rem"},onSubmit:t},i.a.createElement(g.a,null,i.a.createElement(g.a.Row,null,i.a.createElement(Fe,{name:"password",label:"Old Password",type:"password"})),i.a.createElement(g.a.Row,null,i.a.createElement(Fe,{name:"newPassword",label:"New Password",type:"password"})),i.a.createElement(g.a.Row,null,i.a.createElement(Fe,{name:"confirmPassword",label:"Confirm Password",type:"password"}))),a&&pe.a.isEmpty(n)&&i.a.createElement(E.a,{type:"submit",style:{marginTop:"1rem"},positive:!0},"Change Password"))}))))},gn=function(e){var t=Object(r.useContext)(Q),a=Object(u.a)(t,2)[1],n=Object(d.i)(),l=Object(r.useState)({open:!1,handleCancel:function(){},handleConfirm:function(){}}),c=Object(u.a)(l,2),o=c[0],s=c[1],m=Object(r.useState)(!1),p=Object(u.a)(m,2),h=p[0],O=p[1],y=JSON.parse(sessionStorage.getItem("staffKey")),v=y.id;v=e.id?e.id:n.staffId?n.staffId:y.id;var S=Object(f.useQuery)(tn,{variables:{id:v,withPermission:e.staffCanEdit||!1}}),C=S.loading,j=S.error,w=S.data,k=Object(f.useMutation)(Ia,{onCompleted:function(){a({type:"ADD_NOTIFICATION",payload:{content:"Success, password reset code sent to users email",type:"SUCCESS"}})},onError:function(e){a({type:"ADD_NOTIFICATION",payload:{content:i.a.createElement(i.a.Fragment,null,"Error, failed to reset",i.a.createElement("br",null)," ",e.message),type:"ERROR"}})}}),T=Object(u.a)(k,2),I=T[0],A=T[1],D=A.loading,R=A.error,F=Object(f.useMutation)(Ta,{onCompleted:function(){a({type:"ADD_NOTIFICATION",payload:{content:"Success, new register code sent to users email",type:"SUCCESS"}})},onError:function(e){a({type:"ADD_NOTIFICATION",payload:{content:i.a.createElement(i.a.Fragment,null,"Error, failed to send new register code",i.a.createElement("br",null)," ",e.message),type:"ERROR"}})}}),$=Object(u.a)(F,2),N=$[0],P=$[1],x=P.loading,M=P.error,H=function(){s({open:!1,handleCancel:function(){},handleConfirm:function(){}})};if(Object(r.useEffect)((function(){w&&e.setStaffName&&e.setStaffName(w.getStaff.name)}),[w,e]),(R||M)&&console.log(R,M),C)return i.a.createElement(le.a,{active:!0},"Fetching User Profile");if(j)return console.log(j),i.a.createElement(b.a,{as:"h5"},"Something Went Wrong, Please try again");var L=!w||!w.getStaff.registerCode;return i.a.createElement(i.a.Fragment,null,i.a.createElement(g.a,{columns:"3",style:{marginTop:"1rem"}},i.a.createElement(g.a.Row,{centered:!0,textAlign:"center"},i.a.createElement(g.a.Column,null,i.a.createElement(b.a,{as:"h4"},"Basic Info"),i.a.createElement(he.a,{compact:!0},i.a.createElement(La.a,null,i.a.createElement(he.a.Row,null,i.a.createElement(he.a.Cell,{width:"8"}," ",i.a.createElement("strong",null," Id Card Saved ")," "),i.a.createElement(he.a.Cell,{width:"7"},w.getStaff.idCardCode?i.a.createElement(de.a,{name:"checkmark",color:"green"}):i.a.createElement(de.a,{name:"cancel",color:"red"}))),i.a.createElement(he.a.Row,null,i.a.createElement(he.a.Cell,{width:"8"}," ",i.a.createElement("strong",null," Registration Complete")," "),i.a.createElement(he.a.Cell,{width:"7"},L?i.a.createElement(de.a,{name:"checkmark",color:"green"}):i.a.createElement(de.a,{name:"cancel",color:"red"}))),i.a.createElement(he.a.Row,null,i.a.createElement(he.a.Cell,null," ",i.a.createElement("strong",null," Email ")," "),i.a.createElement(he.a.Cell,null," ",w.getStaff.email)),i.a.createElement(he.a.Row,null,i.a.createElement(he.a.Cell,null," ",i.a.createElement("strong",null," Phone ")," "),i.a.createElement(he.a.Cell,null," ",w.getStaff.phone)),L&&i.a.createElement(he.a.Row,null,i.a.createElement(he.a.Cell,null," ",i.a.createElement("strong",null," Username ")," "),i.a.createElement(he.a.Cell,null," ",w.getStaff.username))),i.a.createElement(he.a.Footer,null,(e.staffCanEdit||y.id===w.getStaff.id)&&i.a.createElement(he.a.Row,null,i.a.createElement(he.a.HeaderCell,null,i.a.createElement(E.a,{primary:!0,size:"small"},"Scan Id Card")),i.a.createElement(he.a.HeaderCell,null,i.a.createElement(E.a,{loading:D||x,disabled:D||x,primary:!0,size:"small",onClick:function(e,t){switch(t.children){case"Change Password":O(!0);break;case"Reset Password":s({open:!0,handleConfirm:function(){I({variables:{id:w.getStaff.id}}),H()},handleCancel:function(){H()},content:"Confirm Reset Password",header:"Confirm"});break;case"Resend Register Link":s({open:!0,handleConfirm:function(){N({variables:{id:w.getStaff.id}}),H()},handleCancel:function(){H()},content:"Confirm Reset Registration Link",header:"Confirm"})}}},L?y.id===w.getStaff.id?"Change Password":e.staffCanEdit?"Reset Password":"":"Resend Register Link")))))),i.a.createElement(g.a.Column,null,i.a.createElement(b.a,{as:"h4"},"Contract"),i.a.createElement(he.a,{compact:!0},i.a.createElement(La.a,null,i.a.createElement(he.a.Row,null,i.a.createElement(he.a.Cell,null," ",i.a.createElement("strong",null," Type ")," "),i.a.createElement(he.a.Cell,null,w&&w.getStaff.contractType)),i.a.createElement(he.a.Row,null,i.a.createElement(he.a.Cell,null," ",i.a.createElement("strong",null," Required Hrs/Day ")," "),i.a.createElement(he.a.Cell,null," ",w&&w.getStaff.reqHours)),i.a.createElement(he.a.Row,null,i.a.createElement(he.a.Cell,null," ",i.a.createElement("strong",null," Position ")," "),i.a.createElement(he.a.Cell,null," ",w&&w.getStaff.position))))),i.a.createElement(g.a.Column,null,i.a.createElement(b.a,{as:"h4"},"Last Active"),i.a.createElement(he.a,{compact:!0},i.a.createElement(La.a,null,i.a.createElement(he.a.Row,null,i.a.createElement(he.a.Cell,null," ",i.a.createElement("strong",null," Station ")," "),i.a.createElement(he.a.Cell,null,w&&w.getStaff.lastActive&&w.getStaff.lastActive.station&&w.getStaff.lastActive.station.location)),i.a.createElement(he.a.Row,null,i.a.createElement(he.a.Cell,null," ",i.a.createElement("strong",null," Active at ")," "),i.a.createElement(he.a.Cell,null," ",w&&w.getStaff.lastActive&&Pe(w.getStaff.lastActive.activeAt))))))),e.staffCanEdit&&i.a.createElement(g.a.Row,null," ",i.a.createElement(g.a.Column,null,i.a.createElement(fn,{permissions:w.getStaff.permission})," "),"  "),i.a.createElement(pn,{open:e.editModelOpen,setOpen:e.setEditModelOpen,email:w.getStaff.email,phone:w.getStaff.phone,contractType:w.getStaff.contractType,reqHours:w.getStaff.reqHours,position:w.getStaff.position,id:w.getStaff.id}),i.a.createElement(En,{open:h,setOpen:O,id:w.getStaff.id}),i.a.createElement(ce.a,{open:o.open,content:o.content,header:o.header,onCancel:o.handleCancel,onConfirm:o.handleConfirm})))},bn=function(e){var t=e.setName,a=Object(d.i)(),n=Object(d.g)(),l=Object(f.useQuery)(an,{variables:{registerCode:a.registerCode},skip:!a.registerCode}),c=l.loading,o=l.error,s=l.data,m=Object(f.useMutation)(Na),g=Object(u.a)(m,2),h=g[0],y=g[1],v=y.loading,S=y.error,C=y.data,j=Object(f.useLazyQuery)(ln),w=Object(u.a)(j,2),k=w[0],T=w[1],I=T.loading,A=T.data,D=Object(r.useState)({verified:!1}),R=Object(u.a)(D,2),F=R[0],$=R[1];if(Object(r.useEffect)((function(){A&&$({verified:!0,status:A.verifyUsername.status})}),[A]),!a.registerCode)return i.a.createElement(b.a,null,"Registration code mising or invalid");if((o||S)&&console.log(o),C&&"SUCCESS"===C.registerStaff.status)return n.push("/staff"),null;s&&s.getStaff&&t(s.getStaff.name);return i.a.createElement(O.a,{basic:!0,loading:c||v},i.a.createElement(Y.a,{success:s&&s.getStaff,error:!!o},i.a.createElement(Y.a.Header,null,s&&s.getStaff&&"Please complete registration by setting  your username and password",o&&o.message,s&&!s.getStaff&&"Registration code Invalid")),s&&s.getStaff&&i.a.createElement(je.c,{initialValues:{password:"",username:"",confirmPassword:""},validate:function(e){var t={};return e.username&&""!==e.username.trim()||(t.username="Username is required"),e.username&&e.username.length<4&&(t.username="Username should be at least 4 character long"),e.password&&""!==e.password.trim()||(t.password="Password is required"),e.password!==e.confirmPassword&&(t.confirmPassword="New password and confirm password must match"),t},onSubmit:function(e){h({variables:{registerCode:a.registerCode,password:e.password,username:e.username}})}},(function(e){e.values;var t=e.handleChange,a=e.handleSubmit,n=e.dirty,r=e.errors,l=e.handleBlur,c=e.touched;return i.a.createElement(p.a,{style:{marginBottom:"5rem"},onSubmit:a},i.a.createElement(p.a.Field,{width:"8"},i.a.createElement(Ie.a,{loading:I,icon:i.a.createElement(de.a,{name:void 0===r.username&&F.verified?"SUCCESS"===F.status?"check circle":"cancel":"",color:F.verified&&"SUCCESS"===F.status?"green":"red"}),onBlur:l,name:"username",label:"Username",width:"8",onChange:function(e){t(e);var a=e.currentTarget.value;k({variables:{username:a}})}}),(r.username&&c.username||void 0===r.username&&F.verified&&"SUCCESS"!==F.status)&&i.a.createElement(ue.a,{pointing:!0,prompt:!0},r.username||"Selected username already taken, please select new username")),i.a.createElement(Fe,{name:"password",label:"Password",type:"password",width:"8"}),i.a.createElement(Fe,{name:"confirmPassword",label:"Confirm Password",type:"password",width:"8"}),i.a.createElement(E.a,{disabled:!(n&&pe.a.isEmpty(r)&&F.verified&&"SUCCESS"===F.status),type:"submit",style:{marginTop:"1rem"},positive:!0},"Register"))})))},hn=function(e){var t=e.staffName,a=e.activeItem,n=e.setActiveItem,r=JSON.parse(sessionStorage.getItem("staffKey")),l=Object(d.g)();if("register"===Object(d.h)().pathname.split("/")[1].toLowerCase())return i.a.createElement(oe.a,{inverted:!0,color:"blue",stackable:!0},i.a.createElement(oe.a.Item,{position:"right"},"Welcome ",t));var c=function(e,t){var a=t.name;n(a),["Profile","Timesheets","TimesheetsOverview"].includes(a)?l.push("/staff/".concat(r.id,"/").concat(a)):l.push("/".concat(a))},o=[];0===o.length&&(o.push("Timesheets"),o.push("TimesheetsOverview"),o.push("Profile"));return i.a.createElement(oe.a,{inverted:!0,color:"blue",stackable:!0},o.map((function(e){return i.a.createElement(oe.a.Item,{key:e,name:e,active:a===e,onClick:c})})),i.a.createElement(oe.a.Menu,{position:"right"},i.a.createElement(Zt.a,{item:!0,text:"Welcome ".concat(r.name)},i.a.createElement(Zt.a.Menu,null,i.a.createElement(Zt.a.Item,{text:"Logout",onClick:function(){return sessionStorage.removeItem("staffKey"),void l.push("/staffLogin")}})))))},On=function(e){var t=e.activeItem,a=e.setActiveItem,n=e.staffName,l=e.staffId,c=e.staffCanEdit,o=e.setEditModelOpen,s=JSON.parse(sessionStorage.getItem("staffKey")).permission,m=Object(d.g)();return Object(r.useEffect)((function(){return a(""),function(){return a("")}}),[a]),i.a.createElement(oe.a,{pointing:!0,secondary:!0},i.a.createElement(oe.a.Item,{header:!0},n),i.a.createElement(oe.a.Item,{position:"right",name:"Profile",active:"Profile"===t,onClick:function(){a("Profile"),m.push("/Manage/AllStaffs/".concat(l,"/Profile"))}}),!0===(s.admin||s.timesheet.view.length||s.timesheet.sign.length)&&i.a.createElement(i.a.Fragment,null,i.a.createElement(oe.a.Item,{name:"Timesheets",active:"Timesheets"===t,onClick:function(){a("Timesheets"),m.push("/Manage/AllStaffs/".concat(l,"/Timesheets"))}}),i.a.createElement(oe.a.Item,{name:"TimesheetsOverview",active:"TimesheetsOverview"===t,onClick:function(){a("TimesheetsOverview"),m.push("/Manage/AllStaffs/".concat(l,"/TimesheetsOverview"))}})),c&&i.a.createElement(oe.a.Item,{position:"right",name:"EditProfile",icon:"edit",onClick:function(e){e.preventDefault(),m.push("Profile"),a("Profile"),o(!0)}}))},yn=function(e){var t=e.name,a=e.id,n=Object(d.i)(),l=n&&n.staffId,c=n&&n.page,o=Object(d.h)(),s=Object(d.g)(),m=Object(r.useState)(t),f=Object(u.a)(m,2),p=f[0],E=f[1],g=Object(r.useState)(!1),b=Object(u.a)(g,2),h=b[0],O=b[1],y=Object(r.useState)(c),v=Object(u.a)(y,2),S=v[0],C=v[1],j=Object(r.useState)(c||"Profile"),w=Object(u.a)(j,2),k=w[0],T=w[1],I=JSON.parse(sessionStorage.getItem("staffKey")),A=Object(r.useState)(I&&I.name),D=Object(u.a)(A,2),R=D[0],F=D[1],$=o.pathname.split("/");if(Object(r.useEffect)((function(){C(c),T(c)}),[c]),"register"===$[1].toLowerCase())return c="register",i.a.createElement(i.a.Fragment,null,i.a.createElement(hn,{staffName:R,activeItem:S,setActiveItem:C}),i.a.createElement(bn,{setName:F}));if("reset-password"===$[1].toLowerCase())return c="reset-password",i.a.createElement(i.a.Fragment,null,i.a.createElement(mn,null));if(!I&&"register"!==c&&"reset-password"!==c)return s.push("/staffLogin"),null;var N=I.id!==l&&void 0!==l&&(I.permission&&I.permission.staff.edit||I.permission.admin||!1),P=I.permission&&(I.permission.admin||I.permission.station.edit.length>0||I.permission.station.add||I.permission.staff.view||I.permission.staff.add||I.permission.staff.edit||I.permission.timesheet.view.length>0);l=a||(n.staffId?n.staffId:I.id);var x=$[1];I.id!==l&&"staff"===x.toLocaleLowerCase()&&s.push("/Manage/AllStaffs/".concat(l,"/").concat(S)),P&&"manage"!==x.toLowerCase()&&s.push("/Manage/MyPage/Profile");return i.a.createElement(i.a.Fragment,null,!P&&i.a.createElement(hn,{staffName:R,activeItem:S,setActiveItem:C}),i.a.createElement(i.a.Fragment,null,i.a.createElement(St.a,null,I.id===l&&i.a.createElement(i.a.Fragment,null,i.a.createElement(Ct.a,null," My Page "),i.a.createElement(jt.a,null)),I.id!==l&&i.a.createElement(i.a.Fragment,null,i.a.createElement(Ct.a,{link:!0,as:vt.b,to:"/".concat(x,"/").concat($[2])}," ",$[2]," "),i.a.createElement(jt.a,null),i.a.createElement(Ct.a,{link:!0,as:vt.b,to:"/".concat(x,"/").concat($[2],"/").concat($[3],"/Profile")}," ",p||l," "),i.a.createElement(jt.a,null)),c&&"timesheetsoverview"===c.toLowerCase()&&n.period?i.a.createElement(i.a.Fragment,null,i.a.createElement(Ct.a,{link:!0,as:vt.b,to:$.reduce((function(e,t,a){return a===$.length-1||""===t?e:e+"/"+t})),active:!0}," ",k," "),i.a.createElement(jt.a,{icon:"right chevron"}),i.a.createElement(Ct.a,{active:!0},n.period.replace("_"," "))):i.a.createElement(Ct.a,{active:!0}," ",k," "))),l!==I.id&&i.a.createElement(On,{activeItem:k,setActiveItem:T,staffName:p,staffId:l,staffCanEdit:N,setEditModelOpen:O}),(k&&"timesheets"===k.toLocaleLowerCase()||S&&"timesheets"===S.toLowerCase())&&i.a.createElement(i.a.Fragment,null,i.a.createElement(Qa,{staffId:l,setStaffName:E})),(k&&"profile"===k.toLocaleLowerCase()||S&&"profile"===S.toLowerCase())&&i.a.createElement(i.a.Fragment,null,i.a.createElement(gn,{id:l,staffCanEdit:N,setEditModelOpen:O,editModelOpen:h,setStaffName:E})),(k&&"timesheetsoverview"===k.toLocaleLowerCase()||S&&"timesheetsoverview"===S.toLowerCase())&&i.a.createElement(i.a.Fragment,null,i.a.createElement(sn,{setName:E})))},vn=function(e){var t=Object(r.useContext)(Q),a=Object(u.a)(t,2)[1],n=Object(f.useMutation)(Ra),l=Object(u.a)(n,2),c=l[0],o=l[1],s=o.loading;o.error;return i.a.createElement(je.c,{initialValues:{name:"",email:"",phone:"",contractType:"",contractHours:"",position:""},onSubmit:function(t){!function(t){c({variables:t,update:function(e,t){e.modify({fields:{allStaff:function(e,a){var n=a.readField,r=t.data.addStaff;return e.some((function(e){return n("id",e)===r.id}))?e:[].concat(Object(U.a)(e),[r])}}})}}).then((function(e){return a({type:"ADD_NOTIFICATION",payload:{content:"Success, new staff ".concat(t.name," created"),type:"SUCCESS"}})}),(function(e){return a({type:"ADD_NOTIFICATION",payload:{content:i.a.createElement(i.a.Fragment,null,"Error, Cannot create new staff  staff ".concat(t.name),i.a.createElement("br",null)," ",e.message),type:"ERROR"}})}),e.setOpen(!1))}(t)},validate:function(e){var t={};return t.name=Ye(e.name),t.email=Ue(e.email),pe.a.isEmpty(t.name)&&delete t.name,pe.a.isEmpty(t.email)&&delete t.email,e.contractType||(t.contractType="Please select contract type"),e.contractHours&&parseFloat(e.contractHours)||(t.contractHours="Invalid contract hours"),t}},(function(t){t.values;var a=t.handleSubmit,n=t.setFieldValue,r=t.dirty;return i.a.createElement(Je.a,{closeIcon:!0,closeOnEscape:!1,closeOnDimmerClick:!1,open:e.open,onClose:function(){return e.setOpen(!1)},onOpen:function(){return e.setOpen(!0)}},i.a.createElement(oa.a,null,"New Staff ",e.name," "),i.a.createElement(sa.a,null,s&&i.a.createElement(we.a,{active:!0},i.a.createElement(le.a,null)),i.a.createElement(p.a,{style:{marginBottom:"5rem"}},i.a.createElement(g.a,null,i.a.createElement(g.a.Row,null,i.a.createElement(Fe,{name:"name",label:"Name",type:"text",width:"8"})),i.a.createElement(g.a.Row,null,i.a.createElement(Fe,{name:"email",label:"Email",type:"email",width:"8"})),i.a.createElement(g.a.Row,null,i.a.createElement(Fe,{name:"phone",label:"Phone",type:"tel",width:"8"})),i.a.createElement(g.a.Row,null,i.a.createElement(ta,{name:"contractType",labeled:!0,label:"Contract",selection:!0,width:"8",options:[{key:1,value:"Contractor",text:"Contractor"},{key:2,value:"Employee",text:"Employee"}],onChange:function(e,t){var a=t.value;n("contractType",a)}})),i.a.createElement(g.a.Row,null,i.a.createElement(Fe,{name:"contractHours",label:"Required Hours per day",type:"number",width:"8"})),i.a.createElement(g.a.Row,null,i.a.createElement(Fe,{name:"position",label:"Position",width:"8"})),i.a.createElement(g.a.Row,null,i.a.createElement(p.a.Button,{icon:!0,type:"button",labelPosition:"right",primary:!0},i.a.createElement(de.a,{size:"big",name:"barcode"}),"Link Id card"))))),i.a.createElement(Je.a.Actions,null,i.a.createElement(E.a,{negative:!0,onClick:function(){return e.setOpen(!1)}},"Cancel"),r&&i.a.createElement(E.a,{positive:!0,onClick:function(){return a()}},"Save")))}))},Sn=function(){var e=Object(r.useContext)(Q),t=Object(u.a)(e,2)[1],a=Object(f.useQuery)(rn),n=a.loading,l=a.error,c=a.data,o=Object(r.useState)([]),s=Object(u.a)(o,2),m=s[0],d=s[1],g=Object(r.useState)(!1),b=Object(u.a)(g,2),h=b[0],y=b[1],v=Object(r.useState)(!1),S=Object(u.a)(v,2),C=S[0],j=S[1],w=Object(r.useState)({title:"",fn:function(){}}),k=Object(u.a)(w,2),T=k[0],I=k[1],A=JSON.parse(sessionStorage.getItem("staffKey")),D=Object(f.useMutation)($a),R=Object(u.a)(D,1)[0],F=Object(f.useMutation)(Fa),$=Object(u.a)(F,2),N=$[0];$[1].loading;return Object(r.useEffect)((function(){c&&c.allStaff&&d(c.allStaff)}),[c]),n?i.a.createElement(le.a,{active:!0},"Fetching Staffs"):l?i.a.createElement(O.a,null,"Something Went Wrong "):i.a.createElement(i.a.Fragment,null,!0===(A.permission.staff.add||A.permission.admin)&&i.a.createElement(E.a,{primary:!0,icon:!0,onClick:function(){return y(!0)}},"Add New Staff ",i.a.createElement(de.a,{name:"add"}," ")),m&&i.a.createElement(Ie.a,{icon:"search",placeholder:"Search...",onChange:function(e,t){var a=t.value;if(a&&""!==a.trim()){var n=m.filter((function(e){return e.name.includes(a)}));d(n)}else d(c.allStaff)}}),i.a.createElement(he.a,null,i.a.createElement(he.a.Header,null,i.a.createElement(Ma.a,null,i.a.createElement(Ha.a,null," Name "),i.a.createElement(Ha.a,null," Email "),i.a.createElement(Ha.a,null," Phone "),i.a.createElement(Ha.a,null," Last Active "),i.a.createElement(Ha.a,null," Recent Station "),i.a.createElement(Ha.a,null," Account Status "),i.a.createElement(Ha.a,null," "))),i.a.createElement(he.a.Body,null,m&&m.map((function(e){return i.a.createElement(he.a.Row,{key:e.id},i.a.createElement(qa.a,null,i.a.createElement(vt.b,{to:"/Manage/AllStaffs/".concat(e.id,"/Profile")},e.name)),i.a.createElement(qa.a,null,e.email),i.a.createElement(qa.a,null,e.phone),i.a.createElement(qa.a,null,e.lastActive&&Pe(e.lastActive.activeAt)),i.a.createElement(qa.a,null,e.lastActive&&e.lastActive.station&&e.lastActive.station.location),i.a.createElement(qa.a,null,e.accountStatus,i.a.createElement(p.a.Field,null,i.a.createElement(Ae.a,{checked:!e.disabled,toggle:!0,label:e.disabled?"Disabled":"Active",disabled:e.id===A.id||!(A.permission.staff.edit||A.permission.admin),onChange:function(a,n){var r,l,c,o=n.checked;r=e.id,l=e.name,N({variables:{id:r,disabled:!(c=o)},update:function(e){e.modify({id:"Staff:".concat(r),fields:{disabled:function(){return!c}}})}}).then((function(e){return t({type:"ADD_NOTIFICATION",payload:{content:"Success, staff ".concat(l," set ").concat(c?"active":"disabled"),type:"SUCCESS"}})}),(function(e){return t({type:"ADD_NOTIFICATION",payload:{content:i.a.createElement(i.a.Fragment,null,"Error, Cannot toggle status for  staff ".concat(l),i.a.createElement("br",null)," ",e.message),type:"ERROR"}})}))}}))),i.a.createElement(qa.a,null,e.id!==A.id&&(A.permission.staff.edit||A.permission.admin)&&i.a.createElement(E.a,{circular:!0,size:"mini",icon:"trash",negative:!0,disabled:e.id===A.id,onClick:function(){j(!0),I({title:"Are you sure, you want to delete "+e.name+"?",fn:function(){return a=e.id,n=e.name,void R({variables:{id:a},update:function(e){e.evict({id:"Staff:".concat(a)})}}).then((function(e){return t({type:"ADD_NOTIFICATION",payload:{content:"Success, staff ".concat(n," deleted"),type:"SUCCESS"}})}),(function(e){return t({type:"ADD_NOTIFICATION",payload:{content:i.a.createElement(i.a.Fragment,null,"Error, Cannot delete staff ".concat(n),i.a.createElement("br",null)," ",e.message),type:"ERROR"}})}));var a,n}})}})))})))),i.a.createElement(vn,{open:h,setOpen:y}),C&&i.a.createElement(Vt,{open:C,confirm:T,setOpen:j}))},Cn=function(e){var t=Object(r.useContext)(Q),a=Object(u.a)(t,2)[1],l=Object(f.useMutation)(M),c=Object(u.a)(l,2),o=c[0],d=c[1],h=d.loading,O=(d.error,Object(r.useState)([])),y=Object(u.a)(O,2),v=y[0],S=y[1],C=Object(r.useState)([]),j=Object(u.a)(C,2),w=j[0],k=j[1],T=Object(f.useQuery)(Ut,{onCompleted:function(e){if(e.allCostumers){var t=e.allCostumers.map((function(e,t){return{key:t,value:e.id,text:e.name}}));k(t)}}}).loading;Object(r.useEffect)((function(){(function(){var e=Object(m.a)(s.a.mark((function e(){var t,a,n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://restcountries.eu/rest/v2/?fields=name;alpha2Code;");case 2:return t=e.sent,e.next=5,t.json();case 5:a=e.sent,n=a.map((function(e,t){return["aq","bq","cw","gg","im","je","xk","bl","mf","sx","ss"].includes(e.alpha2Code.toLowerCase())?{key:t,value:e.name,text:e.name}:{key:t,value:e.name,text:e.name,flag:e.alpha2Code.toLowerCase()}})),S(n);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]);return i.a.createElement(je.c,{initialValues:{location:"",address:{street:"",postcode:"",city:"",country:""},email:"",phone:"",costumers:[],shifts:[],stationKey:"",stationKeyConfirm:""},onSubmit:function(t){console.log(t),function(t){o({variables:t,update:function(e,a){var r=a.data.addStation;e.modify({fields:{allStations:function(e,a){var i=a.readField,l=r;if(e.some((function(e){return i("id",e)===l.id})))return e;var c=Object(n.a)(Object(n.a)({},t),{},{id:l.id});return[].concat(Object(U.a)(e),[c])}}}),Object(fe.forEach)(t.costumers,(function(t){e.modify({id:"Costumer:".concat(t),fields:{stations:function(e,t){var a=t.readField;return e.some((function(e){return a("id",e)===r.id}))?e:[].concat(Object(U.a)(e),[{__ref:"Station:".concat(r.id)}])}}})}))}}).then((function(e){return a({type:"ADD_NOTIFICATION",payload:{content:"Success, ".concat(t.location," added to station list"),type:"SUCCESS"}})}),(function(e){return a({type:"ADD_NOTIFICATION",payload:{content:i.a.createElement(i.a.Fragment,null,"Error, ".concat(t.location," cannot be added to station list"),i.a.createElement("br",null)," ",e.message),type:"ERROR"}})}),e.setOpen(!1))}(t)},validate:function(e){var t={};return(!e.location||e.location&&e.location.length<3)&&(t.location="Location is required and must be at least 3 charcter long"),(!e.address.street||e.address.street&&e.address.street.length<3)&&(t.address=Object(n.a)(Object(n.a)({},t.address),{},{street:"Street is required and must be at least 3 charcter long"})),e.address.city||(t.address=Object(n.a)(Object(n.a)({},t.address),{},{city:"City is required and must be at least 3 charcter long"})),e.address.country||(t.address=Object(n.a)(Object(n.a)({},t.address),{},{country:"Country is required"})),e.email&&!Ue(e.email)||(t.email="Email is required and must be valid"),e.phone||(t.phone="Phone is required"),(!e.stationKey||e.stationKey&&e.stationKey.length<8)&&(t.stationKey="Station key is required and should be at least 8 charter long"),e.stationKeyConfirm!==e.stationKey&&(t.stationKeyConfirm="Station key confirm mismatch"),t}},(function(t){var a=t.values,n=t.handleSubmit,r=t.setFieldValue,l=t.dirty;return i.a.createElement(Je.a,{closeIcon:!0,closeOnEscape:!1,closeOnDimmerClick:!1,open:e.open,onClose:function(){return e.setOpen(!1)},onOpen:function(){return e.setOpen(!0)}},i.a.createElement(oa.a,null,"New Station ",e.name," "),i.a.createElement(sa.a,null,h&&i.a.createElement(we.a,{active:!0},i.a.createElement(le.a,null)),i.a.createElement(p.a,{style:{marginBottom:"5rem"},autoComplete:"off"},i.a.createElement(g.a,{padded:!0},i.a.createElement(g.a.Row,{style:{padding:0}},i.a.createElement(Fe,{name:"location",label:"Location",type:"text",width:"8",placeholder:"Location identifier ex: Airport code"})),i.a.createElement(g.a.Row,{style:{paddingTop:3}},i.a.createElement(ta,{name:"address.country",labeled:!0,label:"Country",placeholder:"Select Country",search:!0,selection:!0,width:"8",options:v,onChange:function(e,t){var a=t.value;r("address.country",a)}})),i.a.createElement(g.a.Row,null,i.a.createElement(b.a,{as:"h3"},"Address")),i.a.createElement(g.a.Row,{style:{padding:0}},i.a.createElement(Fe,{name:"address.street",label:"Street",type:"text",width:"8"})),i.a.createElement(g.a.Row,{style:{padding:0}},i.a.createElement(Fe,{name:"address.postcode",label:"postcode",type:"text",width:"8"})),i.a.createElement(g.a.Row,{style:{paddingTop:0}},i.a.createElement(Fe,{name:"address.city",label:"city",type:"text",width:"8"})),i.a.createElement(g.a.Row,null,i.a.createElement(b.a,{as:"h3"},"Contact Information")),i.a.createElement(g.a.Row,{style:{padding:0}},i.a.createElement(Fe,{name:"email",label:"Email",type:"email",width:"8"})),i.a.createElement(g.a.Row,{style:{paddingTop:0}},i.a.createElement(Fe,{name:"phone",label:"Phone",type:"tel",width:"8"})),i.a.createElement(g.a.Row,null,i.a.createElement(b.a,{as:"h3"},"Working Shift")),i.a.createElement(je.b,{name:"shifts"},(function(e){var t=e.push,n=e.remove;return i.a.createElement(i.a.Fragment,null,a.shifts.length>0&&a.shifts.map((function(e,t){return i.a.createElement(g.a.Row,{key:t,style:{padding:0}},i.a.createElement(p.a.Group,{widths:"13"},i.a.createElement(Fe,{name:"shifts[".concat(t,"].name"),label:"Name"}),i.a.createElement(Fe,{name:"shifts[".concat(t,"].startTime"),label:"StartTime"}),i.a.createElement(E.a,{type:"button",icon:!0,size:"mini",primary:!0,onClick:function(e){return n(t)}},i.a.createElement(de.a,{name:"plus circle"})," Add")," "))})),i.a.createElement(E.a,{type:"button",icon:!0,size:"mini",primary:!0,onClick:function(e){return t({name:"",startTime:""})}},i.a.createElement(de.a,{name:"plus circle"})," Add"))})),i.a.createElement(g.a.Row,null,i.a.createElement(b.a,{as:"h3"},"Costumers")),i.a.createElement(ta,{name:"costumers",placeholder:"Select Costumers",multiple:!0,search:!0,selection:!0,width:"8",loading:T,options:w,onChange:function(e,t){var a=t.value;r("costumers",a)}}),i.a.createElement(g.a.Row,null,i.a.createElement(b.a,{as:"h3"},"Station Key")),i.a.createElement(g.a.Row,{style:{padding:0}}," ",i.a.createElement(Fe,{name:"stationKey",type:"password",width:"8",placeholder:"stationKey"})," "),i.a.createElement(g.a.Row,{style:{padding:0}}," ",i.a.createElement(Fe,{name:"stationKeyConfirm",type:"password",width:"8",placeholder:"Confirm stationKey"})," ")))),i.a.createElement(Je.a.Actions,null,i.a.createElement(E.a,{negative:!0,onClick:function(){return e.setOpen(!1)}},"Cancel"),l&&i.a.createElement(E.a,{positive:!0,onClick:function(){return n()}},"Save")))}))},jn=function(){var e=Object(f.useQuery)(w,{variables:{detailed:!0}}),t=e.loading,a=e.error,n=e.data,l=Object(r.useState)([]),c=Object(u.a)(l,2),o=c[0],s=c[1],m=Object(r.useState)(!1),d=Object(u.a)(m,2),p=d[0],g=d[1];return Object(r.useEffect)((function(){n&&n.allStations&&s(n.allStations)}),[n]),t?i.a.createElement(le.a,{active:!0},"Fetching Staffs"):a?(console.log(a),i.a.createElement(O.a,null,"Something Went Wrong ")):i.a.createElement(i.a.Fragment,null,i.a.createElement(E.a,{primary:!0,icon:!0,onClick:function(){return g(!0)}},"Add New Station ",i.a.createElement(de.a,{name:"add"}," ")),o&&i.a.createElement(Ie.a,{icon:"search",placeholder:"Country or location ...",onChange:function(e,t){var a=t.value;if(a&&""!==a.trim()){var r=o.filter((function(e){return e.location.toLowerCase().includes(a.toLowerCase())||e.address.country.toLowerCase().includes(a.toLowerCase())}));s(r)}else s(n.allStations)}}),i.a.createElement(he.a,{textAlign:"center"},i.a.createElement(he.a.Header,null,i.a.createElement(Ma.a,null,i.a.createElement(Ha.a,null," Location "),i.a.createElement(Ha.a,null," Staff Count (Last 24 Hrs) "),i.a.createElement(Ha.a,null," Address "),i.a.createElement(Ha.a,null," Phone No. "),i.a.createElement(Ha.a,null," Email "))),i.a.createElement(he.a.Body,null,o&&o.map((function(e){return i.a.createElement(he.a.Row,{key:e.id},i.a.createElement(qa.a,null,i.a.createElement(vt.b,{to:"/Manage/AllStations/".concat(e.id)},e.location)),i.a.createElement(qa.a,null,e.activeStaffs),i.a.createElement(qa.a,null,i.a.createElement(i.a.Fragment,null," ",e.address.street," ",i.a.createElement("br",null),"   ",e.address.postcode," ",e.address.city," ",i.a.createElement("br",null),"  ",e.address.country,"    ",i.a.createElement(wt.a,{name:e.address&&e.address.country&&e.address.country.toLowerCase()})," ")),i.a.createElement(qa.a,null,e.phone&&e.phone.reduce((function(e,t){return i.a.createElement(i.a.Fragment,null,t,"  ",i.a.createElement("br",null)," ",e)}),"")," "),i.a.createElement(qa.a,null,e.email))})))),p&&i.a.createElement(Cn,{open:p,setOpen:g}))},wn=function(e){var t=e.activeItem,a=e.setActiveItem,n=JSON.parse(sessionStorage.getItem("staffKey")),r=Object(d.g)(),l=function(e,t){var n=t.name;a(n),["Profile","Timesheets","TimesheetsOverview"].includes(n)?r.push("/Manage/MyPage/".concat(n)):r.push("/Manage/".concat(n))},c=[];(n.permission.admin||n.permission.station.edit.length>0||n.permission.station.add)&&c.push("AllStations"),(n.permission.admin||n.permission.staff.view||n.permission.staff.add||n.permission.staff.view||n.permission.staff.edit)&&c.push("AllStaffs"),(n.permission.admin||n.permission.timesheet.view.length>0)&&c.push("ManageTimesheets"),n.permission.admin&&c.push("Costumers");return i.a.createElement(oe.a,{inverted:!0,color:"blue",stackable:!0},c.map((function(e){return i.a.createElement(oe.a.Item,{key:e,name:e,active:t===e,onClick:l})})),i.a.createElement(oe.a.Menu,{position:"right"},i.a.createElement(Zt.a,{item:!0,text:"Welcome ".concat(n.name)},i.a.createElement(Zt.a.Menu,null,c.length>0&&i.a.createElement(i.a.Fragment,null,i.a.createElement(Zt.a.Item,{disabled:!0,text:"My Pages",onClick:l}),i.a.createElement(Zt.a.Item,{name:"Profile",text:"Profile",onClick:l}),i.a.createElement(Zt.a.Item,{name:"Timesheets",text:"Timesheets",onClick:l}),i.a.createElement(Zt.a.Item,{name:"TimesheetsOverview",text:"TimesheetsOverview",onClick:l}),i.a.createElement(Zt.a.Divider,null)),i.a.createElement(Zt.a.Item,{text:"Logout",onClick:function(){return sessionStorage.removeItem("staffKey"),void r.push("/staffLogin")}})))))};function kn(){var e=Object(S.a)(["\n                  fragment NewCostumer on Costumer {\n                    name\n                    id\n                    contract\n                    aircrafts{\n                      id\n                      registration\n                    }\n                    stations{\n                      id\n                    }\n\n                  }   \n                "]);return kn=function(){return e},e}var Tn=function(e){var t=Object(r.useContext)(Q),a=Object(u.a)(t,2)[1],l=Object(r.useState)([]),c=Object(u.a)(l,2),o=c[0],s=c[1],m=Object(f.useMutation)(Pt),d=Object(u.a)(m,2),h=d[0],O=d[1],y=O.loading,v=O.error,S=Object(f.useLazyQuery)(w),C=Object(u.a)(S,2),j=C[0],T=C[1],I=T.loading,A=T.data;Object(r.useEffect)((function(){if(A&&A.allStations){var e=A.allStations.map((function(e,t){return{key:t,value:e.id,text:e.location}}));s(e)}}),[A]);v&&console.log(v);return i.a.createElement(je.c,{initialValues:{name:"",contract:"",keyContacts:[],stations:[],aircrafts:""},onSubmit:function(t){!function(t){h({variables:t,update:function(e,t){var a=t.data.addCostumer;Object(fe.forEach)(a.stations,(function(t){try{var r=Object(fe.cloneDeep)(e.readQuery({query:k,variables:{id:t.id}})).getStation;e.writeQuery({query:k,variables:{id:t.id},data:Object(n.a)(Object(n.a)({},r),{},{costumers:[].concat(Object(U.a)(r.costumers),[a])})})}catch(i){}})),e.modify({fields:{allCostumers:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1?arguments[1]:void 0,r=n.readField,i=e.writeFragment({data:a,fragment:Object(f.gql)(kn())});return t.some((function(e){return r("id",e)===a.id}))?t:[].concat(Object(U.a)(t),[i])}}})}}).then((function(e){return a({type:"ADD_NOTIFICATION",payload:{content:"Success, costumer ".concat(t.name," added"),type:"SUCCESS"}})}),(function(e){return a({type:"ADD_NOTIFICATION",payload:{content:i.a.createElement(i.a.Fragment,null,"Error, Cannot add costumer ".concat(t.name),i.a.createElement("br",null)," ",e.message),type:"ERROR"}})}),e.setOpen(!1))}(Object(n.a)(Object(n.a)({},t),{},{aircrafts:t.aircrafts?t.aircrafts.toUpperCase().split(","):[]}))},validate:function(e){var t={};if((!e.name||e.name&&e.name.length<3)&&(t.name="Costumer Name is required and must be at least 3 charcter long"),e.contract||(t.contract="Please specify contract type ex: Ad-HOC, LongTerm , Seasonal etc."),e.aircrafts){var a=[];Object(fe.forEach)(e.aircrafts.split(","),(function(e){e.trim().length<3&&a.push(e.toUpperCase())})),a.length&&(t.aircrafts="".concat(a.toString()," invalid Aircraft Registration, should at least 3 characters"))}return e.keyContacts.length&&Object(fe.forEach)(e.keyContacts,(function(e,a){e.description||(t.keyContacts||(t.keyContacts=[]),t.keyContacts[a]||(t.keyContacts[a]={}),t.keyContacts[a].description="Please provide contact description"),e.phone||e.email||(t.keyContacts||(t.keyContacts=[]),t.keyContacts[a]||(t.keyContacts[a]={}),t.keyContacts[a].phone="At least a phone or a email is required",t.keyContacts[a].email="At least a phone or a email is required"),e.email&&Ue(e.email)&&(t.keyContacts||(t.keyContacts=[]),t.keyContacts[a]||(t.keyContacts[a]={}),t.keyContacts[a].email="Invalid Email")})),t}},(function(t){var a=t.values,n=t.handleSubmit,r=t.setFieldValue,l=t.dirty;return i.a.createElement(Je.a,{closeIcon:!0,closeOnEscape:!1,closeOnDimmerClick:!1,open:e.open,onClose:function(){return e.setOpen(!1)},onOpen:function(){return e.setOpen(!0)}},i.a.createElement(oa.a,null,"New Costumer "),i.a.createElement(sa.a,null,y&&i.a.createElement(we.a,{active:!0},i.a.createElement(le.a,null)),i.a.createElement(p.a,{style:{marginBottom:"5rem"},autoComplete:"off",onSubmit:function(e){e.preventDefault(),n()}},i.a.createElement(g.a,{padded:!0},i.a.createElement(g.a.Row,{style:{padding:0}},i.a.createElement(Fe,{name:"name",label:"Name",type:"text",width:"8",placeholder:"Costumer Name"})),i.a.createElement(g.a.Row,{style:{padding:0}},i.a.createElement(Fe,{name:"contract",label:"Contract",type:"text",width:"8",placeholder:"Ex: Ad-Hoc, Short-term , Long-term, Seasonal"})),i.a.createElement(g.a.Row,{style:{padding:0}},i.a.createElement(Fe,{name:"aircrafts",label:"Aircrafts",type:"text",width:"8",placeholder:'Aircrfat Registrations separeted by comma ","'})),i.a.createElement(g.a.Row,{style:{paddingTop:3}},i.a.createElement(ta,{name:"stations",labeled:!0,label:"Station",placeholder:"Select Stations",search:!0,loading:I,selection:!0,multiple:!0,width:"8",options:o,onFocus:function(){return j()},onChange:function(e,t){var a=t.value;r("stations",a)}})),i.a.createElement(g.a.Row,null,i.a.createElement(b.a,{as:"h3"},"Key Contacts")),i.a.createElement(je.b,{name:"keyContacts"},(function(e){var t=e.push,n=e.remove;return i.a.createElement(i.a.Fragment,null,a.keyContacts.length>0&&a.keyContacts.map((function(e,t){return i.a.createElement(g.a.Row,{key:t,style:{padding:0}},i.a.createElement(p.a.Group,{style:{margin:0},widths:"13"},i.a.createElement(Fe,{name:"keyContacts[".concat(t,"].description"),label:"Description"}),i.a.createElement(Fe,{name:"keyContacts[".concat(t,"].phone"),label:"Phone"}),i.a.createElement(Fe,{name:"keyContacts[".concat(t,"].email"),label:"Email"}),i.a.createElement(de.a,{link:!0,name:"cancel",color:"red",onClick:function(){return n(t)}})))})),i.a.createElement(E.a,{style:{marginTop:"1rem"},type:"button",icon:!0,size:"mini",primary:!0,onClick:function(){return t({description:"",phone:"",email:""})}},i.a.createElement(de.a,{name:"plus circle"})," Add"))}))))),i.a.createElement(Je.a.Actions,null,i.a.createElement(E.a,{negative:!0,onClick:function(){return e.setOpen(!1)}},"Cancel"),l&&i.a.createElement(E.a,{positive:!0,onClick:function(e){e.preventDefault(),n()}},"Save")))}))},In=function(){var e=Object(r.useState)(!1),t=Object(u.a)(e,2),a=t[0],n=t[1],l=Object(f.useQuery)(Ut,{variables:{detailed:!0}}),c=l.loading,o=l.error,s=l.data,m=Object(d.h)();return s||c?c?i.a.createElement(O.a,{basic:!0},i.a.createElement(le.a,{active:!0}," Loading Costumer Data")):o?(console.log(o),i.a.createElement(b.a,{as:"h4"},"Something went wrong")):i.a.createElement(i.a.Fragment,null,i.a.createElement(E.a,{primary:!0,icon:!0,style:{marginBottom:"1rem"},onClick:function(){return n(!0)}},i.a.createElement(de.a,{name:"add circle"}),"Add New Costumer"),s&&s.allCostumers.length>0&&i.a.createElement(kt.a.Group,null,s.allCostumers.map((function(e){return i.a.createElement(kt.a,{key:e.id,link:!0,raised:!0,as:vt.b,to:"".concat(m.pathname,"/").concat(e.id)},i.a.createElement(kt.a.Content,{textAlign:"center",header:e.name}),i.a.createElement(kt.a.Content,{textAlign:"center"},e.contract?e.contract+" Contract":""),i.a.createElement(kt.a.Content,{textAlign:"center",extra:!0},i.a.createElement(b.a,{as:"h5"}," ",i.a.createElement(de.a,{name:"plane"})," Total Aircrafts: ",e.aircrafts&&e.aircrafts.length)))}))),!s.allCostumers&&i.a.createElement(b.a,{as:"h4"},"No Costumer Data"),a&&i.a.createElement(Tn,{open:a,setOpen:n})):null},An=function(){var e=Object(d.i)(),t=Object(d.h)(),a=t.pathname.split("/")[2],n=Object(r.useState)(a),l=Object(u.a)(n,2),c=l[0],o=l[1];return Object(r.useEffect)((function(){o(a)}),[a,t,e]),i.a.createElement(i.a.Fragment,null,i.a.createElement(wn,{activeItem:c,setActiveItem:o}),c&&"managetimesheets"===c.toLowerCase()&&i.a.createElement(sn,null),"mypage"===c.toLowerCase()&&i.a.createElement(i.a.Fragment,null,i.a.createElement(yn,null)),"allstaffs"===c.toLowerCase()&&!e.staffId&&i.a.createElement(i.a.Fragment,null,i.a.createElement(Sn,null)),"allstaffs"===c.toLowerCase()&&e.staffId&&i.a.createElement(i.a.Fragment,null,i.a.createElement(yn,{id:e.staffId})),c&&"allstations"===c.toLowerCase()&&!e.stationId&&i.a.createElement(i.a.Fragment,null,i.a.createElement(jn,null)),c&&"allstations"===c.toLowerCase()&&e.stationId&&i.a.createElement(i.a.Fragment,null,i.a.createElement(fa,null)),c&&"costumers"===c.toLowerCase()&&!e.costumerId&&i.a.createElement(i.a.Fragment,null,i.a.createElement(In,null)),c&&"costumers"===c.toLowerCase()&&e.costumerId&&i.a.createElement(i.a.Fragment,null,i.a.createElement(na,null)))},Dn=function(){return i.a.createElement(vt.a,null,i.a.createElement(d.d,null,i.a.createElement(d.b,{path:["/shiftReport/:station/:id","/shiftReport/:id"]},i.a.createElement(pa,null)),i.a.createElement(d.b,{path:"/stationLogin"},i.a.createElement(X,null)),i.a.createElement(d.b,{path:"/staffLogin"},i.a.createElement(Pa,null)),i.a.createElement(d.b,{path:["/staff/:staffId/:page/:period","/staff/:staffId/:page"]},i.a.createElement(yn,null)),i.a.createElement(d.a,{from:"/staff/:staffId",to:"/staff/:staffId/Profile"}),i.a.createElement(d.b,{path:"/staff"},i.a.createElement(yn,null)),i.a.createElement(d.a,{from:"/Manage/MyPage/:page/:id/:period",to:"/Manage/MyPage/:page/:period"}),i.a.createElement(d.b,{path:["/Manage/AllStaffs/:staffId/:page/:period","/Manage/AllStaffs/:staffId/:page/","/Manage/MyPage/:page/:period","/Manage/MyPage/:page/"]},i.a.createElement(An,null)),i.a.createElement(d.a,{from:"/Manage/AllStaffs/:staffId",to:"/Manage/AllStaffs/:staffId/Profile"}),i.a.createElement(d.b,{path:"/Manage/AllStaffs"},i.a.createElement(An,null)),i.a.createElement(d.b,{path:["/Manage/ManageTimesheets/:staffId/:period","/Manage/ManageTimesheets/:staffId","/Manage/ManageTimesheets"]},i.a.createElement(An,null)),i.a.createElement(d.b,{path:["/Manage/AllStations/:stationId/:page/:costumerId","/Manage/AllStations/:stationId/:page"]},i.a.createElement(An,null)),i.a.createElement(d.a,{from:"/Manage/AllStations/:stationId",to:"/Manage/AllStations/:stationId/BasicInfo"}),i.a.createElement(d.b,{path:"/Manage/AllStations"},i.a.createElement(An,null)),i.a.createElement(d.b,{path:["/Manage/Costumers/:costumerId","/Manage/Costumers"]},i.a.createElement(An,null)),i.a.createElement(d.a,{from:"/Manage",to:"/Manage/MyPage/Profile"}),i.a.createElement(d.b,{path:"/Manage"},i.a.createElement(An,null)),i.a.createElement(d.b,{path:"/Register/:registerCode"},i.a.createElement(yn,null)),i.a.createElement(d.b,{path:"/Reset-Password/:resetCode"},i.a.createElement(yn,null)),i.a.createElement(d.b,{path:"/"},i.a.createElement(X,null))))},Rn=function(){return i.a.createElement(Z,null,i.a.createElement(Dn,null))},Fn=(a(613),a(666)),$n=a(413),Nn=Object($n.a)((function(e,t){var a=t.headers,r=JSON.parse(sessionStorage.getItem("staffKey"));r||(r=JSON.parse(localStorage.getItem("stationKey")))||(r=JSON.parse(sessionStorage.getItem("stationKey")));var i=r?r.value:null;return{headers:Object(n.a)(Object(n.a)({},a),{},{authorization:i?"bearer ".concat(i):null})}})),Pn=new f.HttpLink({uri:window.location.href}),xn=new f.ApolloClient({cache:new f.InMemoryCache,link:Nn.concat(Pn)});c.a.render(i.a.createElement(f.ApolloProvider,{client:xn},i.a.createElement(Fn.a,null,i.a.createElement(Rn,null))),document.getElementById("root"))}},[[425,1,2]]]);
//# sourceMappingURL=main.0ad3e99f.chunk.js.map